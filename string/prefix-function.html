<!DOCTYPE html>
<html lang="en" class="no-js">
  <!-- Mirrored from  firststeptocp.com/string/prefix-function.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:40 GMT -->
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="icon" href="../favicon.ico" />
    <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5" />

    <title>
      Prefix function. Knuth–Morris–Pratt algorithm - Algorithms for Competitive
      Programming
    </title>

    <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css" />

    <link
      rel="stylesheet"
      href="../assets/stylesheets/palette.e6a45f82.min.css"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"
    />
    <style>
      :root {
        --md-text-font: "Roboto";
        --md-code-font: "Roboto Mono";
      }
    </style>

    <link rel="stylesheet" href="../stylesheets/extra.css" />

    <script>
      (__md_scope = new URL("..", location)),
        (__md_get = (e, _ = localStorage, t = __md_scope) =>
          JSON.parse(_.getItem(t.pathname + "." + e))),
        (__md_set = (e, _, t = localStorage, a = __md_scope) => {
          try {
            t.setItem(a.pathname + "." + e, JSON.stringify(_));
          } catch (e) {}
        });
    </script>

    <script>
      (window.ga =
        window.ga ||
        function () {
          (ga.q = ga.q || []).push(arguments);
        }),
        (ga.l = +new Date()),
        ga("create", "UA-85220282-1", "auto"),
        ga("set", "anonymizeIp", !0),
        ga("send", "pageview"),
        document.addEventListener("DOMContentLoaded", function () {
          document.forms.search &&
            document.forms.search.query.addEventListener("blur", function () {
              var e;
              this.value &&
                ((e = document.location.pathname),
                ga("send", "pageview", e + "?q=" + this.value));
            }),
            "undefined" != typeof location$ &&
              location$.subscribe(function (e) {
                ga("send", "pageview", e.pathname);
              });
        });
    </script>
    <script async src="../../www.google-analytics.com/analytics.js"></script>
  </head>

  <body
    dir="ltr"
    data-md-color-scheme="cpalgo"
    data-md-color-primary="deep-purple"
    data-md-color-accent=""
  >
    <script>
      var palette = __md_get("__palette");
      if (palette && "object" == typeof palette.color)
        for (var key of Object.keys(palette.color))
          document.body.setAttribute(
            "data-md-color-" + key,
            palette.color[key]
          );
    </script>

    <input
      class="md-toggle"
      data-md-toggle="drawer"
      type="checkbox"
      id="__drawer"
      autocomplete="off"
    />
    <input
      class="md-toggle"
      data-md-toggle="search"
      type="checkbox"
      id="__search"
      autocomplete="off"
    />
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      <a href="#prefix-function-knuthmorrispratt-algorithm" class="md-skip">
        Skip to content
      </a>
    </div>
    <div data-md-component="announce"></div>

    <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
- remove the menu button for mobile
-->

    <header class="md-header" data-md-component="header">
      <script>
        function scrollToTop() {
          document.body.scrollTop = 0; // For Safari
          document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
      </script>
      <nav class="md-header__inner md-grid" aria-label="Header">
        <a
          href="../index-2.html"
          title="Algorithms for Competitive Programming"
          class="md-header__button md-logo"
          aria-label="Algorithms for Competitive Programming"
          data-md-component="logo"
        >
          <img src="../favicon.ico" alt="logo" />
        </a>
        <div class="md-header__title" data-md-component="header-title">
          <div class="md-header__ellipsis">
            <div class="md-header__topic">
              <span class="md-ellipsis">
                <a
                  href="../index-2.html"
                  title="Algorithms for Competitive Programming"
                  aria-label="Algorithms for Competitive Programming"
                  data-md-component="logo"
                >
                  Algorithms for Competitive Programming
                </a>
              </span>
            </div>
            <div class="md-header__topic" data-md-component="header-topic">
              <span class="md-ellipsis">
                <a href="#" onclick="scrollToTop()">
                  Prefix function. Knuth–Morris–Pratt algorithm
                </a>
              </span>
            </div>
          </div>
        </div>

        <form class="md-header__option" data-md-component="palette">
          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="cpalgo"
            data-md-color-primary="deep-purple"
            data-md-color-accent=""
            aria-label="Switch to dark mode"
            type="radio"
            name="__palette"
            id="__palette_1"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to dark mode"
            for="__palette_2"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
              />
            </svg>
          </label>

          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="slate"
            data-md-color-primary=""
            data-md-color-accent=""
            aria-label="Switch to light mode"
            type="radio"
            name="__palette"
            id="__palette_2"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to light mode"
            for="__palette_1"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"
              />
            </svg>
          </label>
        </form>

        <label class="md-header__button md-icon" for="__search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"
            />
          </svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
          <label class="md-search__overlay" for="__search"></label>
        </div>
      </nav>
    </header>

    <div class="md-container" data-md-component="container">
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          <div
            class="md-sidebar md-sidebar--primary"
            data-md-component="sidebar"
            data-md-type="navigation"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--primary"
                  aria-label="Navigation"
                  data-md-level="0"
                >
                  <label class="md-nav__title" for="__drawer">
                    <a
                      href="../index-2.html"
                      title="Algorithms for Competitive Programming"
                      class="md-nav__button md-logo"
                      aria-label="Algorithms for Competitive Programming"
                      data-md-component="logo"
                    >
                      <img src="../favicon.ico" alt="logo" />
                    </a>
                    Algorithms for Competitive Programming
                  </label>

                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="../index-2.html" class="md-nav__link">
                        Main Page
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../contrib.html" class="md-nav__link">
                        How to Contribute
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../preview.html" class="md-nav__link">
                        Preview
                      </a>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_4"
                        type="checkbox"
                        id="__nav_4"
                      />

                      <label class="md-nav__link" for="__nav_4">
                        Algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_4">
                          <span class="md-nav__icon md-icon"></span>
                          Algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../algebra/all-submasks.html"
                              class="md-nav__link"
                            >
                              Submask Enumeration
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/balanced-ternary.html"
                              class="md-nav__link"
                            >
                              Balanced Ternary
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/big-integer.html"
                              class="md-nav__link"
                            >
                              Arbitrary-Precision Arithmetic
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/binary-exp.html"
                              class="md-nav__link"
                            >
                              Binary Exponentiation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/chinese-remainder-theorem.html"
                              class="md-nav__link"
                            >
                              Chinese Remainder Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-log.html"
                              class="md-nav__link"
                            >
                              Discrete Logarithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-root.html"
                              class="md-nav__link"
                            >
                              Discrete Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/divisors.html"
                              class="md-nav__link"
                            >
                              Number of divisors / sum of divisors
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Euclidean algorithm for computing the greatest
                              common divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/extended-euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Extended Euclidean Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-divisors.html"
                              class="md-nav__link"
                            >
                              Finding Power of Factorial Divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-modulo.html"
                              class="md-nav__link"
                            >
                              Factorial modulo p
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorization.html"
                              class="md-nav__link"
                            >
                              Integer factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../algebra/fft.html" class="md-nav__link">
                              Fast Fourier transform
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/fibonacci-numbers.html"
                              class="md-nav__link"
                            >
                              Fibonacci Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/gray-code.html"
                              class="md-nav__link"
                            >
                              Gray code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear-diophantine-equation.html"
                              class="md-nav__link"
                            >
                              Linear Diophantine Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear_congruence_equation.html"
                              class="md-nav__link"
                            >
                              Linear Congruence Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/module-inverse.html"
                              class="md-nav__link"
                            >
                              Modular Multiplicative Inverse
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/montgomery_multiplication.html"
                              class="md-nav__link"
                            >
                              Montgomery Multiplication
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/phi-function.html"
                              class="md-nav__link"
                            >
                              Euler's totient function
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/polynomial.html"
                              class="md-nav__link"
                            >
                              Operations on polynomials and series
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primality_tests.html"
                              class="md-nav__link"
                            >
                              Primality tests
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/prime-sieve-linear.html"
                              class="md-nav__link"
                            >
                              Linear Sieve
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primitive-root.html"
                              class="md-nav__link"
                            >
                              Primitive Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/sieve-of-eratosthenes.html"
                              class="md-nav__link"
                            >
                              Sieve of Eratosthenes
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_5"
                        type="checkbox"
                        id="__nav_5"
                      />

                      <label class="md-nav__link" for="__nav_5">
                        Combinatorics
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Combinatorics"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_5">
                          <span class="md-nav__icon md-icon"></span>
                          Combinatorics
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/binomial-coefficients.html"
                              class="md-nav__link"
                            >
                              Binomial Coefficients
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bishops-on-chessboard.html"
                              class="md-nav__link"
                            >
                              Placing Bishops on a Chessboard
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bracket_sequences.html"
                              class="md-nav__link"
                            >
                              Balanced bracket sequences
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/burnside.html"
                              class="md-nav__link"
                            >
                              Burnside's lemma / Pólya enumeration theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/catalan-numbers.html"
                              class="md-nav__link"
                            >
                              Catalan Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/counting_labeled_graphs.html"
                              class="md-nav__link"
                            >
                              Counting labeled graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/generating_combinations.html"
                              class="md-nav__link"
                            >
                              Generating all K-combinations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/inclusion-exclusion.html"
                              class="md-nav__link"
                            >
                              The Inclusion-Exclusion Principle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/stars_and_bars.html"
                              class="md-nav__link"
                            >
                              Stars and bars
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_6"
                        type="checkbox"
                        id="__nav_6"
                      />

                      <label class="md-nav__link" for="__nav_6">
                        Data structures
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Data structures"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_6">
                          <span class="md-nav__icon md-icon"></span>
                          Data structures
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../data_structures/deleting_in_log_n.html"
                              class="md-nav__link"
                            >
                              Deleting from a data structure in O(T(n)log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/disjoint_set_union.html"
                              class="md-nav__link"
                            >
                              Disjoint Set Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/fenwick.html"
                              class="md-nav__link"
                            >
                              Fenwick Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/randomized_heap.html"
                              class="md-nav__link"
                            >
                              Randomized Heap
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/segment_tree.html"
                              class="md-nav__link"
                            >
                              Segment Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sparse-table.html"
                              class="md-nav__link"
                            >
                              Sparse Table
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt-tree.html"
                              class="md-nav__link"
                            >
                              Sqrt Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt_decomposition.html"
                              class="md-nav__link"
                            >
                              Sqrt Decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/stack_queue_modification.html"
                              class="md-nav__link"
                            >
                              Minimum stack / Minimum queue
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/treap.html"
                              class="md-nav__link"
                            >
                              Treap (Cartesian tree)
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_7"
                        type="checkbox"
                        id="__nav_7"
                      />

                      <label class="md-nav__link" for="__nav_7">
                        Dynamic programming
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Dynamic programming"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_7">
                          <span class="md-nav__icon md-icon"></span>
                          Dynamic programming
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/divide-and-conquer-dp.html"
                              class="md-nav__link"
                            >
                              Divide and Conquer DP
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/profile-dynamics.html"
                              class="md-nav__link"
                            >
                              Dynamic Programming on Broken Profile. Problem
                              "Parquet"
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/zero_matrix.html"
                              class="md-nav__link"
                            >
                              Finding the largest zero submatrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_8"
                        type="checkbox"
                        id="__nav_8"
                      />

                      <label class="md-nav__link" for="__nav_8">
                        Game theory
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Game theory"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_8">
                          <span class="md-nav__icon md-icon"></span>
                          Game theory
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../game_theory/games_on_graphs.html"
                              class="md-nav__link"
                            >
                              Games on arbitrary graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../game_theory/sprague-grundy-nim.html"
                              class="md-nav__link"
                            >
                              Sprague-Grundy theorem. Nim
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_9"
                        type="checkbox"
                        id="__nav_9"
                      />

                      <label class="md-nav__link" for="__nav_9">
                        Geometry
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Geometry"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_9">
                          <span class="md-nav__icon md-icon"></span>
                          Geometry
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../geometry/area-of-simple-polygon.html"
                              class="md-nav__link"
                            >
                              Finding area of simple polygon in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/basic-geometry.html"
                              class="md-nav__link"
                            >
                              Basic Geometry
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/check-segments-intersection.html"
                              class="md-nav__link"
                            >
                              Check if two segments intersect
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/circle-circle-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Circle Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/circle-line-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Line Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/convex-hull.html"
                              class="md-nav__link"
                            >
                              Convex Hull construction
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/convex_hull_trick.html"
                              class="md-nav__link"
                            >
                              Convex hull trick and Li Chao tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/delaunay.html"
                              class="md-nav__link"
                            >
                              Delaunay triangulation and Voronoi diagram
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/halfplane-intersection.html"
                              class="md-nav__link"
                            >
                              Half-plane intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/intersecting_segments.html"
                              class="md-nav__link"
                            >
                              Search for a pair of intersecting segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/lattice-points.html"
                              class="md-nav__link"
                            >
                              Lattice points inside non-lattice polygon
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/length-of-segments-union.html"
                              class="md-nav__link"
                            >
                              Length of the union of segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/lines-intersection.html"
                              class="md-nav__link"
                            >
                              Intersection Point of Lines
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/minkowski.html"
                              class="md-nav__link"
                            >
                              Minkowski sum of convex polygons
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/nearest_points.html"
                              class="md-nav__link"
                            >
                              Finding the nearest pair of points
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/oriented-triangle-area.html"
                              class="md-nav__link"
                            >
                              Oriented area of a triangle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/picks-theorem.html"
                              class="md-nav__link"
                            >
                              Pick's Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/point-in-convex-polygon.html"
                              class="md-nav__link"
                            >
                              Check if point belongs to the convex polygon in
                              $O(\log N)$
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/point-location.html"
                              class="md-nav__link"
                            >
                              Point location in O(log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/segment-to-line.html"
                              class="md-nav__link"
                            >
                              Finding the equation of a line for a segment
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/segments-intersection.html"
                              class="md-nav__link"
                            >
                              Finding intersection of two segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/tangents-to-two-circles.html"
                              class="md-nav__link"
                            >
                              Finding common tangents to two circles
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/vertical_decomposition.html"
                              class="md-nav__link"
                            >
                              Vertical decomposition
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_10"
                        type="checkbox"
                        id="__nav_10"
                      />

                      <label class="md-nav__link" for="__nav_10">
                        Graph
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Graph" data-md-level="1">
                        <label class="md-nav__title" for="__nav_10">
                          <span class="md-nav__icon md-icon"></span>
                          Graph
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="../graph/01_bfs.html" class="md-nav__link">
                              0-1 BFS
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/2SAT.html" class="md-nav__link">
                              2-SAT
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/Assignment-problem-min-flow.html"
                              class="md-nav__link"
                            >
                              Solving assignment problem using min-cost-flow
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/all-pair-shortest-path-floyd-warshall.html"
                              class="md-nav__link"
                            >
                              Floyd-Warshall Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bellman_ford.html"
                              class="md-nav__link"
                            >
                              Bellman-Ford Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bipartite-check.html"
                              class="md-nav__link"
                            >
                              Check whether a graph is bipartite
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/breadth-first-search.html"
                              class="md-nav__link"
                            >
                              Breadth-first search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching-online.html"
                              class="md-nav__link"
                            >
                              Finding Bridges Online
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching.html"
                              class="md-nav__link"
                            >
                              Finding bridges in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/cutpoints.html"
                              class="md-nav__link"
                            >
                              Finding articulation points in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/depth-first-search.html"
                              class="md-nav__link"
                            >
                              Depth First Search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/desopo_pape.html"
                              class="md-nav__link"
                            >
                              D´Esopo-Pape algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra.html"
                              class="md-nav__link"
                            >
                              Dijkstra Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra_sparse.html"
                              class="md-nav__link"
                            >
                              Dijkstra on sparse graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/dinic.html" class="md-nav__link">
                              Maximum flow - Dinic's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edge_vertex_connectivity.html"
                              class="md-nav__link"
                            >
                              Edge connectivity / Vertex connectivity
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edmonds_karp.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Ford-Fulkerson and Edmonds-Karp
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/euler_path.html"
                              class="md-nav__link"
                            >
                              Finding the Eulerian path in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-cycle.html"
                              class="md-nav__link"
                            >
                              Checking a graph for acyclicity and finding a
                              cycle in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-negative-cycle-in-graph.html"
                              class="md-nav__link"
                            >
                              Finding a negative cycle in the graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/fixed_length_paths.html"
                              class="md-nav__link"
                            >
                              Number of paths of fixed length / Shortest paths
                              of fixed length
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/flow_with_demands.html"
                              class="md-nav__link"
                            >
                              Flows with demands
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/hld.html" class="md-nav__link">
                              Heavy-light decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kirchhoff-theorem.html"
                              class="md-nav__link"
                            >
                              Kirchhoff's theorem. Finding the number of
                              spanning trees
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kuhn_maximum_bipartite_matching.html"
                              class="md-nav__link"
                            >
                              Kuhn's Algorithm for Maximum Bipartite Matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/lca.html" class="md-nav__link">
                              Lowest Common Ancestor - O(sqrt(N)) and O(log N)
                              with O(N) preprocessing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_binary_lifting.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Binary Lifting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_farachcoltonbender.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Farach-Colton and Bender
                              Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_tarjan.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Tarjan's off-line
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/min_cost_flow.html"
                              class="md-nav__link"
                            >
                              Minimum-cost flow - Successive shortest path
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/mpm.html" class="md-nav__link">
                              Maximum flow - MPM algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal_with_dsu.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal with Disjoint Set
                              Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_prim.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Prim's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/pruefer_code.html"
                              class="md-nav__link"
                            >
                              Prüfer code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel-faster.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel method improved
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/rmq_linear.html"
                              class="md-nav__link"
                            >
                              Solve RMQ (Range Minimum Query) by finding LCA
                              (Lowest Common Ancestor)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/search-for-connected-components.html"
                              class="md-nav__link"
                            >
                              Search for connected components in a graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/second_best_mst.html"
                              class="md-nav__link"
                            >
                              Second Best Minimum Spanning Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strong-orientation.html"
                              class="md-nav__link"
                            >
                              Strong Orientation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strongly-connected-components.html"
                              class="md-nav__link"
                            >
                              Finding strongly connected components / Building
                              condensation graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/topological-sort.html"
                              class="md-nav__link"
                            >
                              Topological Sorting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/tree_painting.html"
                              class="md-nav__link"
                            >
                              Paint the edges of the tree
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_11"
                        type="checkbox"
                        id="__nav_11"
                      />

                      <label class="md-nav__link" for="__nav_11">
                        Linear algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Linear algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_11">
                          <span class="md-nav__icon md-icon"></span>
                          Linear algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-gauss.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant of a matrix by Gauss
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-kraut.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant using Kraut method
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/linear-system-gauss.html"
                              class="md-nav__link"
                            >
                              Gauss method for solving system of linear
                              equations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/rank-matrix.html"
                              class="md-nav__link"
                            >
                              Finding the rank of a matrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_12"
                        type="checkbox"
                        id="__nav_12"
                      />

                      <label class="md-nav__link" for="__nav_12">
                        Num methods
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Num methods"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_12">
                          <span class="md-nav__icon md-icon"></span>
                          Num methods
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../num_methods/roots_newton.html"
                              class="md-nav__link"
                            >
                              Newton's method for finding roots
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/simpson-integration.html"
                              class="md-nav__link"
                            >
                              Integration by Simpson's formula
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/ternary_search.html"
                              class="md-nav__link"
                            >
                              Ternary Search
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_13"
                        type="checkbox"
                        id="__nav_13"
                      />

                      <label class="md-nav__link" for="__nav_13">
                        Others
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Others" data-md-level="1">
                        <label class="md-nav__title" for="__nav_13">
                          <span class="md-nav__icon md-icon"></span>
                          Others
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../others/15-puzzle.html"
                              class="md-nav__link"
                            >
                              15 Puzzle Game: Existence Of The Solution
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/josephus_problem.html"
                              class="md-nav__link"
                            >
                              Josephus Problem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/maximum_average_segment.html"
                              class="md-nav__link"
                            >
                              Search the subarray with the maximum/minimum sum
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/stern_brocot_tree_farey_sequences.html"
                              class="md-nav__link"
                            >
                              The Stern-Brocot tree and Farey sequences
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_14"
                        type="checkbox"
                        id="__nav_14"
                      />

                      <label class="md-nav__link" for="__nav_14">
                        Schedules
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Schedules"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_14">
                          <span class="md-nav__icon md-icon"></span>
                          Schedules
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule-with-completion-duration.html"
                              class="md-nav__link"
                            >
                              Optimal schedule of jobs given their deadlines and
                              durations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_one_machine.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on one machine
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_two_machines.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on two machines
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_15"
                        type="checkbox"
                        id="__nav_15"
                      />

                      <label class="md-nav__link" for="__nav_15">
                        Sequences
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Sequences"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_15">
                          <span class="md-nav__icon md-icon"></span>
                          Sequences
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../sequences/k-th.html"
                              class="md-nav__link"
                            >
                              K-th order statistic in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/longest_increasing_subsequence.html"
                              class="md-nav__link"
                            >
                              Longest increasing subsequence
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/rmq.html"
                              class="md-nav__link"
                            >
                              Range Minimum Query
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li
                      class="md-nav__item md-nav__item--active md-nav__item--nested"
                    >
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_16"
                        type="checkbox"
                        id="__nav_16"
                        checked
                      />

                      <label class="md-nav__link" for="__nav_16">
                        String
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="String" data-md-level="1">
                        <label class="md-nav__title" for="__nav_16">
                          <span class="md-nav__icon md-icon"></span>
                          String
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="aho_corasick.html" class="md-nav__link">
                              Aho-Corasick algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="expression_parsing.html"
                              class="md-nav__link"
                            >
                              Expression parsing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="lyndon_factorization.html"
                              class="md-nav__link"
                            >
                              Lyndon factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="main_lorentz.html" class="md-nav__link">
                              Finding repetitions
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="manacher.html" class="md-nav__link">
                              Manacher's Algorithm - Finding all sub-palindromes
                              in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item md-nav__item--active">
                            <input
                              class="md-nav__toggle md-toggle"
                              data-md-toggle="toc"
                              type="checkbox"
                              id="__toc"
                            />

                            <label
                              class="md-nav__link md-nav__link--active"
                              for="__toc"
                            >
                              Prefix function. Knuth–Morris–Pratt algorithm
                              <span class="md-nav__icon md-icon"></span>
                            </label>

                            <a
                              href="prefix-function.html"
                              class="md-nav__link md-nav__link--active"
                            >
                              Prefix function. Knuth–Morris–Pratt algorithm
                            </a>

                            <nav
                              class="md-nav md-nav--secondary"
                              aria-label="Table of contents"
                            >
                              <label class="md-nav__title" for="__toc">
                                <span class="md-nav__icon md-icon"></span>
                                Table of contents
                              </label>
                              <ul
                                class="md-nav__list"
                                data-md-component="toc"
                                data-md-scrollfix
                              >
                                <li class="md-nav__item">
                                  <a
                                    href="#prefix-function-definition"
                                    class="md-nav__link"
                                  >
                                    Prefix function definition
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#trivial-algorithm"
                                    class="md-nav__link"
                                  >
                                    Trivial Algorithm
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#efficient-algorithm"
                                    class="md-nav__link"
                                  >
                                    Efficient Algorithm
                                  </a>

                                  <nav
                                    class="md-nav"
                                    aria-label="Efficient Algorithm"
                                  >
                                    <ul class="md-nav__list">
                                      <li class="md-nav__item">
                                        <a
                                          href="#first-optimization"
                                          class="md-nav__link"
                                        >
                                          First optimization
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#second-optimization"
                                          class="md-nav__link"
                                        >
                                          Second optimization
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#final-algorithm"
                                          class="md-nav__link"
                                        >
                                          Final algorithm
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#implementation"
                                          class="md-nav__link"
                                        >
                                          Implementation
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </li>

                                <li class="md-nav__item">
                                  <a href="#applications" class="md-nav__link">
                                    Applications
                                  </a>

                                  <nav class="md-nav" aria-label="Applications">
                                    <ul class="md-nav__list">
                                      <li class="md-nav__item">
                                        <a
                                          href="#search-for-a-substring-in-a-string-the-knuth-morris-pratt-algorithm"
                                          class="md-nav__link"
                                        >
                                          Search for a substring in a string.
                                          The Knuth-Morris-Pratt algorithm
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#counting-the-number-of-occurrences-of-each-prefix"
                                          class="md-nav__link"
                                        >
                                          Counting the number of occurrences of
                                          each prefix
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#the-number-of-different-substring-in-a-string"
                                          class="md-nav__link"
                                        >
                                          The number of different substring in a
                                          string
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#compressing-a-string"
                                          class="md-nav__link"
                                        >
                                          Compressing a string
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#building-an-automaton-according-to-the-prefix-function"
                                          class="md-nav__link"
                                        >
                                          Building an automaton according to the
                                          prefix function
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#practice-problems"
                                    class="md-nav__link"
                                  >
                                    Practice Problems
                                  </a>
                                </li>
                              </ul>
                            </nav>
                          </li>

                          <li class="md-nav__item">
                            <a href="rabin-karp.html" class="md-nav__link">
                              Rabin-Karp Algorithm for string matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="string-hashing.html" class="md-nav__link">
                              String Hashing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="suffix-array.html" class="md-nav__link">
                              Suffix Array
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="suffix-automaton.html"
                              class="md-nav__link"
                            >
                              Suffix Automaton
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="suffix-tree-ukkonen.html"
                              class="md-nav__link"
                            >
                              Suffix Tree. Ukkonen's Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="z-function.html" class="md-nav__link">
                              Z-function and its calculation
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div
            class="md-sidebar md-sidebar--secondary"
            data-md-component="sidebar"
            data-md-type="toc"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--secondary"
                  aria-label="Table of contents"
                >
                  <label class="md-nav__title" for="__toc">
                    <span class="md-nav__icon md-icon"></span>
                    Table of contents
                  </label>
                  <ul
                    class="md-nav__list"
                    data-md-component="toc"
                    data-md-scrollfix
                  >
                    <li class="md-nav__item">
                      <a
                        href="#prefix-function-definition"
                        class="md-nav__link"
                      >
                        Prefix function definition
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#trivial-algorithm" class="md-nav__link">
                        Trivial Algorithm
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#efficient-algorithm" class="md-nav__link">
                        Efficient Algorithm
                      </a>

                      <nav class="md-nav" aria-label="Efficient Algorithm">
                        <ul class="md-nav__list">
                          <li class="md-nav__item">
                            <a href="#first-optimization" class="md-nav__link">
                              First optimization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="#second-optimization" class="md-nav__link">
                              Second optimization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="#final-algorithm" class="md-nav__link">
                              Final algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="#implementation" class="md-nav__link">
                              Implementation
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item">
                      <a href="#applications" class="md-nav__link">
                        Applications
                      </a>

                      <nav class="md-nav" aria-label="Applications">
                        <ul class="md-nav__list">
                          <li class="md-nav__item">
                            <a
                              href="#search-for-a-substring-in-a-string-the-knuth-morris-pratt-algorithm"
                              class="md-nav__link"
                            >
                              Search for a substring in a string. The
                              Knuth-Morris-Pratt algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#counting-the-number-of-occurrences-of-each-prefix"
                              class="md-nav__link"
                            >
                              Counting the number of occurrences of each prefix
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#the-number-of-different-substring-in-a-string"
                              class="md-nav__link"
                            >
                              The number of different substring in a string
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#compressing-a-string"
                              class="md-nav__link"
                            >
                              Compressing a string
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#building-an-automaton-according-to-the-prefix-function"
                              class="md-nav__link"
                            >
                              Building an automaton according to the prefix
                              function
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item">
                      <a href="#practice-problems" class="md-nav__link">
                        Practice Problems
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              <script type="text/javascript">
                window.onload = function () {
                  const newIssueURL =
                    "https://github.com/e-maxx-eng/e-maxx-eng/issues/new";
                  const issueTitle = `Problem on article "Prefix function. Knuth–Morris–Pratt algorithm"`;
                  const issueBody = `
 **Article:** [Prefix function. Knuth–Morris–Pratt algorithm](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
                  var issue_a = document.getElementById("report_issue_a");
                  issue_a.href =
                    `${newIssueURL}?` +
                    `title=${encodeURIComponent(issueTitle)}&` +
                    `body=${encodeURIComponent(issueBody)}`;
                };
              </script>

              <h1 id="prefix-function-knuthmorrispratt-algorithm">
                Prefix function. Knuth–Morris–Pratt algorithm
              </h1>
              <h2 id="prefix-function-definition">
                Prefix function definition
              </h2>
              <p>
                You are given a string <span class="arithmatex">\(s\)</span> of
                length <span class="arithmatex">\(n\)</span>. The
                <strong>prefix function</strong> for this string is defined as
                an array <span class="arithmatex">\(\pi\)</span> of length
                <span class="arithmatex">\(n\)</span>, where
                <span class="arithmatex">\(\pi[i]\)</span> is the length of the
                longest proper prefix of the substring
                <span class="arithmatex">\(s[0 \dots i]\)</span> which is also a
                suffix of this substring. A proper prefix of a string is a
                prefix that is not equal to the string itself. By definition,
                <span class="arithmatex">\(\pi[0] = 0\)</span>.
              </p>
              <p>
                Mathematically the definition of the prefix function can be
                written as follows:
              </p>
              <div class="arithmatex">
                \[\pi[i] = \max_ {k = 0 \dots i} \{k : s[0 \dots k-1] =
                s[i-(k-1) \dots i] \}\]
              </div>
              <p>
                For example, prefix function of string "abcabcd" is
                <span class="arithmatex">\([0, 0, 0, 1, 2, 3, 0]\)</span>, and
                prefix function of string "aabaaab" is
                <span class="arithmatex">\([0, 1, 0, 1, 2, 2, 3]\)</span>.
              </p>
              <h2 id="trivial-algorithm">Trivial Algorithm</h2>
              <p>
                An algorithm which follows the definition of prefix function
                exactly is the following:
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prefix_function</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">s</span><span class="p">.</span><span class="n">length</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pi</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="w">                </span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">pi</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                It is easy to see that its complexity is
                <span class="arithmatex">\(O(n^3)\)</span>, which has room for
                improvement.
              </p>
              <h2 id="efficient-algorithm">Efficient Algorithm</h2>
              <p>
                This algorithm was proposed by Knuth and Pratt and independently
                from them by Morris in 1977. It was used as the main function of
                a substring search algorithm.
              </p>
              <h3 id="first-optimization">First optimization</h3>
              <p>
                The first important observation is, that the values of the
                prefix function can only increase by at most one.
              </p>
              <p>
                Indeed, otherwise, if
                <span class="arithmatex">\(\pi[i + 1] \gt \pi[i] + 1\)</span>,
                then we can take this suffix ending in position
                <span class="arithmatex">\(i + 1\)</span> with the length
                <span class="arithmatex">\(\pi[i + 1]\)</span> and remove the
                last character from it. We end up with a suffix ending in
                position <span class="arithmatex">\(i\)</span> with the length
                <span class="arithmatex">\(\pi[i + 1] - 1\)</span>, which is
                better than <span class="arithmatex">\(\pi[i]\)</span>, i.e. we
                get a contradiction.
              </p>
              <p>
                The following illustration shows this contradiction. The longest
                proper suffix at position
                <span class="arithmatex">\(i\)</span> that also is a prefix is
                of length <span class="arithmatex">\(2\)</span>, and at position
                <span class="arithmatex">\(i+1\)</span> it is of length
                <span class="arithmatex">\(4\)</span>. Therefore the string
                <span class="arithmatex">\(s_0 ~ s_1 ~ s_2 ~ s_3\)</span> is
                equal to the string
                <span class="arithmatex"
                  >\(s_{i-2} ~ s_{i-1} ~ s_i ~ s_{i+1}\)</span
                >, which means that also the strings
                <span class="arithmatex">\(s_0 ~ s_1 ~ s_2\)</span> and
                <span class="arithmatex">\(s_{i-2} ~ s_{i-1} ~ s_i\)</span> are
                equal, therefore <span class="arithmatex">\(\pi[i]\)</span> has
                to be <span class="arithmatex">\(3\)</span>.
              </p>
              <div class="arithmatex">
                \[\underbrace{\overbrace{s_0 ~ s_1}^{\pi[i] = 2} ~ s_2 ~
                s_3}_{\pi[i+1] = 4} ~ \dots ~ \underbrace{s_{i-2} ~
                \overbrace{s_{i-1} ~ s_{i}}^{\pi[i] = 2} ~ s_{i+1}}_{\pi[i+1] =
                4}\]
              </div>
              <p>
                Thus when moving to the next position, the value of the prefix
                function can either increase by one, stay the same, or decrease
                by some amount. This fact already allows us to reduce the
                complexity of the algorithm to
                <span class="arithmatex">\(O(n^2)\)</span>, because in one step
                the prefix function can grow at most by one. In total the
                function can grow at most
                <span class="arithmatex">\(n\)</span> steps, and therefore also
                only can decrease a total of
                <span class="arithmatex">\(n\)</span> steps. This means we only
                have to perform <span class="arithmatex">\(O(n)\)</span> string
                comparisons, and reach the complexity
                <span class="arithmatex">\(O(n^2)\)</span>.
              </p>
              <h3 id="second-optimization">Second optimization</h3>
              <p>
                Let's go further, we want to get rid of the string comparisons.
                To accomplish this, we have to use all the information computed
                in the previous steps.
              </p>
              <p>
                So let us compute the value of the prefix function
                <span class="arithmatex">\(\pi\)</span> for
                <span class="arithmatex">\(i + 1\)</span>. If
                <span class="arithmatex">\(s[i+1] = s[\pi[i]]\)</span>, then we
                can say with certainty that
                <span class="arithmatex">\(\pi[i+1] = \pi[i] + 1\)</span>, since
                we already know that the suffix at position
                <span class="arithmatex">\(i\)</span> of length
                <span class="arithmatex">\(\pi[i]\)</span> is equal to the
                prefix of length <span class="arithmatex">\(\pi[i]\)</span>.
                This is illustrated again with an example.
              </p>
              <div class="arithmatex">
                \[\underbrace{\overbrace{s_0 ~ s_1 ~ s_2}^{\pi[i]} ~
                \overbrace{s_3}^{s_3 = s_{i+1}}}_{\pi[i+1] = \pi[i] + 1} ~ \dots
                ~ \underbrace{\overbrace{s_{i-2} ~ s_{i-1} ~ s_{i}}^{\pi[i]} ~
                \overbrace{s_{i+1}}^{s_3 = s_{i + 1}}}_{\pi[i+1] = \pi[i] + 1}\]
              </div>
              <p>
                If this is not the case,
                <span class="arithmatex">\(s[i+1] \neq s[\pi[i]]\)</span>, then
                we need to try a shorter string. In order to speed things up, we
                would like to immediately move to the longest length
                <span class="arithmatex">\(j \lt \pi[i]\)</span>, such that the
                prefix property in the position
                <span class="arithmatex">\(i\)</span> holds, i.e.
                <span class="arithmatex"
                  >\(s[0 \dots j-1] = s[i-j+1 \dots i]\)</span
                >:
              </p>
              <div class="arithmatex">
                \[\overbrace{\underbrace{s_0 ~ s_1}_j ~ s_2 ~ s_3}^{\pi[i]} ~
                \dots ~ \overbrace{s_{i-3} ~ s_{i-2} ~ \underbrace{s_{i-1} ~
                s_{i}}_j}^{\pi[i]} ~ s_{i+1}\]
              </div>
              <p>
                Indeed, if we find such a length
                <span class="arithmatex">\(j\)</span>, then we again only need
                to compare the characters
                <span class="arithmatex">\(s[i+1]\)</span> and
                <span class="arithmatex">\(s[j]\)</span>. If they are equal,
                then we can assign
                <span class="arithmatex">\(\pi[i+1] = j + 1\)</span>. Otherwise
                we will need to find the largest value smaller than
                <span class="arithmatex">\(j\)</span>, for which the prefix
                property holds, and so on. It can happen that this goes until
                <span class="arithmatex">\(j = 0\)</span>. If then
                <span class="arithmatex">\(s[i+1] = s[0]\)</span>, we assign
                <span class="arithmatex">\(\pi[i+1] = 1\)</span>, and
                <span class="arithmatex">\(\pi[i+1] = 0\)</span> otherwise.
              </p>
              <p>
                So we already have a general scheme of the algorithm. The only
                question left is how do we effectively find the lengths for
                <span class="arithmatex">\(j\)</span>. Let's recap: for the
                current length <span class="arithmatex">\(j\)</span> at the
                position <span class="arithmatex">\(i\)</span> for which the
                prefix property holds, i.e.
                <span class="arithmatex"
                  >\(s[0 \dots j-1] = s[i-j+1 \dots i]\)</span
                >, we want to find the greatest
                <span class="arithmatex">\(k \lt j\)</span>, for which the
                prefix property holds.
              </p>
              <div class="arithmatex">
                \[\overbrace{\underbrace{s_0 ~ s_1}_k ~ s_2 ~ s_3}^j ~ \dots ~
                \overbrace{s_{i-3} ~ s_{i-2} ~ \underbrace{s_{i-1} ~ s_{i}}_k}^j
                ~s_{i+1}\]
              </div>
              <p>
                The illustration shows, that this has to be the value of
                <span class="arithmatex">\(\pi[j-1]\)</span>, which we already
                calculated earlier.
              </p>
              <h3 id="final-algorithm">Final algorithm</h3>
              <p>
                So we finally can build an algorithm that doesn't perform any
                string comparisons and only performs
                <span class="arithmatex">\(O(n)\)</span> actions.
              </p>
              <p>Here is the final procedure:</p>
              <ul>
                <li>
                  We compute the prefix values
                  <span class="arithmatex">\(\pi[i]\)</span> in a loop by
                  iterating from <span class="arithmatex">\(i = 1\)</span> to
                  <span class="arithmatex">\(i = n-1\)</span> (<span
                    class="arithmatex"
                    >\(\pi[0]\)</span
                  >
                  just gets assigned with
                  <span class="arithmatex">\(0\)</span>).
                </li>
                <li>
                  To calculate the current value
                  <span class="arithmatex">\(\pi[i]\)</span> we set the variable
                  <span class="arithmatex">\(j\)</span> denoting the length of
                  the best suffix for <span class="arithmatex">\(i-1\)</span>.
                  Initially <span class="arithmatex">\(j = \pi[i-1]\)</span>.
                </li>
                <li>
                  Test if the suffix of length
                  <span class="arithmatex">\(j+1\)</span> is also a prefix by
                  comparing <span class="arithmatex">\(s[j]\)</span> and
                  <span class="arithmatex">\(s[i]\)</span>. If they are equal
                  then we assign
                  <span class="arithmatex">\(\pi[i] = j + 1\)</span>, otherwise
                  we reduce <span class="arithmatex">\(j\)</span> to
                  <span class="arithmatex">\(\pi[j-1]\)</span> and repeat this
                  step.
                </li>
                <li>
                  If we have reached the length
                  <span class="arithmatex">\(j = 0\)</span> and still don't have
                  a match, then we assign
                  <span class="arithmatex">\(\pi[i] = 0\)</span> and go to the
                  next index <span class="arithmatex">\(i + 1\)</span>.
                </li>
              </ul>
              <h3 id="implementation">Implementation</h3>
              <p>
                The implementation ends up being surprisingly short and
                expressive.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">prefix_function</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">s</span><span class="p">.</span><span class="n">length</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pi</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"></span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="mi">-1</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"></span>
<span class="w">            </span><span class="n">j</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">pi</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                This is an <strong>online</strong> algorithm, i.e. it processes
                the data as it arrives - for example, you can read the string
                characters one by one and process them immediately, finding the
                value of prefix function for each next character. The algorithm
                still requires storing the string itself and the previously
                calculated values of prefix function, but if we know beforehand
                the maximum value <span class="arithmatex">\(M\)</span> the
                prefix function can take on the string, we can store only
                <span class="arithmatex">\(M+1\)</span> first characters of the
                string and the same number of values of the prefix function.
              </p>
              <h2 id="applications">Applications</h2>
              <h3
                id="search-for-a-substring-in-a-string-the-knuth-morris-pratt-algorithm"
              >
                Search for a substring in a string. The Knuth-Morris-Pratt
                algorithm
              </h3>
              <p>
                The task is the classical application of the prefix function.
              </p>
              <p>
                Given a text <span class="arithmatex">\(t\)</span> and a string
                <span class="arithmatex">\(s\)</span>, we want to find and
                display the positions of all occurrences of the string
                <span class="arithmatex">\(s\)</span> in the text
                <span class="arithmatex">\(t\)</span>.
              </p>
              <p>
                For convenience we denote with
                <span class="arithmatex">\(n\)</span> the length of the string s
                and with <span class="arithmatex">\(m\)</span> the length of the
                text <span class="arithmatex">\(t\)</span>.
              </p>
              <p>
                We generate the string
                <span class="arithmatex">\(s + \# + t\)</span>, where
                <span class="arithmatex">\(\#\)</span> is a separator that
                appears neither in <span class="arithmatex">\(s\)</span> nor in
                <span class="arithmatex">\(t\)</span>. Let us calculate the
                prefix function for this string. Now think about the meaning of
                the values of the prefix function, except for the first
                <span class="arithmatex">\(n + 1\)</span> entries (which belong
                to the string <span class="arithmatex">\(s\)</span> and the
                separator). By definition the value
                <span class="arithmatex">\(\pi[i]\)</span> shows the longest
                length of a substring ending in position
                <span class="arithmatex">\(i\)</span> that coincides with the
                prefix. But in our case this is nothing more than the largest
                block that coincides with
                <span class="arithmatex">\(s\)</span> and ends at position
                <span class="arithmatex">\(i\)</span>. This length cannot be
                bigger than <span class="arithmatex">\(n\)</span> due to the
                separator. But if equality
                <span class="arithmatex">\(\pi[i] = n\)</span> is achieved, then
                it means that the string
                <span class="arithmatex">\(s\)</span> appears completely in at
                this position, i.e. it ends at position
                <span class="arithmatex">\(i\)</span>. Just do not forget that
                the positions are indexed in the string
                <span class="arithmatex">\(s + \# + t\)</span>.
              </p>
              <p>
                Thus if at some position
                <span class="arithmatex">\(i\)</span> we have
                <span class="arithmatex">\(\pi[i] = n\)</span>, then at the
                position
                <span class="arithmatex">\(i - (n + 1) - n + 1 = i - 2n\)</span>
                in the string <span class="arithmatex">\(t\)</span> the string
                <span class="arithmatex">\(s\)</span> appears.
              </p>
              <p>
                As already mentioned in the description of the prefix function
                computation, if we know that the prefix values never exceed a
                certain value, then we do not need to store the entire string
                and the entire function, but only its beginning. In our case
                this means that we only need to store the string
                <span class="arithmatex">\(s + \#\)</span> and the values of the
                prefix function for it. We can read one character at a time of
                the string <span class="arithmatex">\(t\)</span> and calculate
                the current value of the prefix function.
              </p>
              <p>
                Thus the Knuth-Morris-Pratt algorithm solves the problem in
                <span class="arithmatex">\(O(n + m)\)</span> time and
                <span class="arithmatex">\(O(n)\)</span> memory.
              </p>
              <h3 id="counting-the-number-of-occurrences-of-each-prefix">
                Counting the number of occurrences of each prefix
              </h3>
              <p>
                Here we discuss two problems at once. Given a string
                <span class="arithmatex">\(s\)</span> of length
                <span class="arithmatex">\(n\)</span>. In the first variation of
                the problem we want to count the number of appearances of each
                prefix <span class="arithmatex">\(s[0 \dots i]\)</span> in the
                same string. In the second variation of the problem another
                string <span class="arithmatex">\(t\)</span> is given and we
                want to count the number of appearances of each prefix
                <span class="arithmatex">\(s[0 \dots i]\)</span> in
                <span class="arithmatex">\(t\)</span>.
              </p>
              <p>
                First we solve the first problem. Consider the value of the
                prefix function <span class="arithmatex">\(\pi[i]\)</span> at a
                position <span class="arithmatex">\(i\)</span>. By definition it
                means that in position <span class="arithmatex">\(i\)</span> the
                prefix of length <span class="arithmatex">\(\pi[i]\)</span> of
                the string <span class="arithmatex">\(s\)</span> appears and
                ends at position <span class="arithmatex">\(i\)</span>, and
                there doesn't exists a longer prefix that follows this
                definition. At the same time shorter prefixes can end at this
                position. It is not difficult to see, that we have the same
                question that we already answered when we computed the prefix
                function itself: Given a prefix of length
                <span class="arithmatex">\(j\)</span> that is a suffix ending at
                position <span class="arithmatex">\(i\)</span>, what is the next
                smaller prefix <span class="arithmatex">\(\lt j\)</span> that is
                also a suffix ending at position
                <span class="arithmatex">\(i\)</span>. Thus at the position
                <span class="arithmatex">\(i\)</span> ends the prefix of length
                <span class="arithmatex">\(\pi[i]\)</span>, the prefix of length
                <span class="arithmatex">\(\pi[\pi[i] - 1]\)</span>, the prefix
                <span class="arithmatex">\(\pi[\pi[\pi[i] - 1] - 1]\)</span>,
                and so on, until the index becomes zero. Thus we can compute the
                answer in the following way.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ans</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">ans</span><span class="p">[</span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">ans</span><span class="p">[</span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                Here for each value of the prefix function we first count how
                many times it occurs in the array
                <span class="arithmatex">\(\pi\)</span>, and then compute the
                final answers: if we know that the length prefix
                <span class="arithmatex">\(i\)</span> appears exactly
                <span class="arithmatex">\(\text{ans}[i]\)</span> times, then
                this number must be added to the number of occurrences of its
                longest suffix that is also a prefix. At the end we need to add
                <span class="arithmatex">\(1\)</span> to each result, since we
                also need to count the original prefixes also.
              </p>
              <p>
                Now let us consider the second problem. We apply the trick from
                Knuth-Morris-Pratt: we create the string
                <span class="arithmatex">\(s + \# + t\)</span> and compute its
                prefix function. The only differences to the first task is, that
                we are only interested in the prefix values that relate to the
                string <span class="arithmatex">\(t\)</span>, i.e.
                <span class="arithmatex">\(\pi[i]\)</span> for
                <span class="arithmatex">\(i \ge n + 1\)</span>. With those
                values we can perform the exact same computations as in the
                first task.
              </p>
              <h3 id="the-number-of-different-substring-in-a-string">
                The number of different substring in a string
              </h3>
              <p>
                Given a string <span class="arithmatex">\(s\)</span> of length
                <span class="arithmatex">\(n\)</span>. We want to compute the
                number of different substrings appearing in it.
              </p>
              <p>
                We will solve this problem iteratively. Namely we will learn,
                knowing the current number of different substrings, how to
                recompute this count by adding a character to the end.
              </p>
              <p>
                So let <span class="arithmatex">\(k\)</span> be the current
                number of different substrings in
                <span class="arithmatex">\(s\)</span>, and we add the character
                <span class="arithmatex">\(c\)</span> to the end of
                <span class="arithmatex">\(s\)</span>. Obviously some new
                substrings ending in <span class="arithmatex">\(c\)</span> will
                appear. We want to count these new substrings that didn't appear
                before.
              </p>
              <p>
                We take the string
                <span class="arithmatex">\(t = s + c\)</span> and reverse it.
                Now the task is transformed into computing how many prefixes
                there are that don't appear anywhere else. If we compute the
                maximal value of the prefix function
                <span class="arithmatex">\(\pi_{\text{max}}\)</span> of the
                reversed string <span class="arithmatex">\(t\)</span>, then the
                longest prefix that appears in
                <span class="arithmatex">\(s\)</span> is
                <span class="arithmatex">\(\pi_{\text{max}}\)</span> long.
                Clearly also all prefixes of smaller length appear in it.
              </p>
              <p>
                Therefore the number of new substrings appearing when we add a
                new character <span class="arithmatex">\(c\)</span> is
                <span class="arithmatex">\(|s| + 1 - \pi_{\text{max}}\)</span>.
              </p>
              <p>
                So for each character appended we can compute the number of new
                substrings in <span class="arithmatex">\(O(n)\)</span> times,
                which gives a time complexity of
                <span class="arithmatex">\(O(n^2)\)</span> in total.
              </p>
              <p>
                It is worth noting, that we can also compute the number of
                different substrings by appending the characters at the
                beginning, or by deleting characters from the beginning or the
                end.
              </p>
              <h3 id="compressing-a-string">Compressing a string</h3>
              <p>
                Given a string <span class="arithmatex">\(s\)</span> of length
                <span class="arithmatex">\(n\)</span>. We want to find the
                shortest "compressed" representation of the string, i.e. we want
                to find a string <span class="arithmatex">\(t\)</span> of
                smallest length such that
                <span class="arithmatex">\(s\)</span> can be represented as a
                concatenation of one or more copies of
                <span class="arithmatex">\(t\)</span>.
              </p>
              <p>
                It is clear, that we only need to find the length of
                <span class="arithmatex">\(t\)</span>. Knowing the length, the
                answer to the problem will be the prefix of
                <span class="arithmatex">\(s\)</span> with this length.
              </p>
              <p>
                Let us compute the prefix function for
                <span class="arithmatex">\(s\)</span>. Using the last value of
                it we define the value
                <span class="arithmatex">\(k = n - \pi[n - 1]\)</span>. We will
                show, that if <span class="arithmatex">\(k\)</span> divides
                <span class="arithmatex">\(n\)</span>, then
                <span class="arithmatex">\(k\)</span> will be the answer,
                otherwise there doesn't exists an effective compression and the
                answer is <span class="arithmatex">\(n\)</span>.
              </p>
              <p>
                Let <span class="arithmatex">\(n\)</span> be divisible by
                <span class="arithmatex">\(k\)</span>. Then the string can be
                partitioned into blocks of the length
                <span class="arithmatex">\(k\)</span>. By definition of the
                prefix function, the prefix of length
                <span class="arithmatex">\(n - k\)</span> will be equal with its
                suffix. But this means that the last block is equal to the block
                before. And the block before has to be equal to the block before
                it. And so on. As a result, it turns out that all blocks are
                equal, therefore we can compress the string
                <span class="arithmatex">\(s\)</span> to length
                <span class="arithmatex">\(k\)</span>.
              </p>
              <p>
                Of course we still need to show that this is actually the
                optimum. Indeed, if there was a smaller compression than
                <span class="arithmatex">\(k\)</span>, than the prefix function
                at the end would be greater than
                <span class="arithmatex">\(n - k\)</span>. Therefore
                <span class="arithmatex">\(k\)</span> is really the answer.
              </p>
              <p>
                Now let us assume that <span class="arithmatex">\(n\)</span> is
                not divisible by <span class="arithmatex">\(k\)</span>. We show
                that this implies that the length of the answer is
                <span class="arithmatex">\(n\)</span>. We prove it by
                contradiction. Assuming there exists an answer, and the
                compression has length
                <span class="arithmatex">\(p\)</span> (<span class="arithmatex"
                  >\(p\)</span
                >
                divides <span class="arithmatex">\(n\)</span>). Then the last
                value of the prefix function has to be greater than
                <span class="arithmatex">\(n - p\)</span>, i.e. the suffix will
                partially cover the first block. Now consider the second block
                of the string. Since the prefix is equal with the suffix, and
                both the prefix and the suffix cover this block and their
                displacement relative to each other
                <span class="arithmatex">\(k\)</span> does not divide the block
                length <span class="arithmatex">\(p\)</span> (otherwise
                <span class="arithmatex">\(k\)</span> divides
                <span class="arithmatex">\(n\)</span>), then all the characters
                of the block have to be identical. But then the string consists
                of only one character repeated over and over, hence we can
                compress it to a string of size
                <span class="arithmatex">\(1\)</span>, which gives
                <span class="arithmatex">\(k = 1\)</span>, and
                <span class="arithmatex">\(k\)</span> divides
                <span class="arithmatex">\(n\)</span>. Contradiction.
              </p>
              <div class="arithmatex">
                \[\overbrace{s_0 ~ s_1 ~ s_2 ~ s_3}^p ~ \overbrace{s_4 ~ s_5 ~
                s_6 ~ s_7}^p\]
              </div>
              <div class="arithmatex">
                \[s_0 ~ s_1 ~ s_2 ~ \underbrace{\overbrace{s_3 ~ s_4 ~ s_5 ~
                s_6}^p ~ s_7}_{\pi[7] = 5}\]
              </div>
              <div class="arithmatex">
                \[s_4 = s_3, ~ s_5 = s_4, ~ s_6 = s_5, ~ s_7 = s_6 ~ \Rightarrow
                ~ s_0 = s_1 = s_2 = s_3\]
              </div>
              <h3 id="building-an-automaton-according-to-the-prefix-function">
                Building an automaton according to the prefix function
              </h3>
              <p>
                Let's return to the concatenation to the two strings through a
                separator, i.e. for the strings
                <span class="arithmatex">\(s\)</span> and
                <span class="arithmatex">\(t\)</span> we compute the prefix
                function for the string
                <span class="arithmatex">\(s + \# + t\)</span>. Obviously, since
                <span class="arithmatex">\(\#\)</span> is a separator, the value
                of the prefix function will never exceed
                <span class="arithmatex">\(|s|\)</span>. It follows, that it is
                sufficient to only store the string
                <span class="arithmatex">\(s + \#\)</span> and the values of the
                prefix function for it, and we can compute the prefix function
                for all subsequent character on the fly:
              </p>
              <div class="arithmatex">
                \[\underbrace{s_0 ~ s_1 ~ \dots ~ s_{n-1} ~ \#}_{\text{need to
                store}} ~ \underbrace{t_0 ~ t_1 ~ \dots ~ t_{m-1}}_{\text{do not
                need to store}}\]
              </div>
              <p>
                Indeed, in such a situation, knowing the next character
                <span class="arithmatex">\(c \in t\)</span> and the value of the
                prefix function of the previous position is enough information
                to compute the next value of the prefix function, without using
                any previous characters of the string
                <span class="arithmatex">\(t\)</span> and the value of the
                prefix function in them.
              </p>
              <p>
                In other words, we can construct an
                <strong>automaton</strong> (a finite state machine): the state
                in it is the current value of the prefix function, and the
                transition from one state to another will be performed via the
                next character.
              </p>
              <p>
                Thus, even without having the string
                <span class="arithmatex">\(t\)</span>, we can construct such a
                transition table
                <span class="arithmatex"
                  >\((\text{old}_\pi, c) \rightarrow \text{new}_\pi\)</span
                >
                using the same algorithm as for calculating the transition
                table:
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">compute_automaton</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">aut</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">s</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefix_function</span><span class="p">(</span><span class="n">s</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">aut</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">26</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">26</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"></span>
<span class="w">                </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi</span><span class="p">[</span><span class="n">j</span><span class="mi">-1</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"></span>
<span class="w">                </span><span class="n">j</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">aut</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                However in this form the algorithm runs in
                <span class="arithmatex">\(O(n^2 26)\)</span> time for the
                lowercase letters of the alphabet. Note that we can apply
                dynamic programming and use the already calculated parts of the
                table. Whenever we go from the value
                <span class="arithmatex">\(j\)</span> to the value
                <span class="arithmatex">\(\pi[j-1]\)</span>, we actually mean
                that the transition
                <span class="arithmatex">\((j, c)\)</span> leads to the same
                state as the transition as
                <span class="arithmatex">\((\pi[j-1], c)\)</span>, and this
                answer is already accurately computed.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">compute_automaton</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">aut</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">s</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prefix_function</span><span class="p">(</span><span class="n">s</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">aut</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">26</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">26</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"></span>
<span class="w">                </span><span class="n">aut</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aut</span><span class="p">[</span><span class="n">pi</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]][</span><span class="n">c</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"></span>
<span class="w">                </span><span class="n">aut</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                As a result we construct the automaton in
                <span class="arithmatex">\(O(26 n)\)</span> time.
              </p>
              <p>
                When is such a automaton useful? To begin with, remember that we
                use the prefix function for the string
                <span class="arithmatex">\(s + \# + t\)</span> and its values
                mostly for a single purpose: find all occurrences of the string
                <span class="arithmatex">\(s\)</span> in the string
                <span class="arithmatex">\(t\)</span>.
              </p>
              <p>
                Therefore the most obvious benefit of this automaton is the
                <strong>acceleration of calculating the prefix function</strong>
                for the string <span class="arithmatex">\(s + \# + t\)</span>.
                By building the automaton for
                <span class="arithmatex">\(s + \#\)</span>, we no longer need to
                store the string <span class="arithmatex">\(s\)</span> or the
                values of the prefix function in it. All transitions are already
                computed in the table.
              </p>
              <p>
                But there is a second, less obvious, application. We can use the
                automaton when the string
                <span class="arithmatex">\(t\)</span> is a
                <strong>gigantic string constructed using some rules</strong>.
                This can for instance be the Gray strings, or a string formed by
                a recursive combination of several short strings from the input.
              </p>
              <p>
                For completeness we will solve such a problem: given a number
                <span class="arithmatex">\(k \le 10^5\)</span> and a string
                <span class="arithmatex">\(s\)</span> of length
                <span class="arithmatex">\(\le 10^5\)</span>. We have to compute
                the number of occurrences of
                <span class="arithmatex">\(s\)</span> in the
                <span class="arithmatex">\(k\)</span>-th Gray string. Recall
                that Gray's strings are define in the following way:
              </p>
              <div class="arithmatex">
                \[\begin{align} g_1 &amp;= \text{"a"}\\ g_2 &amp;=
                \text{"aba"}\\ g_3 &amp;= \text{"abacaba"}\\ g_4 &amp;=
                \text{"abacabadabacaba"} \end{align}\]
              </div>
              <p>
                In such cases even constructing the string
                <span class="arithmatex">\(t\)</span> will be impossible,
                because of its astronomical length. The
                <span class="arithmatex">\(k\)</span>-th Gray string is
                <span class="arithmatex">\(2^k-1\)</span> characters long.
                However we can calculate the value of the prefix function at the
                end of the string effectively, by only knowing the value of the
                prefix function at the start.
              </p>
              <p>
                In addition to the automaton itself, we also compute values
                <span class="arithmatex">\(G[i][j]\)</span> - the value of the
                automaton after processing the string
                <span class="arithmatex">\(g_i\)</span> starting with the state
                <span class="arithmatex">\(j\)</span>. And additionally we
                compute values <span class="arithmatex">\(K[i][j]\)</span> - the
                number of occurrences of
                <span class="arithmatex">\(s\)</span> in
                <span class="arithmatex">\(g_i\)</span>, before during the
                processing of <span class="arithmatex">\(g_i\)</span> starting
                with the state <span class="arithmatex">\(j\)</span>. Actually
                <span class="arithmatex">\(K[i][j]\)</span> is the number of
                times that the prefix function took the value
                <span class="arithmatex">\(|s|\)</span> while performing the
                operations. The answer to the problem will then be
                <span class="arithmatex">\(K[k][0]\)</span>.
              </p>
              <p>
                How can we compute these values? First the basic values are
                <span class="arithmatex">\(G[0][j] = j\)</span> and
                <span class="arithmatex">\(K[0][j] = 0\)</span>. And all
                subsequent values can be calculated from the previous values and
                using the automaton. To calculate the value for some
                <span class="arithmatex">\(i\)</span> we remember that the
                string <span class="arithmatex">\(g_i\)</span> consists of
                <span class="arithmatex">\(g_{i-1}\)</span>, the
                <span class="arithmatex">\(i\)</span> character of the alphabet,
                and <span class="arithmatex">\(g_{i-1}\)</span>. Thus the
                automaton will go into the state:
              </p>
              <div class="arithmatex">
                \[\text{mid} = \text{aut}[G[i-1][j]][i]\]
              </div>
              <div class="arithmatex">\[G[i][j] = G[i-1][\text{mid}]\]</div>
              <p>
                The values for <span class="arithmatex">\(K[i][j]\)</span> can
                also be easily counted.
              </p>
              <div class="arithmatex">
                \[K[i][j] = K[i-1][j] + (\text{mid} == |s|) +
                K[i-1][\text{mid}]\]
              </div>
              <p>
                So we can solve the problem for Gray strings, and similarly also
                a huge number of other similar problems. For example the exact
                same method also solves the following problem: we are given a
                string <span class="arithmatex">\(s\)</span> and some patterns
                <span class="arithmatex">\(t_i\)</span>, each of which is
                specified as follows: it is a string of ordinary characters, and
                there might be some recursive insertions of the previous strings
                of the form
                <span class="arithmatex">\(t_k^{\text{cnt}}\)</span>, which
                means that at this place we have to insert the string
                <span class="arithmatex">\(t_k\)</span>
                <span class="arithmatex">\(\text{cnt}\)</span> times. An example
                of such patterns:
              </p>
              <div class="arithmatex">
                \[\begin{align} t_1 &amp;= \text{"abdeca"}\\ t_2 &amp;=
                \text{"abc"} + t_1^{30} + \text{"abd"}\\ t_3 &amp;= t_2^{50} +
                t_1^{100}\\ t_4 &amp;= t_2^{10} + t_3^{100} \end{align}\]
              </div>
              <p>
                The recursive substitutions blow the string up, so that their
                lengths can reach the order of
                <span class="arithmatex">\(100^{100}\)</span>.
              </p>
              <p>
                We have to find the number of times the string
                <span class="arithmatex">\(s\)</span> appears in each of the
                strings.
              </p>
              <p>
                The problem can be solved in the same way by constructing the
                automaton of the prefix function, and then we calculate the
                transitions in for each pattern by using the previous results.
              </p>
              <h2 id="practice-problems">Practice Problems</h2>
              <ul>
                <li>
                  <a
                    href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=396"
                    >UVA # 455 "Periodic Strings"</a
                  >
                </li>
                <li>
                  <a
                    href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1963"
                    >UVA # 11022 "String Factoring"</a
                  >
                </li>
                <li>
                  <a
                    href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=2447"
                    >UVA # 11452 "Dancing the Cheeky-Cheeky"</a
                  >
                </li>
                <li>
                  <a
                    href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=4282"
                    >UVA 12604 - Caesar Cipher</a
                  >
                </li>
                <li>
                  <a
                    href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=3911"
                    >UVA 12467 - Secret Word</a
                  >
                </li>
                <li>
                  <a
                    href="https://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1960"
                    >UVA 11019 - Matrix Matcher</a
                  >
                </li>
                <li>
                  <a href="http://www.spoj.com/problems/NAJPF/"
                    >SPOJ - Pattern Find</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/808/problem/G"
                    >Codeforces - Anthem of Berland</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/problemset/problem/471/D"
                    >Codeforces - MUH and Cube Walls</a
                  >
                </li>
                <li>
                  <a href="https://codeforces.com/contest/432/problem/D"
                    >Codeforces - Prefixes and Suffixes</a
                  >
                </li>
              </ul>
            </article>
          </div>
        </div>
      </main>
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">
      {
        "base": "..",
        "features": [],
        "translations": {
          "clipboard.copy": "Copy to clipboard",
          "clipboard.copied": "Copied to clipboard",
          "search.config.lang": "en",
          "search.config.pipeline": "trimmer, stopWordFilter",
          "search.config.separator": "[\\s\\-]+",
          "search.placeholder": "Search",
          "search.result.placeholder": "Type to start searching",
          "search.result.none": "No matching documents",
          "search.result.one": "1 matching document",
          "search.result.other": "# matching documents",
          "search.result.more.one": "1 more on this page",
          "search.result.more.other": "# more on this page",
          "search.result.term.missing": "Missing",
          "select.version.title": "Select version"
        },
        "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"
      }
    </script>

    <script src="../assets/javascripts/bundle.467223ff.min.js"></script>

    <script src="../javascript/config.js"></script>

    <script src="../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>

  <!-- Mirrored from  firststeptocp.com/string/prefix-function.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:40 GMT -->
</html>
