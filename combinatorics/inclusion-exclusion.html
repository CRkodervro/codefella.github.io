
<!doctype html>
<html lang="en" class="no-js">
  
<!-- Mirrored from  firststeptocp.com/combinatorics/inclusion-exclusion.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:42:03 GMT -->
 <meta http-equiv="content-type" content="text/html;charset=utf-8" /> 
<head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>The Inclusion-Exclusion Principle - Algorithms for Competitive Programming</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-85220282-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="../../www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-inclusion-exclusion-principle" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
- remove the menu button for mobile
-->


<header class="md-header" data-md-component="header">
  <script>
    function scrollToTop() {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    }
  </script>
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index-2.html" title="Algorithms for Competitive Programming" class="md-header__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <a href="../index-2.html" title="Algorithms for Competitive Programming" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
              Algorithms for Competitive Programming
            </a>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <a href="#" onclick="scrollToTop()">
              
                The Inclusion-Exclusion Principle
              
            </a>
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="cpalgo" data-md-color-primary="deep-purple" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
   
</div>
    
    
            
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index-2.html" title="Algorithms for Competitive Programming" class="md-nav__button md-logo" aria-label="Algorithms for Competitive Programming" data-md-component="logo">
      
  <img src="../favicon.ico" alt="logo">

    </a>
    Algorithms for Competitive Programming
  </label>
  
     
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index-2.html" class="md-nav__link">
        Main Page
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contrib.html" class="md-nav__link">
        How to Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../preview.html" class="md-nav__link">
        Preview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Algebra
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Algebra" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Algebra
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/all-submasks.html" class="md-nav__link">
        Submask Enumeration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/balanced-ternary.html" class="md-nav__link">
        Balanced Ternary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/big-integer.html" class="md-nav__link">
        Arbitrary-Precision Arithmetic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/binary-exp.html" class="md-nav__link">
        Binary Exponentiation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/chinese-remainder-theorem.html" class="md-nav__link">
        Chinese Remainder Theorem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/discrete-log.html" class="md-nav__link">
        Discrete Logarithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/discrete-root.html" class="md-nav__link">
        Discrete Root
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/divisors.html" class="md-nav__link">
        Number of divisors / sum of divisors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/euclid-algorithm.html" class="md-nav__link">
        Euclidean algorithm for computing the greatest common divisor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/extended-euclid-algorithm.html" class="md-nav__link">
        Extended Euclidean Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorial-divisors.html" class="md-nav__link">
        Finding Power of Factorial Divisor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorial-modulo.html" class="md-nav__link">
        Factorial modulo p
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/factorization.html" class="md-nav__link">
        Integer factorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/fft.html" class="md-nav__link">
        Fast Fourier transform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/fibonacci-numbers.html" class="md-nav__link">
        Fibonacci Numbers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/gray-code.html" class="md-nav__link">
        Gray code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/linear-diophantine-equation.html" class="md-nav__link">
        Linear Diophantine Equation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/linear_congruence_equation.html" class="md-nav__link">
        Linear Congruence Equation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/module-inverse.html" class="md-nav__link">
        Modular Multiplicative Inverse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/montgomery_multiplication.html" class="md-nav__link">
        Montgomery Multiplication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/phi-function.html" class="md-nav__link">
        Euler's totient function
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/polynomial.html" class="md-nav__link">
        Operations on polynomials and series
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/primality_tests.html" class="md-nav__link">
        Primality tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/prime-sieve-linear.html" class="md-nav__link">
        Linear Sieve
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/primitive-root.html" class="md-nav__link">
        Primitive Root
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../algebra/sieve-of-eratosthenes.html" class="md-nav__link">
        Sieve of Eratosthenes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Combinatorics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Combinatorics" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Combinatorics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="binomial-coefficients.html" class="md-nav__link">
        Binomial Coefficients
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="bishops-on-chessboard.html" class="md-nav__link">
        Placing Bishops on a Chessboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="bracket_sequences.html" class="md-nav__link">
        Balanced bracket sequences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="burnside.html" class="md-nav__link">
        Burnside's lemma / Pólya enumeration theorem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="catalan-numbers.html" class="md-nav__link">
        Catalan Numbers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="counting_labeled_graphs.html" class="md-nav__link">
        Counting labeled graphs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="generating_combinations.html" class="md-nav__link">
        Generating all K-combinations
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          The Inclusion-Exclusion Principle
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="inclusion-exclusion.html" class="md-nav__link md-nav__link--active">
        The Inclusion-Exclusion Principle
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#statement" class="md-nav__link">
    Statement
  </a>
  
    <nav class="md-nav" aria-label="Statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-verbal-formula" class="md-nav__link">
    The verbal formula
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-formulation-in-terms-of-sets" class="md-nav__link">
    The formulation in terms of sets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-formulation-using-venn-diagrams" class="md-nav__link">
    The formulation using Venn diagrams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-formulation-in-terms-of-probability-theory" class="md-nav__link">
    The formulation in terms of probability theory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof" class="md-nav__link">
    Proof
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generalization-for-calculating-number-of-elements-in-exactly-r-sets" class="md-nav__link">
    Generalization for calculating number of elements in exactly r sets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-when-solving-problems" class="md-nav__link">
    Usage when solving problems
  </a>
  
    <nav class="md-nav" aria-label="Usage when solving problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-simple-task-on-permutations" class="md-nav__link">
    A simple task on permutations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-task-on-0-1-2-sequences" class="md-nav__link">
    A simple task on (0, 1, 2) sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-integer-solutions-to-the-equation" class="md-nav__link">
    The number of integer solutions to the equation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-relative-primes-in-a-given-interval" class="md-nav__link">
    The number of relative primes in a given interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-integers-in-a-given-interval-which-are-multiple-of-at-least-one-of-the-given-numbers" class="md-nav__link">
    The number of integers in a given interval which are multiple of at least one of the given numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-strings-that-satisfy-a-given-pattern" class="md-nav__link">
    The number of strings that satisfy a given pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-ways-of-going-from-a-cell-to-another" class="md-nav__link">
    The number of ways of going from a cell to another
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-coprime-quadruples" class="md-nav__link">
    The number of coprime quadruples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-harmonic-triplets" class="md-nav__link">
    The number of harmonic triplets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-permutations-without-fixed-points-derangements" class="md-nav__link">
    The number of permutations without fixed points (derangements)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-problems" class="md-nav__link">
    Practice Problems
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="stars_and_bars.html" class="md-nav__link">
        Stars and bars
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Data structures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data structures" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Data structures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/deleting_in_log_n.html" class="md-nav__link">
        Deleting from a data structure in O(T(n)log n)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/disjoint_set_union.html" class="md-nav__link">
        Disjoint Set Union
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/fenwick.html" class="md-nav__link">
        Fenwick Tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/randomized_heap.html" class="md-nav__link">
        Randomized Heap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/segment_tree.html" class="md-nav__link">
        Segment Tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sparse-table.html" class="md-nav__link">
        Sparse Table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt-tree.html" class="md-nav__link">
        Sqrt Tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/sqrt_decomposition.html" class="md-nav__link">
        Sqrt Decomposition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/stack_queue_modification.html" class="md-nav__link">
        Minimum stack / Minimum queue
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_structures/treap.html" class="md-nav__link">
        Treap (Cartesian tree)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Dynamic programming
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Dynamic programming" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Dynamic programming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/divide-and-conquer-dp.html" class="md-nav__link">
        Divide and Conquer DP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/profile-dynamics.html" class="md-nav__link">
        Dynamic Programming on Broken Profile. Problem "Parquet"
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dynamic_programming/zero_matrix.html" class="md-nav__link">
        Finding the largest zero submatrix
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Game theory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Game theory" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Game theory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/games_on_graphs.html" class="md-nav__link">
        Games on arbitrary graphs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../game_theory/sprague-grundy-nim.html" class="md-nav__link">
        Sprague-Grundy theorem. Nim
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Geometry
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Geometry" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Geometry
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/area-of-simple-polygon.html" class="md-nav__link">
        Finding area of simple polygon in O(N)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/basic-geometry.html" class="md-nav__link">
        Basic Geometry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/check-segments-intersection.html" class="md-nav__link">
        Check if two segments intersect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-circle-intersection.html" class="md-nav__link">
        Circle-Circle Intersection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/circle-line-intersection.html" class="md-nav__link">
        Circle-Line Intersection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex-hull.html" class="md-nav__link">
        Convex Hull construction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/convex_hull_trick.html" class="md-nav__link">
        Convex hull trick and Li Chao tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/delaunay.html" class="md-nav__link">
        Delaunay triangulation and Voronoi diagram
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/halfplane-intersection.html" class="md-nav__link">
        Half-plane intersection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/intersecting_segments.html" class="md-nav__link">
        Search for a pair of intersecting segments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lattice-points.html" class="md-nav__link">
        Lattice points inside non-lattice polygon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/length-of-segments-union.html" class="md-nav__link">
        Length of the union of segments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/lines-intersection.html" class="md-nav__link">
        Intersection Point of Lines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/minkowski.html" class="md-nav__link">
        Minkowski sum of convex polygons
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/nearest_points.html" class="md-nav__link">
        Finding the nearest pair of points
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/oriented-triangle-area.html" class="md-nav__link">
        Oriented area of a triangle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/picks-theorem.html" class="md-nav__link">
        Pick's Theorem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-in-convex-polygon.html" class="md-nav__link">
        Check if point belongs to the convex polygon in $O(\log N)$
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/point-location.html" class="md-nav__link">
        Point location in O(log n)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segment-to-line.html" class="md-nav__link">
        Finding the equation of a line for a segment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/segments-intersection.html" class="md-nav__link">
        Finding intersection of two segments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/tangents-to-two-circles.html" class="md-nav__link">
        Finding common tangents to two circles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geometry/vertical_decomposition.html" class="md-nav__link">
        Vertical decomposition
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Graph
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Graph" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Graph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/01_bfs.html" class="md-nav__link">
        0-1 BFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/2SAT.html" class="md-nav__link">
        2-SAT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/Assignment-problem-min-flow.html" class="md-nav__link">
        Solving assignment problem using min-cost-flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/all-pair-shortest-path-floyd-warshall.html" class="md-nav__link">
        Floyd-Warshall Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bellman_ford.html" class="md-nav__link">
        Bellman-Ford Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bipartite-check.html" class="md-nav__link">
        Check whether a graph is bipartite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/breadth-first-search.html" class="md-nav__link">
        Breadth-first search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching-online.html" class="md-nav__link">
        Finding Bridges Online
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/bridge-searching.html" class="md-nav__link">
        Finding bridges in a graph in O(N+M)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/cutpoints.html" class="md-nav__link">
        Finding articulation points in a graph in O(N+M)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/depth-first-search.html" class="md-nav__link">
        Depth First Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/desopo_pape.html" class="md-nav__link">
        D´Esopo-Pape algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra.html" class="md-nav__link">
        Dijkstra Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dijkstra_sparse.html" class="md-nav__link">
        Dijkstra on sparse graphs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/dinic.html" class="md-nav__link">
        Maximum flow - Dinic's algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edge_vertex_connectivity.html" class="md-nav__link">
        Edge connectivity / Vertex connectivity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/edmonds_karp.html" class="md-nav__link">
        Maximum flow - Ford-Fulkerson and Edmonds-Karp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/euler_path.html" class="md-nav__link">
        Finding the Eulerian path in O(M)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-cycle.html" class="md-nav__link">
        Checking a graph for acyclicity and finding a cycle in O(M)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/finding-negative-cycle-in-graph.html" class="md-nav__link">
        Finding a negative cycle in the graph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/fixed_length_paths.html" class="md-nav__link">
        Number of paths of fixed length / Shortest paths of fixed length
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/flow_with_demands.html" class="md-nav__link">
        Flows with demands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/hld.html" class="md-nav__link">
        Heavy-light decomposition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kirchhoff-theorem.html" class="md-nav__link">
        Kirchhoff's theorem. Finding the number of spanning trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/kuhn_maximum_bipartite_matching.html" class="md-nav__link">
        Kuhn's Algorithm for Maximum Bipartite Matching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca.html" class="md-nav__link">
        Lowest Common Ancestor - O(sqrt(N)) and O(log N) with O(N) preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_binary_lifting.html" class="md-nav__link">
        Lowest Common Ancestor - Binary Lifting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_farachcoltonbender.html" class="md-nav__link">
        Lowest Common Ancestor - Farach-Colton and Bender Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/lca_tarjan.html" class="md-nav__link">
        Lowest Common Ancestor - Tarjan's off-line algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/min_cost_flow.html" class="md-nav__link">
        Minimum-cost flow - Successive shortest path algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mpm.html" class="md-nav__link">
        Maximum flow - MPM algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal.html" class="md-nav__link">
        Minimum spanning tree - Kruskal's algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_kruskal_with_dsu.html" class="md-nav__link">
        Minimum spanning tree - Kruskal with Disjoint Set Union
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/mst_prim.html" class="md-nav__link">
        Minimum spanning tree - Prim's algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/pruefer_code.html" class="md-nav__link">
        Prüfer code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel-faster.html" class="md-nav__link">
        Maximum flow - Push-relabel method improved
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/push-relabel.html" class="md-nav__link">
        Maximum flow - Push-relabel algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/rmq_linear.html" class="md-nav__link">
        Solve RMQ (Range Minimum Query) by finding LCA (Lowest Common Ancestor)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/search-for-connected-components.html" class="md-nav__link">
        Search for connected components in a graph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/second_best_mst.html" class="md-nav__link">
        Second Best Minimum Spanning Tree
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strong-orientation.html" class="md-nav__link">
        Strong Orientation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/strongly-connected-components.html" class="md-nav__link">
        Finding strongly connected components / Building condensation graph
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/topological-sort.html" class="md-nav__link">
        Topological Sorting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graph/tree_painting.html" class="md-nav__link">
        Paint the edges of the tree
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Linear algebra
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linear algebra" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Linear algebra
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-gauss.html" class="md-nav__link">
        Calculating the determinant of a matrix by Gauss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/determinant-kraut.html" class="md-nav__link">
        Calculating the determinant using Kraut method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/linear-system-gauss.html" class="md-nav__link">
        Gauss method for solving system of linear equations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linear_algebra/rank-matrix.html" class="md-nav__link">
        Finding the rank of a matrix
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Num methods
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Num methods" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Num methods
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/roots_newton.html" class="md-nav__link">
        Newton's method for finding roots
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/simpson-integration.html" class="md-nav__link">
        Integration by Simpson's formula
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../num_methods/ternary_search.html" class="md-nav__link">
        Ternary Search
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          Others
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Others" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Others
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../others/15-puzzle.html" class="md-nav__link">
        15 Puzzle Game: Existence Of The Solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../others/josephus_problem.html" class="md-nav__link">
        Josephus Problem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../others/maximum_average_segment.html" class="md-nav__link">
        Search the subarray with the maximum/minimum sum
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../others/stern_brocot_tree_farey_sequences.html" class="md-nav__link">
        The Stern-Brocot tree and Farey sequences
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          Schedules
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Schedules" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Schedules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule-with-completion-duration.html" class="md-nav__link">
        Optimal schedule of jobs given their deadlines and durations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_one_machine.html" class="md-nav__link">
        Scheduling jobs on one machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schedules/schedule_two_machines.html" class="md-nav__link">
        Scheduling jobs on two machines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_15">
          Sequences
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sequences" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Sequences
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/k-th.html" class="md-nav__link">
        K-th order statistic in O(N)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/longest_increasing_subsequence.html" class="md-nav__link">
        Longest increasing subsequence
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sequences/rmq.html" class="md-nav__link">
        Range Minimum Query
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_16" type="checkbox" id="__nav_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_16">
          String
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="String" data-md-level="1">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          String
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/aho_corasick.html" class="md-nav__link">
        Aho-Corasick algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/expression_parsing.html" class="md-nav__link">
        Expression parsing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/lyndon_factorization.html" class="md-nav__link">
        Lyndon factorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/main_lorentz.html" class="md-nav__link">
        Finding repetitions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/manacher.html" class="md-nav__link">
        Manacher's Algorithm - Finding all sub-palindromes in O(N)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/prefix-function.html" class="md-nav__link">
        Prefix function. Knuth–Morris–Pratt algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/rabin-karp.html" class="md-nav__link">
        Rabin-Karp Algorithm for string matching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/string-hashing.html" class="md-nav__link">
        String Hashing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-array.html" class="md-nav__link">
        Suffix Array
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-automaton.html" class="md-nav__link">
        Suffix Automaton
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/suffix-tree-ukkonen.html" class="md-nav__link">
        Suffix Tree. Ukkonen's Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../string/z-function.html" class="md-nav__link">
        Z-function and its calculation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#statement" class="md-nav__link">
    Statement
  </a>
  
    <nav class="md-nav" aria-label="Statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-verbal-formula" class="md-nav__link">
    The verbal formula
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-formulation-in-terms-of-sets" class="md-nav__link">
    The formulation in terms of sets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-formulation-using-venn-diagrams" class="md-nav__link">
    The formulation using Venn diagrams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-formulation-in-terms-of-probability-theory" class="md-nav__link">
    The formulation in terms of probability theory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proof" class="md-nav__link">
    Proof
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generalization-for-calculating-number-of-elements-in-exactly-r-sets" class="md-nav__link">
    Generalization for calculating number of elements in exactly r sets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-when-solving-problems" class="md-nav__link">
    Usage when solving problems
  </a>
  
    <nav class="md-nav" aria-label="Usage when solving problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-simple-task-on-permutations" class="md-nav__link">
    A simple task on permutations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-task-on-0-1-2-sequences" class="md-nav__link">
    A simple task on (0, 1, 2) sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-integer-solutions-to-the-equation" class="md-nav__link">
    The number of integer solutions to the equation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-relative-primes-in-a-given-interval" class="md-nav__link">
    The number of relative primes in a given interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-integers-in-a-given-interval-which-are-multiple-of-at-least-one-of-the-given-numbers" class="md-nav__link">
    The number of integers in a given interval which are multiple of at least one of the given numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-strings-that-satisfy-a-given-pattern" class="md-nav__link">
    The number of strings that satisfy a given pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-ways-of-going-from-a-cell-to-another" class="md-nav__link">
    The number of ways of going from a cell to another
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-coprime-quadruples" class="md-nav__link">
    The number of coprime quadruples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-harmonic-triplets" class="md-nav__link">
    The number of harmonic triplets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-number-of-permutations-without-fixed-points-derangements" class="md-nav__link">
    The number of permutations without fixed points (derangements)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-problems" class="md-nav__link">
    Practice Problems
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                <script type="text/javascript">
window.onload = function() {
	const newIssueURL = "https://github.com/e-maxx-eng/e-maxx-eng/issues/new";
  const issueTitle = `Problem on article "The Inclusion-Exclusion Principle"`;
	const issueBody = `
 **Article:** [The Inclusion-Exclusion Principle](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
  var issue_a = document.getElementById("report_issue_a");
  issue_a.href = `${newIssueURL}?` + `title=${encodeURIComponent(issueTitle)}&` + `body=${encodeURIComponent(issueBody)}`;
}
</script>

<h1 id="the-inclusion-exclusion-principle">The Inclusion-Exclusion Principle</h1>
<p>The inclusion-exclusion principle is an important combinatorial way to compute the size of a set or the probability of complex events. It relates the sizes of individual sets with their union.</p>
<h2 id="statement">Statement</h2>
<h3 id="the-verbal-formula">The verbal formula</h3>
<p>The inclusion-exclusion principle can be expressed as follows:</p>
<p>To compute the size of a union of multiple sets, it is necessary to sum the sizes of these sets <strong>separately</strong>, and then subtract the sizes of all <strong>pairwise</strong> intersections of the sets, then add back the size of the intersections of <strong>triples</strong> of the sets, subtract the size of <strong>quadruples</strong> of the sets, and so on, up to the intersection of <strong>all</strong> sets.</p>
<h3 id="the-formulation-in-terms-of-sets">The formulation in terms of sets</h3>
<p>The above definition can be expressed mathematically as follows:</p>
<div class="arithmatex">\[\left| \bigcup_{i=1}^n A_i \right| = \sum_{i=1}^n|A_i| - \sum_{1\leq i&lt;j\leq n} |A_i \cap A_j| + \sum _{1\leq i&lt;j&lt;k\leq n}|A_i \cap A_j \cap A_k| - \cdots + (-1)^{n-1} | A_1 \cap \cdots \cap A_n |\]</div>
<p>And in a more compact way:</p>
<div class="arithmatex">\[\left|\bigcup_{i=1}^n A_i \right| = \sum_{\emptyset \neq J\subseteq \{1,2,\ldots ,n\}} (-1)^{|J|-1}{\Biggl |}\bigcap_{j\in J}A_{j}{\Biggr |}\]</div>
<h3 id="the-formulation-using-venn-diagrams">The formulation using Venn diagrams</h3>
<p>Let the diagram show three sets <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span> and <span class="arithmatex">\(C\)</span>:</p>
<p><img alt="Venn diagram" src="venn-inclusion-exclusion.png" title="Venn diagram" /></p>
<p>Then the area of their union <span class="arithmatex">\(A \cup B \cup C\)</span> is equal to the sum of the areas <span class="arithmatex">\(A\)</span>, <span class="arithmatex">\(B\)</span> and <span class="arithmatex">\(C\)</span> less double-covered areas <span class="arithmatex">\(A \cap B\)</span>, <span class="arithmatex">\(A \cap C\)</span>, <span class="arithmatex">\(B \cap C\)</span>, but with the addition of the area covered by three sets <span class="arithmatex">\(A \cap B \cap C\)</span>:</p>
<div class="arithmatex">\[S(A \cup B \cup C) = S(A) + S(B) + S(C) - S(A \cap B) - S(A \cap C) - S(B \cap C) + S(A \cap B \cap C)\]</div>
<p>It can also be generalized for an association of <span class="arithmatex">\(n\)</span> sets.</p>
<h3 id="the-formulation-in-terms-of-probability-theory">The formulation in terms of probability theory</h3>
<p>If <span class="arithmatex">\(A_i\)</span> <span class="arithmatex">\((i = 1,2...n)\)</span> are events and <span class="arithmatex">\({\cal P}(A_i)\)</span> the probability of an event from <span class="arithmatex">\(A_i\)</span> to occur, then the probability of their union (i.e. the probability that at least one of the events occur) is equal to:</p>
<div class="arithmatex">\[\begin{eqnarray}
{\cal P} \left( \bigcup_{i=1}^n A_i \right) &amp;=&amp; \sum_{i=1}^n{\cal P}(A_i)\ - \sum_{1\leq i&lt;j\leq n} {\cal P}(A_i \cap A_j)\  + \\
&amp;+&amp; \sum _{1\leq i&lt;j&lt;k\leq n}{\cal P}(A_i \cap A_j \cap A_k) - \cdots + (-1)^{n-1} {\cal P}( A_1 \cap \cdots \cap A_n )
\end{eqnarray}\]</div>
<p>And in a more compact way:</p>
<div class="arithmatex">\[{\cal P} \left(\bigcup_{i=1}^n A_i \right) = \sum_{\emptyset \neq J\subseteq \{1,2,\ldots ,n\}} (-1)^{|J|-1}\ {\cal P}{\Biggl (}\bigcap_{j\in J}A_{j}{\Biggr )}\]</div>
<h2 id="proof">Proof</h2>
<p>For the proof it is convenient to use the mathematical formulation in terms of set theory:</p>
<div class="arithmatex">\[\left|\bigcup_{i=1}^n A_i \right| = \sum_{\emptyset \neq J\subseteq \{1,2,\ldots ,n\}} (-1)^{|J|-1}{\Biggl |}\bigcap_{j\in J}A_{j}{\Biggr |}\]</div>
<p>We want to prove that any element contained in at least one of the sets <span class="arithmatex">\(A_i\)</span> will occur in the formula only once (note that elements which are not present in any of the sets <span class="arithmatex">\(A_i\)</span> will never be considered on the right part of the formula).</p>
<p>Consider an element <span class="arithmatex">\(x\)</span> occurring in <span class="arithmatex">\(k \geq 1\)</span> sets <span class="arithmatex">\(A_i\)</span>. We will show it is counted only once in the formula. Note that:</p>
<ul>
<li>in terms which <span class="arithmatex">\(|J| = 1\)</span>, the item <span class="arithmatex">\(x\)</span> will be counted <strong><span class="arithmatex">\(+\ k\)</span></strong> times;</li>
<li>in terms which <span class="arithmatex">\(|J| = 2\)</span>, the item <span class="arithmatex">\(x\)</span> will be counted <strong><span class="arithmatex">\(-\ \binom{k}{2}\)</span></strong> times - because it will be counted in those terms that include two of the <span class="arithmatex">\(k\)</span> sets containing <span class="arithmatex">\(x\)</span>;</li>
<li>in terms which <span class="arithmatex">\(|J| = 3\)</span>, the item <span class="arithmatex">\(x\)</span> will be counted <strong><span class="arithmatex">\(+\ \binom{k}{3}\)</span></strong> times;</li>
<li><span class="arithmatex">\(\cdots\)</span></li>
<li>in terms which <span class="arithmatex">\(|J| = k\)</span>, the item <span class="arithmatex">\(x\)</span> will be counted <strong><span class="arithmatex">\((-1)^{k-1}\cdot \binom{k}{k}\)</span></strong> times;</li>
<li>in terms which <span class="arithmatex">\(|J| \gt k\)</span>, the item <span class="arithmatex">\(x\)</span> will be counted <strong>zero</strong> times;</li>
</ul>
<p>This leads us to the following sum of <a href="binomial-coefficients.html">binomial coefficients</a>:</p>
<div class="arithmatex">\[ T = \binom{k}{1} - \binom{k}{2} + \binom{k}{3} - \cdots + (-1)^{i-1}\cdot \binom{k}{i} + \cdots + (-1)^{k-1}\cdot \binom{k}{k}\]</div>
<p>This expression is very similar to the binomial expansion of <span class="arithmatex">\((1 - x)^k\)</span>:</p>
<div class="arithmatex">\[ (1 - x)^k = \binom{k}{0} - \binom{k}{1} \cdot x + \binom{k}{2} \cdot x^2 - \binom{k}{3} \cdot x^3 + \cdots + (-1)^k\cdot \binom{k}{k} \cdot x^k \]</div>
<p>When <span class="arithmatex">\(x = 1\)</span>, <span class="arithmatex">\((1 - x)^k\)</span> looks a lot like <span class="arithmatex">\(T\)</span>. However, the expression has an additional <span class="arithmatex">\(\binom{k}{0} = 1\)</span>, and it is multiplied by <span class="arithmatex">\(-1\)</span>. That leads us to <span class="arithmatex">\((1 - 1)^k = 1 - T\)</span>. Therefore <span class="arithmatex">\(T = 1 - (1 - 1)^k = 1\)</span>, what was required to prove. The element is counted only once.</p>
<h2 id="generalization-for-calculating-number-of-elements-in-exactly-r-sets">Generalization for calculating number of elements in exactly <span class="arithmatex">\(r\)</span> sets</h2>
<p>Inclusion-exclusion principle can be rewritten to calculate number of elements which are present in zero sets:</p>
<div class="arithmatex">\[\left|\bigcap_{i=1}^n \overline{A_i}\right|=\sum_{m=0}^n (-1)^m \sum_{|X|=m} \left|\bigcap_{i\in X} A_{i}\right|\]</div>
<p>Consider its generalization to calculate number of elements which are present in exactly <span class="arithmatex">\(r\)</span> sets:</p>
<div class="arithmatex">\[\left|\bigcup_{|B|=r}\left[\bigcap_{i \in B} A_i \cap \bigcap_{j \not\in B} \overline{A_j}\right]\right|=\sum_{m=r}^n (-1)^{m-r}\dbinom{m}{r} \sum_{|X|=m} \left|\bigcap_{i \in X} A_{i}\right|\]</div>
<p>To prove this formula, consider some particular <span class="arithmatex">\(B\)</span>. Due to basic inclusion-exclusion principle we can say about it that:</p>
<div class="arithmatex">\[\left|\bigcap_{i \in B} A_i \cap \bigcap_{j \not \in B} \overline{A_j}\right|=\sum_{m=r}^{n} (-1)^{m-r} \sum_{\substack{|X|=m \newline B \subset X}}\left|\bigcap_{i\in X} A_{i}\right|\]</div>
<p>The sets on the left side do not intersect for different <span class="arithmatex">\(B\)</span>, thus we can sum them up directly. Also one should note that any set <span class="arithmatex">\(X\)</span> will always have coefficient <span class="arithmatex">\((-1)^{m-r}\)</span> if it occurs and it will occur for exactly <span class="arithmatex">\(\dbinom{m}{r}\)</span> sets <span class="arithmatex">\(B\)</span>. </p>
<h2 id="usage-when-solving-problems">Usage when solving problems</h2>
<p>The inclusion-exclusion principle is hard to understand without studying its applications.</p>
<p>First, we will look at three simplest tasks "at paper", illustrating applications of the principle, and then consider more practical problems which are difficult to solve without inclusion-exclusion principle.</p>
<p>Tasks asking to "find the <strong>number</strong> of ways" are worth of note, as they sometimes lead to polynomial solutions, not necessarily exponential.</p>
<h3 id="a-simple-task-on-permutations">A simple task on permutations</h3>
<p>Task: count how many permutations of numbers from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(9\)</span> exist such that the first element is greater than <span class="arithmatex">\(1\)</span> and the last one is less than <span class="arithmatex">\(8\)</span>.</p>
<p>Let's count the number of "bad" permutations, that is, permutations in which the first element is <span class="arithmatex">\(\leq 1\)</span> and/or the last is <span class="arithmatex">\(\geq 8\)</span>.</p>
<p>We will denote by <span class="arithmatex">\(X\)</span> the set of permutations in which the first element is <span class="arithmatex">\(\leq 1\)</span> and <span class="arithmatex">\(Y\)</span> the set of permutations in which the last element is <span class="arithmatex">\(\geq 8\)</span>. Then the number of "bad" permutations, as on the inclusion-exclusion formula, will be:</p>
<div class="arithmatex">\[ |X \cup Y| = |X| + |Y| - |X \cap Y| \]</div>
<p>After a simple combinatorial calculation, we will get to:</p>
<div class="arithmatex">\[ 2 \cdot 9! + 2 \cdot 9! - 2 \cdot 2 \cdot 8! \]</div>
<p>The only thing left is to subtract this number from the total of <span class="arithmatex">\(10!\)</span> to get the number of "good" permutations.</p>
<h3 id="a-simple-task-on-0-1-2-sequences">A simple task on (0, 1, 2) sequences</h3>
<p>Task: count how many sequences of length <span class="arithmatex">\(n\)</span> exist consisting only of numbers <span class="arithmatex">\(0,1,2\)</span> such that each number occurs <strong>at least once</strong>.</p>
<p>Again let us turn to the inverse problem, i.e. we calculate the number of sequences which do <strong>not</strong> contain <strong>at least one</strong> of the numbers.</p>
<p>Let's denote by <span class="arithmatex">\(A_i (i = 0,1,2)\)</span> the set of sequences in which the digit <span class="arithmatex">\(i\)</span> does <strong>not</strong> occur.
The formula of inclusion-exclusion on the number of "bad" sequences will be:</p>
<div class="arithmatex">\[ |A_0 \cup A_1 \cup A_2| = |A_0| + |A_1| + |A_2| - |A_0 \cap A_1| - |A_0 \cap A_2| - |A_1 \cap A_2| + |A_0 \cap A_1 \cap A_2| \]</div>
<ul>
<li>The size of each <span class="arithmatex">\(A_i\)</span> is <span class="arithmatex">\(2^n\)</span>, as each sequence can only contain two of the digits.</li>
<li>The size of each pairwise intersection <span class="arithmatex">\(A_i \cap A_j\)</span>  is equal to <span class="arithmatex">\(1\)</span>, as there will be only one digit to build the sequence.</li>
<li>The size of the intersection of all three sets is equal to <span class="arithmatex">\(0\)</span>, as there will be no digits to build the sequence.</li>
</ul>
<p>As we solved the inverse problem, we subtract it from the total of <span class="arithmatex">\(3^n\)</span> sequences:</p>
<div class="arithmatex">\[3^n - (3 \cdot 2^n - 3 \cdot 1 + 0)\]</div>
<h3 id="the-number-of-integer-solutions-to-the-equation">The number of integer solutions to the equation</h3>
<p>Consider the following equation:</p>
<div class="arithmatex">\[x_1 + x_2 + x_3 + x_4 + x_5 + x_6 = 20\]</div>
<p>where <span class="arithmatex">\(0 \le x_i \le 8 (i = 1,2,\ldots 6)\)</span>.</p>
<p>Task: count the number of solutions to the equation.</p>
<p>Forget the restriction on <span class="arithmatex">\(x_i\)</span> for a moment and just count the number of nonnegative solutions to this equation. This is easily done using <a href="binomial-coefficients.html">binomial coefficients</a>: we want to break a sequence of <span class="arithmatex">\(20\)</span> units into <span class="arithmatex">\(6\)</span> groups, which is the same as distributing <span class="arithmatex">\(5\)</span> "walls" over <span class="arithmatex">\(25\)</span> slots:</p>
<div class="arithmatex">\[N_0 = \binom{25}{5}\]</div>
<p>We will now calculate the number of "bad" solutions with the inclusion-exclusion principle. The "bad" solutions will be those in which one or more <span class="arithmatex">\(x_i\)</span> are greater than <span class="arithmatex">\(9\)</span>.</p>
<p>Denote by <span class="arithmatex">\(A_k (k = 1,2\ldots 6)\)</span> the set of solutions where <span class="arithmatex">\(x_k \ge 9\)</span>, and all other <span class="arithmatex">\(x_i \ge 0 (i \ne k)\)</span> (they may be <span class="arithmatex">\(\ge 9\)</span> or not). To calculate the size of <span class="arithmatex">\(A_k\)</span>, note that we have essentially the same combinatorial problem that was solved in the two paragraphs above, but now <span class="arithmatex">\(9\)</span> of the units are excluded from the slots and definitely belong to the first group. Thus:</p>
<div class="arithmatex">\[ | A_k | = \binom{16}{5} \]</div>
<p>Similarly, the size of the intersection between sets <span class="arithmatex">\(A_k\)</span> and <span class="arithmatex">\(A_p\)</span> is equal to:</p>
<div class="arithmatex">\[ \left| A_k \cap A_p \right| = \binom{7}{5}\]</div>
<p>The size of each intersection of three sets is zero, since <span class="arithmatex">\(20\)</span> units will not be enough for three or more variables greater than or equal to <span class="arithmatex">\(9\)</span>.</p>
<p>Combining all this into the formula of inclusions-exceptions and given that we solved the inverse problem, we finally get the answer:</p>
<div class="arithmatex">\[\binom{25}{5} - \left(\binom{6}{1} \cdot \binom{16}{5} - \binom{6}{2} \cdot \binom{7}{5}\right) \]</div>
<h3 id="the-number-of-relative-primes-in-a-given-interval">The number of relative primes in a given interval</h3>
<p>Task: given two numbers <span class="arithmatex">\(n\)</span> and <span class="arithmatex">\(r\)</span>, count the number of integers in the interval <span class="arithmatex">\([1;r]\)</span> that are relatively prime to n (their greatest common divisor is <span class="arithmatex">\(1\)</span>).</p>
<p>Let's solve the inverse problem - compute the number of not mutually primes with <span class="arithmatex">\(n\)</span>.</p>
<p>We will denote the prime factors of <span class="arithmatex">\(n\)</span> as <span class="arithmatex">\(p_i (i = 1\cdots k)\)</span>.</p>
<p>How many numbers in the interval <span class="arithmatex">\([1;r]\)</span> are divisible by <span class="arithmatex">\(p_i\)</span>? The answer to this question is:</p>
<div class="arithmatex">\[ \left\lfloor \frac{ r }{ p_i } \right\rfloor \]</div>
<p>However, if we simply sum these numbers, some numbers will be summarized several times (those that share multiple <span class="arithmatex">\(p_i\)</span> as their factors). Therefore, it is necessary to use the inclusion-exclusion principle.</p>
<p>We will iterate over all <span class="arithmatex">\(2^k\)</span> subsets of <span class="arithmatex">\(p_i\)</span>s, calculate their product and add or subtract the number of multiples of their product.</p>
<p>Here is a C++ implementation:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">solve</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">p</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">n</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">msk</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">msk</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="w"> </span><span class="o">++</span><span class="n">msk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">mult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="n">bits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">msk</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="o">++</span><span class="n">bits</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span><span class="n">mult</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">mult</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bits</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">sum</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">            </span><span class="n">sum</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">cur</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sum</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Asymptotics of the solution is <span class="arithmatex">\(O (\sqrt{n})\)</span>.</p>
<h3 id="the-number-of-integers-in-a-given-interval-which-are-multiple-of-at-least-one-of-the-given-numbers">The number of integers in a given interval which are multiple of at least one of the given numbers</h3>
<p>Given <span class="arithmatex">\(n\)</span> numbers <span class="arithmatex">\(a_i\)</span> and number <span class="arithmatex">\(r\)</span>. You want to count the number of integers in the interval <span class="arithmatex">\([1; r]\)</span> that are multiple of at least one of the <span class="arithmatex">\(a_i\)</span>.</p>
<p>The solution algorithm is almost identical to the one for previous task — construct the formula of inclusion-exclusion on the numbers <span class="arithmatex">\(a_i\)</span>, i.e. each term in this formula is the number of numbers divisible by a given subset of numbers <span class="arithmatex">\(a_i\)</span> (in other words, divisible by their <a href="../algebra/euclid-algorithm.html">least common multiple</a>).</p>
<p>So we will now iterate over all <span class="arithmatex">\(2^n\)</span> subsets of integers <span class="arithmatex">\(a_i\)</span> with <span class="arithmatex">\(O(n \log r)\)</span> operations to find their least common multiple, adding or subtracting the number of multiples of it in the interval. Asymptotics is <span class="arithmatex">\(O (2^n\cdot n\cdot \log r)\)</span>.</p>
<h3 id="the-number-of-strings-that-satisfy-a-given-pattern">The number of strings that satisfy a given pattern</h3>
<p>Consider <span class="arithmatex">\(n\)</span> patterns of strings of the same length, consisting only of letters (<span class="arithmatex">\(a...z\)</span>) or question marks. You're also given a number <span class="arithmatex">\(k\)</span>. A string matches a pattern if it has the same length as the pattern, and at each position, either the corresponding characters are equal or the character in the pattern is a question mark. The task is to count the number of strings that match exactly <span class="arithmatex">\(k\)</span> of the patterns (first problem) and at least <span class="arithmatex">\(k\)</span> of the patterns (second problem).</p>
<p>Notice first that we can easily count the number of strings that satisfy at once all of the specified patterns. To do this, simply "cross" patterns: iterate though the positions ("slots") and look at a position over all patterns. If all patterns have a question mark in this position, the character can be any letter from <span class="arithmatex">\(a\)</span> to <span class="arithmatex">\(z\)</span>. Otherwise, the character of this position is uniquely defined by the patterns that do not contain a question mark.</p>
<p>Learn now to solve the first version of the problem: when the string must satisfy exactly <span class="arithmatex">\(k\)</span> of the patterns.</p>
<p>To solve it, iterate and fix a specific subset <span class="arithmatex">\(X\)</span> from the set of patterns consisting of <span class="arithmatex">\(k\)</span> patterns. Then we have to count the number of strings that satisfy this set of patterns, and only matches it, that is, they don't match any other pattern. We will use the inclusion-exclusion principle in a slightly different manner: we sum on all supersets <span class="arithmatex">\(Y\)</span> (subsets from the original set of strings that contain <span class="arithmatex">\(X\)</span>), and either add to the current answer or subtract it from the number of strings:</p>
<div class="arithmatex">\[ ans(X) = \sum_{Y \supseteq X} (-1)^{|Y|-k} \cdot f(Y) \]</div>
<p>Where <span class="arithmatex">\(f(Y)\)</span> is the number of strings that match <span class="arithmatex">\(Y\)</span> (at least <span class="arithmatex">\(Y\)</span>).</p>
<p>(If you have a hard time figuring out this, you can try drawing Venn Diagrams.)</p>
<p>If we sum up on all <span class="arithmatex">\(ans(X)\)</span>, we will get the final answer:</p>
<div class="arithmatex">\[ ans = \sum_{X ~ : ~ |X| = k} ans(X) \]</div>
<p>However, asymptotics of this solution is <span class="arithmatex">\(O(3^k \cdot k)\)</span>. To improve it, notice that different <span class="arithmatex">\(ans(X)\)</span> computations very often share <span class="arithmatex">\(Y\)</span> sets.</p>
<p>We will reverse the formula of inclusion-exclusion and sum in terms of <span class="arithmatex">\(Y\)</span> sets. Now it becomes clear that the same set <span class="arithmatex">\(Y\)</span> would be taken into account in the computation of <span class="arithmatex">\(ans(X)\)</span> of <span class="arithmatex">\(\binom{|Y|}{k}\)</span> sets with the same sign <span class="arithmatex">\((-1)^{|Y| - k}\)</span>.</p>
<div class="arithmatex">\[ ans = \sum_{Y ~ : ~ |Y| \ge k} (-1)^{|Y|-k} \cdot \binom{|Y|}{k} \cdot f(Y) \]</div>
<p>Now our solution has asymptotics <span class="arithmatex">\(O(2^k \cdot k)\)</span>.</p>
<p>We will now solve the second version of the problem: find the number of strings that match <strong>at least</strong> <span class="arithmatex">\(k\)</span> of the patterns.</p>
<p>Of course, we can just use the solution to the first version of the problem and add the answers for sets with size greater than <span class="arithmatex">\(k\)</span>. However, you may notice that in this problem, a set |Y| is considered in the formula for all sets with size <span class="arithmatex">\(\ge k\)</span> which are contained in <span class="arithmatex">\(Y\)</span>. That said, we can write the part of the expression that is being multiplied by <span class="arithmatex">\(f(Y)\)</span> as:</p>
<div class="arithmatex">\[ (-1)^{|Y|-k} \cdot \binom{|Y|}{k} + (-1)^{|Y|-k-1} \cdot \binom{|Y|}{k+1} + (-1)^{|Y|-k-2} \cdot \binom{|Y|}{k+2} + \cdots + (-1)^{|Y|-|Y|} \cdot \binom{|Y|}{|Y|} \]</div>
<p>Looking at Graham's (Graham, Knuth, Patashnik. "Concrete mathematics" [1998] ), we see a well-known formula for <a href="binomial-coefficients.html">binomial coefficients</a>:</p>
<div class="arithmatex">\[ \sum_{k=0}^m (-1)^k \cdot \binom{n}{k} = (-1)^m \cdot \binom{n-1}{m} \]</div>
<p>Applying it here, we find that the entire sum of binomial coefficients is minimized:</p>
<div class="arithmatex">\[ (-1)^{|Y|-k} \cdot \binom{|Y|-1}{|Y|-k} \]</div>
<p>Thus, for this task, we also obtained a solution with the asymptotics <span class="arithmatex">\(O(2^k \cdot k)\)</span>:</p>
<div class="arithmatex">\[ ans = \sum_{Y ~ : ~ |Y| \ge k} (-1)^{|Y|-k} \cdot \binom{|Y|-1}{|Y|-k} \cdot f(Y) \]</div>
<h3 id="the-number-of-ways-of-going-from-a-cell-to-another">The number of ways of going from a cell to another</h3>
<p>There is a field <span class="arithmatex">\(n \times m\)</span>, and <span class="arithmatex">\(k\)</span> of its cells are impassable walls. A robot is initially at the cell <span class="arithmatex">\((1,1)\)</span> (bottom left). The robot can only move right or up, and eventually it needs to get into the cell <span class="arithmatex">\((n,m)\)</span>, avoiding all obstacles. You need to count the number of ways he can do it.</p>
<p>Assume that the sizes <span class="arithmatex">\(n\)</span> and <span class="arithmatex">\(m\)</span> are very large (say, <span class="arithmatex">\(10^9\)</span>), and the number <span class="arithmatex">\(k\)</span> is small (around <span class="arithmatex">\(100\)</span>).</p>
<p>For now, sort the obstacles by their coordinate <span class="arithmatex">\(x\)</span>, and in case of equality — coordinate <span class="arithmatex">\(y\)</span>.</p>
<p>Also just learn how to solve a problem without obstacles: i.e. learn how to count the number of ways to get from one cell to another. In one axis, we need to go through <span class="arithmatex">\(x\)</span> cells, and on the other, <span class="arithmatex">\(y\)</span> cells. From simple combinatorics, we get a formula using <a href="binomial-coefficients.html">binomial coefficients</a>:</p>
<div class="arithmatex">\[\binom{x+y}{x}\]</div>
<p>Now to count the number of ways to get from one cell to another, avoiding all obstacles, you can use inclusion-exclusion to solve the inverse problem: count the number of ways to walk through the board stepping at a subset of obstacles (and subtract it from the total number of ways).</p>
<p>When iterating over a subset of the obstacles that we'll step, to count the number of ways to do this simply multiply the number of all paths from starting cell to the first of the selected obstacles, a first obstacle to the second, and so on, and then add or subtract this number from the answer, in accordance with the standard formula of inclusion-exclusion.</p>
<p>However, this will again be non-polynomial in complexity <span class="arithmatex">\(O(2^k \cdot k)\)</span>.</p>
<p>Here goes a polynomial solution:</p>
<p>We will use dynamic programming. For convenience, push (1,1) to the beginning and (n,m) at the end of the obstacles array. Let's compute the numbers <span class="arithmatex">\(d[i]\)</span> — the number of ways to get from the starting point (<span class="arithmatex">\(0-th\)</span>) to <span class="arithmatex">\(i-th\)</span>, without stepping on any other obstacle (except for <span class="arithmatex">\(i\)</span>, of course). We will compute this number for all the obstacle cells, and also for the ending one.</p>
<p>Let's forget for a second the obstacles and just count the number of paths from cell <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(i\)</span>. We need to consider some "bad" paths, the ones that pass through the obstacles, and subtract them from the total number of ways of going from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(i\)</span>.</p>
<p>When considering an obstacle <span class="arithmatex">\(t\)</span> between <span class="arithmatex">\(0\)</span> and <span class="arithmatex">\(i\)</span> (<span class="arithmatex">\(0 &lt; t &lt; i\)</span>), on which we can step, we see that the number of paths from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(i\)</span> that pass through <span class="arithmatex">\(t\)</span> which have <span class="arithmatex">\(t\)</span> as the <strong>first obstacle between start and <span class="arithmatex">\(i\)</span></strong>. We can compute that as: <span class="arithmatex">\(d[t]\)</span> multiplied by the number of arbitrary paths from <span class="arithmatex">\(t\)</span> to <span class="arithmatex">\(i\)</span>. We can count the number of "bad" ways summing this for all <span class="arithmatex">\(t\)</span> between <span class="arithmatex">\(0\)</span> and <span class="arithmatex">\(i\)</span>.</p>
<p>We can compute <span class="arithmatex">\(d[i]\)</span> in <span class="arithmatex">\(O(k)\)</span> for <span class="arithmatex">\(O(k)\)</span> obstacles, so this solution has complexity <span class="arithmatex">\(O(k^2)\)</span>.</p>
<h3 id="the-number-of-coprime-quadruples">The number of coprime quadruples</h3>
<p>You're given <span class="arithmatex">\(n\)</span> numbers: <span class="arithmatex">\(a_1, a_2, \ldots, a_n\)</span>. You are required to count the number of ways to choose four numbers so that their combined greatest common divisor is equal to one.</p>
<p>We will solve the inverse problem — compute the number of "bad" quadruples, i.e. quadruples in which all numbers are divisible by a number <span class="arithmatex">\(d &gt; 1\)</span>.</p>
<p>We will use the inclusion-exclusion principle while summing over all possible groups of four numbers divisible by a divisor <span class="arithmatex">\(d\)</span>.</p>
<div class="arithmatex">\[ans = \sum_{d \ge 2} (-1)^{deg(d)-1} \cdot f(d)\]</div>
<p>where <span class="arithmatex">\(deg(d)\)</span> is the number of primes in the factorization of the number <span class="arithmatex">\(d\)</span> and <span class="arithmatex">\(f(d)\)</span> the number of quadruples divisible by <span class="arithmatex">\(d\)</span>.</p>
<p>To calculate the function <span class="arithmatex">\(f(d)\)</span>, you just have to count the number of multiples of <span class="arithmatex">\(d\)</span> (as mentioned on a previous task) and use <a href="binomial-coefficients.html">binomial coefficients</a> to count the number of ways to choose four of them.</p>
<p>Thus, using the formula of inclusions-exclusions we sum the number of groups of four divisible by a prime number, then subtract the number of quadruples which are divisible by the product of two primes, add quadruples divisible by three primes, etc.</p>
<h3 id="the-number-of-harmonic-triplets">The number of harmonic triplets</h3>
<p>You are given a number <span class="arithmatex">\(n \le 10^6\)</span>. You are required to count the number of triples <span class="arithmatex">\(2 \le a &lt; b &lt; c \le n\)</span> that satisfy one of the following conditions:</p>
<ul>
<li>or <span class="arithmatex">\({\rm gcd}(a,b) = {\rm gcd}(a,c) = {\rm gcd}(b,c) = 1\)</span>,</li>
<li>or <span class="arithmatex">\({\rm gcd}(a,b) &gt; 1, {\rm gcd}(a,c) &gt; 1, {\rm gcd}(b,c) &gt; 1\)</span>.</li>
</ul>
<p>First, go straight to the inverse problem — i.e. count the number of non-harmonic triples.</p>
<p>Second, note that any non-harmonic triplet is made of a pair of coprimes and a third number that is not coprime with at least one from the pair.</p>
<p>Thus, the number of non-harmonic triples that contain <span class="arithmatex">\(i\)</span> is equal the number of integers from <span class="arithmatex">\(2\)</span> to <span class="arithmatex">\(n\)</span> that are coprimes with <span class="arithmatex">\(i\)</span> multiplied by the number of integers that are not coprime with <span class="arithmatex">\(i\)</span>.</p>
<p>Either <span class="arithmatex">\(gcd(a,b) = 1 \wedge gcd(a,c) &gt; 1 \wedge gcd(b,c) &gt; 1\)</span></p>
<p>or <span class="arithmatex">\(gcd(a,b) = 1 \wedge gcd(a,c) = 1 \wedge gcd(b,c) &gt; 1\)</span></p>
<p>In both of these cases, it will be counted twice. The first case will be counted when <span class="arithmatex">\(i = a\)</span> and when <span class="arithmatex">\(i = b\)</span>. The second case will be counted when <span class="arithmatex">\(i = b\)</span> and when <span class="arithmatex">\(i = c\)</span>. Therefore, to compute the number of non-harmonic triples, we sum this calculation through all <span class="arithmatex">\(i\)</span> from <span class="arithmatex">\(2\)</span> to <span class="arithmatex">\(n\)</span> and divide it by <span class="arithmatex">\(2\)</span>.</p>
<p>Now all we have left to solve is to learn to count the number of coprimes to <span class="arithmatex">\(i\)</span> in the interval <span class="arithmatex">\([2;n]\)</span>. Although this problem has already been mentioned, the above solution is not suitable here — it would require the factorization of each of the integers from <span class="arithmatex">\(2\)</span> to <span class="arithmatex">\(n\)</span>, and then iterating through all subsets of these primes.</p>
<p>A faster solution is possible with such modification of the sieve of Eratosthenes:</p>
<ol>
<li>
<p>First, we find all numbers in the interval <span class="arithmatex">\([2;n]\)</span> such that its simple factorization does not include a prime factor twice. We will also need to know, for these numbers, how many factors it includes.</p>
<ul>
<li>To do this we will maintain an array <span class="arithmatex">\(deg[i]\)</span> to store the number of primes in the factorization of <span class="arithmatex">\(i\)</span>, and an array <span class="arithmatex">\(good[i]\)</span>, to mark either if <span class="arithmatex">\(i\)</span> contains each factor at most once (<span class="arithmatex">\(good[i] = 1\)</span>) or not (<span class="arithmatex">\(good[i] = 0\)</span>). When iterating from <span class="arithmatex">\(2\)</span> to <span class="arithmatex">\(n\)</span>, if we reach a number that has <span class="arithmatex">\(deg\)</span> equal to <span class="arithmatex">\(0\)</span>, then it is a prime and its <span class="arithmatex">\(deg\)</span> is <span class="arithmatex">\(1\)</span>.</li>
<li>During the sieve of Eratosthenes, we will iterate <span class="arithmatex">\(i\)</span> from <span class="arithmatex">\(2\)</span> to <span class="arithmatex">\(n\)</span>. When processing a prime number we go through all of its multiples and increase their <span class="arithmatex">\(deg[]\)</span>. If one of these multiples is multiple of the square of <span class="arithmatex">\(i\)</span>, then we can put <span class="arithmatex">\(good\)</span> as false.</li>
</ul>
</li>
<li>
<p>Second, we need to calculate the answer for all <span class="arithmatex">\(i\)</span> from <span class="arithmatex">\(2\)</span> to <span class="arithmatex">\(n\)</span>, i.e., the array <span class="arithmatex">\(cnt[]\)</span> — the number of integers not coprime with <span class="arithmatex">\(i\)</span>.</p>
<ul>
<li>To do this, remember how the formula of inclusion-exclusion works — actually here we implement the same concept, but with inverted logic: we iterate over a component (a product of primes from the factorization) and add or subtract its term on the formula of inclusion-exclusion of each of its multiples.</li>
<li>So, let's say we are processing a number <span class="arithmatex">\(i\)</span> such that <span class="arithmatex">\(good[i] = true\)</span>, i.e., it is involved in the formula of inclusion-exclusion. Iterate through all numbers that are multiples of <span class="arithmatex">\(i\)</span>, and either add or subtract <span class="arithmatex">\(\lfloor N/i \rfloor\)</span> from their <span class="arithmatex">\(cnt[]\)</span> (the signal depends on <span class="arithmatex">\(deg[i]\)</span>: if <span class="arithmatex">\(deg[i]\)</span> is odd, then we must add, otherwise subtract).</li>
</ul>
</li>
</ol>
<p>Here's a C++ implementation:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"></span>
<span class="kt">bool</span><span class="w"> </span><span class="n">good</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">deg</span><span class="p">[</span><span class="n">MAXN</span><span class="p">],</span><span class="w"> </span><span class="n">cnt</span><span class="p">[</span><span class="n">MAXN</span><span class="p">];</span><span class="w"></span>

<span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">solve</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="w"> </span><span class="p">(</span><span class="n">good</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">good</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="w"> </span><span class="p">(</span><span class="n">deg</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">deg</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">memset</span><span class="w"> </span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">cnt</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ans_bad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">good</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="n">good</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="k">else</span><span class="w"></span>
<span class="w">                        </span><span class="o">++</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">ans_bad</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1l</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1l</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-3</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ans_bad</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>The asymptotics of our solution is <span class="arithmatex">\(O(n \log n)\)</span>, as for almost every number up to <span class="arithmatex">\(n\)</span> we make <span class="arithmatex">\(n/i\)</span> iterations on the nested loop.</p>
<h3 id="the-number-of-permutations-without-fixed-points-derangements">The number of permutations without fixed points (derangements)</h3>
<p>Prove that the number of permutations of length <span class="arithmatex">\(n\)</span> without fixed points (i.e. no number <span class="arithmatex">\(i\)</span> is in position <span class="arithmatex">\(i\)</span> - also called a derangement) is equal to the following number:</p>
<div class="arithmatex">\[n! - \binom{n}{1} \cdot (n-1)! + \binom{n}{2} \cdot (n-2)! - \binom{n}{3} \cdot (n-3)! + \cdots \pm \binom{n}{n} \cdot (n-n)! \]</div>
<p>and approximately equal to:</p>
<div class="arithmatex">\[ \frac{ n! }{ e } \]</div>
<p>(if you round this expression to the nearest whole number — you get exactly the number of permutations without fixed points)</p>
<p>Denote by <span class="arithmatex">\(A_k\)</span> the set of permutations of length <span class="arithmatex">\(n\)</span> with a fixed point at position <span class="arithmatex">\(k\)</span> (<span class="arithmatex">\(1 \le k \le n\)</span>) (i.e. element <span class="arithmatex">\(k\)</span> is at position <span class="arithmatex">\(k\)</span>).</p>
<p>We now use the formula of inclusion-exclusion to count the number of permutations with at least one fixed point. For this we need to learn to count sizes of an intersection of sets <span class="arithmatex">\(A_i\)</span>, as follows:</p>
<div class="arithmatex">\[\begin{eqnarray}
\left| A_p \right| &amp;=&amp; (n-1)!\ , \\
\left| A_p \cap A_q \right| &amp;=&amp; (n-2)!\ , \\
\left| A_p \cap A_q \cap A_r \right| &amp;=&amp; (n-3)!\ , \\
\cdots ,
\end{eqnarray}\]</div>
<p>because if we know that the number of fixed points is equal <span class="arithmatex">\(x\)</span>, then we know the position of <span class="arithmatex">\(x\)</span> elements of the permutation, and all other <span class="arithmatex">\((n-x)\)</span> elements can be placed anywhere.</p>
<p>Substituting this into the formula of inclusion-exclusion, and given that the number of ways to choose a subset of size <span class="arithmatex">\(x\)</span> from the set of <span class="arithmatex">\(n\)</span> elements is equal to <span class="arithmatex">\(\binom{n}{x}\)</span>, we obtain a formula for the number of permutations with at least one fixed point:</p>
<div class="arithmatex">\[\binom{n}{1} \cdot (n-1)! - \binom{n}{2} \cdot (n-2)! + \binom{n}{3} \cdot (n-3)! - \cdots \pm \binom{n}{n} \cdot (n-n)! \]</div>
<p>Then the number of permutations without fixed points is equal to:</p>
<div class="arithmatex">\[n! - \binom{n}{1} \cdot (n-1)! + \binom{n}{2} \cdot (n-2)! - \binom{n}{3} \cdot (n-3)! + \cdots \pm \binom{n}{n} \cdot (n-n)! \]</div>
<p>Simplifying this expression, we obtain <strong>exact and approximate expressions for the number of permutations without fixed points</strong>:</p>
<div class="arithmatex">\[ n! \left( 1 - \frac{1}{1!} + \frac{1}{2!} - \frac{1}{3!} + \cdots \pm \frac{1}{n!} \right ) \approx \frac{n!}{e} \]</div>
<p>(because the sum in brackets are the first <span class="arithmatex">\(n+1\)</span> terms of the expansion in Taylor series <span class="arithmatex">\(e^{-1}\)</span>)</p>
<p>It is worth noting that a similar problem can be solved this way: when you need the fixed points were not among the <span class="arithmatex">\(m\)</span> first elements of permutations (and not among all, as we just solved). The formula obtained is as the given above accurate formula, but it will go up to the sum of <span class="arithmatex">\(k\)</span>, instead of <span class="arithmatex">\(n\)</span>.</p>
<h2 id="practice-problems">Practice Problems</h2>
<p>A list of tasks that can be solved using the principle of inclusions-exclusions:</p>
<ul>
<li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1266">UVA #10325 "The Lottery" [difficulty: low]</a></li>
<li><a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2906">UVA #11806 "Cheerleaders" [difficulty: low]</a></li>
<li><a href="http://www.topcoder.com/stat?c=problem_statement&amp;pm=10875">TopCoder SRM 477 "CarelessSecretary" [difficulty: low]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=6658&amp;rd=10068">TopCoder TCHS 16 "Divisibility" [difficulty: low]</a></li>
<li><a href="http://www.spoj.com/problems/NGM2/">SPOJ #6285 NGM2 , "Another Game With Numbers" [difficulty: low]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=8470">TopCoder SRM 382 "CharmingTicketsEasy" [difficulty: medium]</a></li>
<li><a href="http://www.topcoder.com/stat?c=problem_statement&amp;pm=8307">TopCoder SRM 390 "SetOfPatterns" [difficulty: medium]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=2013">TopCoder SRM 176 "Deranged" [difficulty: medium]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=10702&amp;rd=14144&amp;rm=303184&amp;cr=22697599">TopCoder SRM 457 "TheHexagonsDivOne" [difficulty: medium]</a></li>
<li><a href="http://esci.ru/ttb/statement-62.htm">Test&gt;&gt;&gt;thebest "HarmonicTriples" (in Russian) [difficulty: medium]</a></li>
<li><a href="http://www.spoj.com/problems/MSKYCODE/">SPOJ #4191 MSKYCODE "Sky Code" [difficulty: medium]</a></li>
<li><a href="http://www.spoj.com/problems/SQFREE/">SPOJ #4168 SQFREE "Square-free integers" [difficulty: medium]</a></li>
<li><a href="http://www.codechef.com/JAN11/problems/COUNTREL/">CodeChef "Count Relations" [difficulty: medium]</a></li>
<li><a href="http://www.spoj.com/problems/KPRIMESB/">SPOJ - Almost Prime Numbers Again</a></li>
<li><a href="http://www.spoj.com/problems/IITKWPCH/">SPOJ - Find number of Pair of Friends</a></li>
<li><a href="http://www.spoj.com/problems/SUBSET/">SPOJ - Balanced Cow Subsets</a></li>
<li><a href="http://www.spoj.com/problems/EASYMATH/">SPOJ - EASY MATH [difficulty: medium]</a></li>
<li><a href="https://www.spoj.com/problems/MOMOS/">SPOJ - MOMOS - FEASTOFPIGS [difficulty: easy]</a></li>
<li><a href="https://atcoder.jp/contests/dp/tasks/dp_y/">Atcoder - Grid 2 [difficulty: easy]</a></li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
 

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
        <script src="../javascript/config.js"></script>
      
        <script src="../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>

<!-- Mirrored from  firststeptocp.com/combinatorics/inclusion-exclusion.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:42:04 GMT -->
</html>