<!DOCTYPE html>
<html lang="en" class="no-js">
  <!-- Mirrored from  firststeptocp.com/string/string-hashing.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:40 GMT -->
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="icon" href="../favicon.ico" />
    <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5" />

    <title>String Hashing - Algorithms for Competitive Programming</title>

    <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css" />

    <link
      rel="stylesheet"
      href="../assets/stylesheets/palette.e6a45f82.min.css"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"
    />
    <style>
      :root {
        --md-text-font: "Roboto";
        --md-code-font: "Roboto Mono";
      }
    </style>

    <link rel="stylesheet" href="../stylesheets/extra.css" />

    <script>
      (__md_scope = new URL("..", location)),
        (__md_get = (e, _ = localStorage, t = __md_scope) =>
          JSON.parse(_.getItem(t.pathname + "." + e))),
        (__md_set = (e, _, t = localStorage, a = __md_scope) => {
          try {
            t.setItem(a.pathname + "." + e, JSON.stringify(_));
          } catch (e) {}
        });
    </script>

    <script>
      (window.ga =
        window.ga ||
        function () {
          (ga.q = ga.q || []).push(arguments);
        }),
        (ga.l = +new Date()),
        ga("create", "UA-85220282-1", "auto"),
        ga("set", "anonymizeIp", !0),
        ga("send", "pageview"),
        document.addEventListener("DOMContentLoaded", function () {
          document.forms.search &&
            document.forms.search.query.addEventListener("blur", function () {
              var e;
              this.value &&
                ((e = document.location.pathname),
                ga("send", "pageview", e + "?q=" + this.value));
            }),
            "undefined" != typeof location$ &&
              location$.subscribe(function (e) {
                ga("send", "pageview", e.pathname);
              });
        });
    </script>
    <script async src="../../www.google-analytics.com/analytics.js"></script>
  </head>

  <body
    dir="ltr"
    data-md-color-scheme="cpalgo"
    data-md-color-primary="deep-purple"
    data-md-color-accent=""
  >
    <script>
      var palette = __md_get("__palette");
      if (palette && "object" == typeof palette.color)
        for (var key of Object.keys(palette.color))
          document.body.setAttribute(
            "data-md-color-" + key,
            palette.color[key]
          );
    </script>

    <input
      class="md-toggle"
      data-md-toggle="drawer"
      type="checkbox"
      id="__drawer"
      autocomplete="off"
    />
    <input
      class="md-toggle"
      data-md-toggle="search"
      type="checkbox"
      id="__search"
      autocomplete="off"
    />
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      <a href="#string-hashing" class="md-skip"> Skip to content </a>
    </div>
    <div data-md-component="announce"></div>

    <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
- remove the menu button for mobile
-->

    <header class="md-header" data-md-component="header">
      <script>
        function scrollToTop() {
          document.body.scrollTop = 0; // For Safari
          document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
      </script>
      <nav class="md-header__inner md-grid" aria-label="Header">
        <a
          href="../index-2.html"
          title="Algorithms for Competitive Programming"
          class="md-header__button md-logo"
          aria-label="Algorithms for Competitive Programming"
          data-md-component="logo"
        >
          <img src="../favicon.ico" alt="logo" />
        </a>
        <div class="md-header__title" data-md-component="header-title">
          <div class="md-header__ellipsis">
            <div class="md-header__topic">
              <span class="md-ellipsis">
                <a
                  href="../index-2.html"
                  title="Algorithms for Competitive Programming"
                  aria-label="Algorithms for Competitive Programming"
                  data-md-component="logo"
                >
                  Algorithms for Competitive Programming
                </a>
              </span>
            </div>
            <div class="md-header__topic" data-md-component="header-topic">
              <span class="md-ellipsis">
                <a href="#" onclick="scrollToTop()"> String Hashing </a>
              </span>
            </div>
          </div>
        </div>

        <form class="md-header__option" data-md-component="palette">
          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="cpalgo"
            data-md-color-primary="deep-purple"
            data-md-color-accent=""
            aria-label="Switch to dark mode"
            type="radio"
            name="__palette"
            id="__palette_1"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to dark mode"
            for="__palette_2"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
              />
            </svg>
          </label>

          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="slate"
            data-md-color-primary=""
            data-md-color-accent=""
            aria-label="Switch to light mode"
            type="radio"
            name="__palette"
            id="__palette_2"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to light mode"
            for="__palette_1"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"
              />
            </svg>
          </label>
        </form>

        <label class="md-header__button md-icon" for="__search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"
            />
          </svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
          <label class="md-search__overlay" for="__search"></label>
        </div>
      </nav>
    </header>

    <div class="md-container" data-md-component="container">
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          <div
            class="md-sidebar md-sidebar--primary"
            data-md-component="sidebar"
            data-md-type="navigation"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--primary"
                  aria-label="Navigation"
                  data-md-level="0"
                >
                  <label class="md-nav__title" for="__drawer">
                    <a
                      href="../index-2.html"
                      title="Algorithms for Competitive Programming"
                      class="md-nav__button md-logo"
                      aria-label="Algorithms for Competitive Programming"
                      data-md-component="logo"
                    >
                      <img src="../favicon.ico" alt="logo" />
                    </a>
                    Algorithms for Competitive Programming
                  </label>

                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="../index-2.html" class="md-nav__link">
                        Main Page
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../contrib.html" class="md-nav__link">
                        How to Contribute
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../preview.html" class="md-nav__link">
                        Preview
                      </a>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_4"
                        type="checkbox"
                        id="__nav_4"
                      />

                      <label class="md-nav__link" for="__nav_4">
                        Algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_4">
                          <span class="md-nav__icon md-icon"></span>
                          Algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../algebra/all-submasks.html"
                              class="md-nav__link"
                            >
                              Submask Enumeration
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/balanced-ternary.html"
                              class="md-nav__link"
                            >
                              Balanced Ternary
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/big-integer.html"
                              class="md-nav__link"
                            >
                              Arbitrary-Precision Arithmetic
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/binary-exp.html"
                              class="md-nav__link"
                            >
                              Binary Exponentiation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/chinese-remainder-theorem.html"
                              class="md-nav__link"
                            >
                              Chinese Remainder Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-log.html"
                              class="md-nav__link"
                            >
                              Discrete Logarithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-root.html"
                              class="md-nav__link"
                            >
                              Discrete Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/divisors.html"
                              class="md-nav__link"
                            >
                              Number of divisors / sum of divisors
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Euclidean algorithm for computing the greatest
                              common divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/extended-euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Extended Euclidean Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-divisors.html"
                              class="md-nav__link"
                            >
                              Finding Power of Factorial Divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-modulo.html"
                              class="md-nav__link"
                            >
                              Factorial modulo p
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorization.html"
                              class="md-nav__link"
                            >
                              Integer factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../algebra/fft.html" class="md-nav__link">
                              Fast Fourier transform
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/fibonacci-numbers.html"
                              class="md-nav__link"
                            >
                              Fibonacci Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/gray-code.html"
                              class="md-nav__link"
                            >
                              Gray code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear-diophantine-equation.html"
                              class="md-nav__link"
                            >
                              Linear Diophantine Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear_congruence_equation.html"
                              class="md-nav__link"
                            >
                              Linear Congruence Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/module-inverse.html"
                              class="md-nav__link"
                            >
                              Modular Multiplicative Inverse
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/montgomery_multiplication.html"
                              class="md-nav__link"
                            >
                              Montgomery Multiplication
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/phi-function.html"
                              class="md-nav__link"
                            >
                              Euler's totient function
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/polynomial.html"
                              class="md-nav__link"
                            >
                              Operations on polynomials and series
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primality_tests.html"
                              class="md-nav__link"
                            >
                              Primality tests
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/prime-sieve-linear.html"
                              class="md-nav__link"
                            >
                              Linear Sieve
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primitive-root.html"
                              class="md-nav__link"
                            >
                              Primitive Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/sieve-of-eratosthenes.html"
                              class="md-nav__link"
                            >
                              Sieve of Eratosthenes
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_5"
                        type="checkbox"
                        id="__nav_5"
                      />

                      <label class="md-nav__link" for="__nav_5">
                        Combinatorics
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Combinatorics"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_5">
                          <span class="md-nav__icon md-icon"></span>
                          Combinatorics
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/binomial-coefficients.html"
                              class="md-nav__link"
                            >
                              Binomial Coefficients
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bishops-on-chessboard.html"
                              class="md-nav__link"
                            >
                              Placing Bishops on a Chessboard
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bracket_sequences.html"
                              class="md-nav__link"
                            >
                              Balanced bracket sequences
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/burnside.html"
                              class="md-nav__link"
                            >
                              Burnside's lemma / Pólya enumeration theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/catalan-numbers.html"
                              class="md-nav__link"
                            >
                              Catalan Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/counting_labeled_graphs.html"
                              class="md-nav__link"
                            >
                              Counting labeled graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/generating_combinations.html"
                              class="md-nav__link"
                            >
                              Generating all K-combinations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/inclusion-exclusion.html"
                              class="md-nav__link"
                            >
                              The Inclusion-Exclusion Principle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/stars_and_bars.html"
                              class="md-nav__link"
                            >
                              Stars and bars
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_6"
                        type="checkbox"
                        id="__nav_6"
                      />

                      <label class="md-nav__link" for="__nav_6">
                        Data structures
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Data structures"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_6">
                          <span class="md-nav__icon md-icon"></span>
                          Data structures
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../data_structures/deleting_in_log_n.html"
                              class="md-nav__link"
                            >
                              Deleting from a data structure in O(T(n)log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/disjoint_set_union.html"
                              class="md-nav__link"
                            >
                              Disjoint Set Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/fenwick.html"
                              class="md-nav__link"
                            >
                              Fenwick Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/randomized_heap.html"
                              class="md-nav__link"
                            >
                              Randomized Heap
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/segment_tree.html"
                              class="md-nav__link"
                            >
                              Segment Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sparse-table.html"
                              class="md-nav__link"
                            >
                              Sparse Table
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt-tree.html"
                              class="md-nav__link"
                            >
                              Sqrt Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt_decomposition.html"
                              class="md-nav__link"
                            >
                              Sqrt Decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/stack_queue_modification.html"
                              class="md-nav__link"
                            >
                              Minimum stack / Minimum queue
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/treap.html"
                              class="md-nav__link"
                            >
                              Treap (Cartesian tree)
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_7"
                        type="checkbox"
                        id="__nav_7"
                      />

                      <label class="md-nav__link" for="__nav_7">
                        Dynamic programming
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Dynamic programming"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_7">
                          <span class="md-nav__icon md-icon"></span>
                          Dynamic programming
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/divide-and-conquer-dp.html"
                              class="md-nav__link"
                            >
                              Divide and Conquer DP
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/profile-dynamics.html"
                              class="md-nav__link"
                            >
                              Dynamic Programming on Broken Profile. Problem
                              "Parquet"
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/zero_matrix.html"
                              class="md-nav__link"
                            >
                              Finding the largest zero submatrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_8"
                        type="checkbox"
                        id="__nav_8"
                      />

                      <label class="md-nav__link" for="__nav_8">
                        Game theory
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Game theory"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_8">
                          <span class="md-nav__icon md-icon"></span>
                          Game theory
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../game_theory/games_on_graphs.html"
                              class="md-nav__link"
                            >
                              Games on arbitrary graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../game_theory/sprague-grundy-nim.html"
                              class="md-nav__link"
                            >
                              Sprague-Grundy theorem. Nim
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_9"
                        type="checkbox"
                        id="__nav_9"
                      />

                      <label class="md-nav__link" for="__nav_9">
                        Geometry
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Geometry"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_9">
                          <span class="md-nav__icon md-icon"></span>
                          Geometry
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../geometry/area-of-simple-polygon.html"
                              class="md-nav__link"
                            >
                              Finding area of simple polygon in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/basic-geometry.html"
                              class="md-nav__link"
                            >
                              Basic Geometry
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/check-segments-intersection.html"
                              class="md-nav__link"
                            >
                              Check if two segments intersect
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/circle-circle-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Circle Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/circle-line-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Line Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/convex-hull.html"
                              class="md-nav__link"
                            >
                              Convex Hull construction
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/convex_hull_trick.html"
                              class="md-nav__link"
                            >
                              Convex hull trick and Li Chao tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/delaunay.html"
                              class="md-nav__link"
                            >
                              Delaunay triangulation and Voronoi diagram
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/halfplane-intersection.html"
                              class="md-nav__link"
                            >
                              Half-plane intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/intersecting_segments.html"
                              class="md-nav__link"
                            >
                              Search for a pair of intersecting segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/lattice-points.html"
                              class="md-nav__link"
                            >
                              Lattice points inside non-lattice polygon
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/length-of-segments-union.html"
                              class="md-nav__link"
                            >
                              Length of the union of segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/lines-intersection.html"
                              class="md-nav__link"
                            >
                              Intersection Point of Lines
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/minkowski.html"
                              class="md-nav__link"
                            >
                              Minkowski sum of convex polygons
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/nearest_points.html"
                              class="md-nav__link"
                            >
                              Finding the nearest pair of points
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/oriented-triangle-area.html"
                              class="md-nav__link"
                            >
                              Oriented area of a triangle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/picks-theorem.html"
                              class="md-nav__link"
                            >
                              Pick's Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/point-in-convex-polygon.html"
                              class="md-nav__link"
                            >
                              Check if point belongs to the convex polygon in
                              $O(\log N)$
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/point-location.html"
                              class="md-nav__link"
                            >
                              Point location in O(log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/segment-to-line.html"
                              class="md-nav__link"
                            >
                              Finding the equation of a line for a segment
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/segments-intersection.html"
                              class="md-nav__link"
                            >
                              Finding intersection of two segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/tangents-to-two-circles.html"
                              class="md-nav__link"
                            >
                              Finding common tangents to two circles
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/vertical_decomposition.html"
                              class="md-nav__link"
                            >
                              Vertical decomposition
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_10"
                        type="checkbox"
                        id="__nav_10"
                      />

                      <label class="md-nav__link" for="__nav_10">
                        Graph
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Graph" data-md-level="1">
                        <label class="md-nav__title" for="__nav_10">
                          <span class="md-nav__icon md-icon"></span>
                          Graph
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="../graph/01_bfs.html" class="md-nav__link">
                              0-1 BFS
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/2SAT.html" class="md-nav__link">
                              2-SAT
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/Assignment-problem-min-flow.html"
                              class="md-nav__link"
                            >
                              Solving assignment problem using min-cost-flow
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/all-pair-shortest-path-floyd-warshall.html"
                              class="md-nav__link"
                            >
                              Floyd-Warshall Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bellman_ford.html"
                              class="md-nav__link"
                            >
                              Bellman-Ford Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bipartite-check.html"
                              class="md-nav__link"
                            >
                              Check whether a graph is bipartite
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/breadth-first-search.html"
                              class="md-nav__link"
                            >
                              Breadth-first search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching-online.html"
                              class="md-nav__link"
                            >
                              Finding Bridges Online
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching.html"
                              class="md-nav__link"
                            >
                              Finding bridges in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/cutpoints.html"
                              class="md-nav__link"
                            >
                              Finding articulation points in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/depth-first-search.html"
                              class="md-nav__link"
                            >
                              Depth First Search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/desopo_pape.html"
                              class="md-nav__link"
                            >
                              D´Esopo-Pape algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra.html"
                              class="md-nav__link"
                            >
                              Dijkstra Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra_sparse.html"
                              class="md-nav__link"
                            >
                              Dijkstra on sparse graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/dinic.html" class="md-nav__link">
                              Maximum flow - Dinic's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edge_vertex_connectivity.html"
                              class="md-nav__link"
                            >
                              Edge connectivity / Vertex connectivity
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edmonds_karp.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Ford-Fulkerson and Edmonds-Karp
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/euler_path.html"
                              class="md-nav__link"
                            >
                              Finding the Eulerian path in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-cycle.html"
                              class="md-nav__link"
                            >
                              Checking a graph for acyclicity and finding a
                              cycle in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-negative-cycle-in-graph.html"
                              class="md-nav__link"
                            >
                              Finding a negative cycle in the graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/fixed_length_paths.html"
                              class="md-nav__link"
                            >
                              Number of paths of fixed length / Shortest paths
                              of fixed length
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/flow_with_demands.html"
                              class="md-nav__link"
                            >
                              Flows with demands
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/hld.html" class="md-nav__link">
                              Heavy-light decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kirchhoff-theorem.html"
                              class="md-nav__link"
                            >
                              Kirchhoff's theorem. Finding the number of
                              spanning trees
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kuhn_maximum_bipartite_matching.html"
                              class="md-nav__link"
                            >
                              Kuhn's Algorithm for Maximum Bipartite Matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/lca.html" class="md-nav__link">
                              Lowest Common Ancestor - O(sqrt(N)) and O(log N)
                              with O(N) preprocessing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_binary_lifting.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Binary Lifting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_farachcoltonbender.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Farach-Colton and Bender
                              Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_tarjan.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Tarjan's off-line
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/min_cost_flow.html"
                              class="md-nav__link"
                            >
                              Minimum-cost flow - Successive shortest path
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/mpm.html" class="md-nav__link">
                              Maximum flow - MPM algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal_with_dsu.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal with Disjoint Set
                              Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_prim.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Prim's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/pruefer_code.html"
                              class="md-nav__link"
                            >
                              Prüfer code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel-faster.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel method improved
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/rmq_linear.html"
                              class="md-nav__link"
                            >
                              Solve RMQ (Range Minimum Query) by finding LCA
                              (Lowest Common Ancestor)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/search-for-connected-components.html"
                              class="md-nav__link"
                            >
                              Search for connected components in a graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/second_best_mst.html"
                              class="md-nav__link"
                            >
                              Second Best Minimum Spanning Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strong-orientation.html"
                              class="md-nav__link"
                            >
                              Strong Orientation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strongly-connected-components.html"
                              class="md-nav__link"
                            >
                              Finding strongly connected components / Building
                              condensation graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/topological-sort.html"
                              class="md-nav__link"
                            >
                              Topological Sorting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/tree_painting.html"
                              class="md-nav__link"
                            >
                              Paint the edges of the tree
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_11"
                        type="checkbox"
                        id="__nav_11"
                      />

                      <label class="md-nav__link" for="__nav_11">
                        Linear algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Linear algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_11">
                          <span class="md-nav__icon md-icon"></span>
                          Linear algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-gauss.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant of a matrix by Gauss
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-kraut.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant using Kraut method
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/linear-system-gauss.html"
                              class="md-nav__link"
                            >
                              Gauss method for solving system of linear
                              equations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/rank-matrix.html"
                              class="md-nav__link"
                            >
                              Finding the rank of a matrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_12"
                        type="checkbox"
                        id="__nav_12"
                      />

                      <label class="md-nav__link" for="__nav_12">
                        Num methods
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Num methods"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_12">
                          <span class="md-nav__icon md-icon"></span>
                          Num methods
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../num_methods/roots_newton.html"
                              class="md-nav__link"
                            >
                              Newton's method for finding roots
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/simpson-integration.html"
                              class="md-nav__link"
                            >
                              Integration by Simpson's formula
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/ternary_search.html"
                              class="md-nav__link"
                            >
                              Ternary Search
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_13"
                        type="checkbox"
                        id="__nav_13"
                      />

                      <label class="md-nav__link" for="__nav_13">
                        Others
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Others" data-md-level="1">
                        <label class="md-nav__title" for="__nav_13">
                          <span class="md-nav__icon md-icon"></span>
                          Others
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../others/15-puzzle.html"
                              class="md-nav__link"
                            >
                              15 Puzzle Game: Existence Of The Solution
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/josephus_problem.html"
                              class="md-nav__link"
                            >
                              Josephus Problem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/maximum_average_segment.html"
                              class="md-nav__link"
                            >
                              Search the subarray with the maximum/minimum sum
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/stern_brocot_tree_farey_sequences.html"
                              class="md-nav__link"
                            >
                              The Stern-Brocot tree and Farey sequences
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_14"
                        type="checkbox"
                        id="__nav_14"
                      />

                      <label class="md-nav__link" for="__nav_14">
                        Schedules
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Schedules"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_14">
                          <span class="md-nav__icon md-icon"></span>
                          Schedules
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule-with-completion-duration.html"
                              class="md-nav__link"
                            >
                              Optimal schedule of jobs given their deadlines and
                              durations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_one_machine.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on one machine
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_two_machines.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on two machines
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_15"
                        type="checkbox"
                        id="__nav_15"
                      />

                      <label class="md-nav__link" for="__nav_15">
                        Sequences
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Sequences"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_15">
                          <span class="md-nav__icon md-icon"></span>
                          Sequences
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../sequences/k-th.html"
                              class="md-nav__link"
                            >
                              K-th order statistic in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/longest_increasing_subsequence.html"
                              class="md-nav__link"
                            >
                              Longest increasing subsequence
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/rmq.html"
                              class="md-nav__link"
                            >
                              Range Minimum Query
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li
                      class="md-nav__item md-nav__item--active md-nav__item--nested"
                    >
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_16"
                        type="checkbox"
                        id="__nav_16"
                        checked
                      />

                      <label class="md-nav__link" for="__nav_16">
                        String
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="String" data-md-level="1">
                        <label class="md-nav__title" for="__nav_16">
                          <span class="md-nav__icon md-icon"></span>
                          String
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="aho_corasick.html" class="md-nav__link">
                              Aho-Corasick algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="expression_parsing.html"
                              class="md-nav__link"
                            >
                              Expression parsing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="lyndon_factorization.html"
                              class="md-nav__link"
                            >
                              Lyndon factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="main_lorentz.html" class="md-nav__link">
                              Finding repetitions
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="manacher.html" class="md-nav__link">
                              Manacher's Algorithm - Finding all sub-palindromes
                              in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="prefix-function.html" class="md-nav__link">
                              Prefix function. Knuth–Morris–Pratt algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="rabin-karp.html" class="md-nav__link">
                              Rabin-Karp Algorithm for string matching
                            </a>
                          </li>

                          <li class="md-nav__item md-nav__item--active">
                            <input
                              class="md-nav__toggle md-toggle"
                              data-md-toggle="toc"
                              type="checkbox"
                              id="__toc"
                            />

                            <label
                              class="md-nav__link md-nav__link--active"
                              for="__toc"
                            >
                              String Hashing
                              <span class="md-nav__icon md-icon"></span>
                            </label>

                            <a
                              href="string-hashing.html"
                              class="md-nav__link md-nav__link--active"
                            >
                              String Hashing
                            </a>

                            <nav
                              class="md-nav md-nav--secondary"
                              aria-label="Table of contents"
                            >
                              <label class="md-nav__title" for="__toc">
                                <span class="md-nav__icon md-icon"></span>
                                Table of contents
                              </label>
                              <ul
                                class="md-nav__list"
                                data-md-component="toc"
                                data-md-scrollfix
                              >
                                <li class="md-nav__item">
                                  <a
                                    href="#calculation-of-the-hash-of-a-string"
                                    class="md-nav__link"
                                  >
                                    Calculation of the hash of a string
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a href="#example-tasks" class="md-nav__link">
                                    Example tasks
                                  </a>

                                  <nav
                                    class="md-nav"
                                    aria-label="Example tasks"
                                  >
                                    <ul class="md-nav__list">
                                      <li class="md-nav__item">
                                        <a
                                          href="#search-for-duplicate-strings-in-an-array-of-strings"
                                          class="md-nav__link"
                                        >
                                          Search for duplicate strings in an
                                          array of strings
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#fast-hash-calculation-of-substrings-of-given-string"
                                          class="md-nav__link"
                                        >
                                          Fast hash calculation of substrings of
                                          given string
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#applications-of-hashing"
                                    class="md-nav__link"
                                  >
                                    Applications of Hashing
                                  </a>

                                  <nav
                                    class="md-nav"
                                    aria-label="Applications of Hashing"
                                  >
                                    <ul class="md-nav__list">
                                      <li class="md-nav__item">
                                        <a
                                          href="#determine-the-number-of-different-substrings-in-a-string"
                                          class="md-nav__link"
                                        >
                                          Determine the number of different
                                          substrings in a string
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#improve-no-collision-probability"
                                    class="md-nav__link"
                                  >
                                    Improve no-collision probability
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#practice-problems"
                                    class="md-nav__link"
                                  >
                                    Practice Problems
                                  </a>
                                </li>
                              </ul>
                            </nav>
                          </li>

                          <li class="md-nav__item">
                            <a href="suffix-array.html" class="md-nav__link">
                              Suffix Array
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="suffix-automaton.html"
                              class="md-nav__link"
                            >
                              Suffix Automaton
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="suffix-tree-ukkonen.html"
                              class="md-nav__link"
                            >
                              Suffix Tree. Ukkonen's Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="z-function.html" class="md-nav__link">
                              Z-function and its calculation
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div
            class="md-sidebar md-sidebar--secondary"
            data-md-component="sidebar"
            data-md-type="toc"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--secondary"
                  aria-label="Table of contents"
                >
                  <label class="md-nav__title" for="__toc">
                    <span class="md-nav__icon md-icon"></span>
                    Table of contents
                  </label>
                  <ul
                    class="md-nav__list"
                    data-md-component="toc"
                    data-md-scrollfix
                  >
                    <li class="md-nav__item">
                      <a
                        href="#calculation-of-the-hash-of-a-string"
                        class="md-nav__link"
                      >
                        Calculation of the hash of a string
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#example-tasks" class="md-nav__link">
                        Example tasks
                      </a>

                      <nav class="md-nav" aria-label="Example tasks">
                        <ul class="md-nav__list">
                          <li class="md-nav__item">
                            <a
                              href="#search-for-duplicate-strings-in-an-array-of-strings"
                              class="md-nav__link"
                            >
                              Search for duplicate strings in an array of
                              strings
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#fast-hash-calculation-of-substrings-of-given-string"
                              class="md-nav__link"
                            >
                              Fast hash calculation of substrings of given
                              string
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item">
                      <a href="#applications-of-hashing" class="md-nav__link">
                        Applications of Hashing
                      </a>

                      <nav class="md-nav" aria-label="Applications of Hashing">
                        <ul class="md-nav__list">
                          <li class="md-nav__item">
                            <a
                              href="#determine-the-number-of-different-substrings-in-a-string"
                              class="md-nav__link"
                            >
                              Determine the number of different substrings in a
                              string
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="#improve-no-collision-probability"
                        class="md-nav__link"
                      >
                        Improve no-collision probability
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#practice-problems" class="md-nav__link">
                        Practice Problems
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              <script type="text/javascript">
                window.onload = function () {
                  const newIssueURL =
                    "https://github.com/e-maxx-eng/e-maxx-eng/issues/new";
                  const issueTitle = `Problem on article "String Hashing"`;
                  const issueBody = `
 **Article:** [String Hashing](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
                  var issue_a = document.getElementById("report_issue_a");
                  issue_a.href =
                    `${newIssueURL}?` +
                    `title=${encodeURIComponent(issueTitle)}&` +
                    `body=${encodeURIComponent(issueBody)}`;
                };
              </script>

              <h1 id="string-hashing">String Hashing</h1>
              <p>
                Hashing algorithms are helpful in solving a lot of problems.
              </p>
              <p>
                We want to solve the problem of comparing strings efficiently.
                The brute force way of doing so is just to compare the letters
                of both strings, which has a time complexity of
                <span class="arithmatex">\(O(\min(n_1, n_2))\)</span> if
                <span class="arithmatex">\(n_1\)</span> and
                <span class="arithmatex">\(n_2\)</span> are the sizes of the two
                strings. We want to do better. The idea behind strings is the
                following: we convert each string into an integer and compare
                those instead of the strings. Comparing two strings is then an
                <span class="arithmatex">\(O(1)\)</span> operation.
              </p>
              <p>
                For the conversion, we need a so-called
                <strong>hash function</strong>. The goal of it is to convert a
                string into an integer, the so-called <strong>hash</strong> of
                the string. The following condition has to hold: if two strings
                <span class="arithmatex">\(s\)</span> and
                <span class="arithmatex">\(t\)</span> are equal (<span
                  class="arithmatex"
                  >\(s = t\)</span
                >), then also their hashes have to be equal (<span
                  class="arithmatex"
                  >\(\text{hash}(s) = \text{hash}(t)\)</span
                >). Otherwise, we will not be able to compare strings.
              </p>
              <p>
                Notice, the opposite direction doesn't have to hold. If the
                hashes are equal (<span class="arithmatex"
                  >\(\text{hash}(s) = \text{hash}(t)\)</span
                >), then the strings do not necessarily have to be equal. E.g. a
                valid hash function would be simply
                <span class="arithmatex">\(\text{hash}(s) = 0\)</span> for each
                <span class="arithmatex">\(s\)</span>. Now, this is just a
                stupid example, because this function will be completely
                useless, but it is a valid hash function. The reason why the
                opposite direction doesn't have to hold, is because there are
                exponentially many strings. If we only want this hash function
                to distinguish between all strings consisting of lowercase
                characters of length smaller than 15, then already the hash
                wouldn't fit into a 64-bit integer (e.g. unsigned long long) any
                more, because there are so many of them. And of course, we don't
                want to compare arbitrary long integers, because this will also
                have the complexity <span class="arithmatex">\(O(n)\)</span>.
              </p>
              <p>
                So usually we want the hash function to map strings onto numbers
                of a fixed range <span class="arithmatex">\([0, m)\)</span>,
                then comparing strings is just a comparison of two integers with
                a fixed length. And of course, we want
                <span class="arithmatex"
                  >\(\text{hash}(s) \neq \text{hash}(t)\)</span
                >
                to be very likely if
                <span class="arithmatex">\(s \neq t\)</span>.
              </p>
              <p>
                That's the important part that you have to keep in mind. Using
                hashing will not be 100% deterministically correct, because two
                complete different strings might have the same hash (the hashes
                collide). However, in a wide majority of tasks, this can be
                safely ignored as the probability of the hashes of two different
                strings colliding is still very small. And we will discuss some
                techniques in this article how to keep the probability of
                collisions very low.
              </p>
              <h2 id="calculation-of-the-hash-of-a-string">
                Calculation of the hash of a string
              </h2>
              <p>
                The good and widely used way to define the hash of a string
                <span class="arithmatex">\(s\)</span> of length
                <span class="arithmatex">\(n\)</span> is
              </p>
              <div class="arithmatex">
                \[\begin{align} \text{hash}(s) &amp;= s[0] + s[1] \cdot p + s[2]
                \cdot p^2 + ... + s[n-1] \cdot p^{n-1} \mod m \\ &amp;=
                \sum_{i=0}^{n-1} s[i] \cdot p^i \mod m, \end{align}\]
              </div>
              <p>
                where <span class="arithmatex">\(p\)</span> and
                <span class="arithmatex">\(m\)</span> are some chosen, positive
                numbers. It is called a
                <strong>polynomial rolling hash function</strong>.
              </p>
              <p>
                It is reasonable to make <span class="arithmatex">\(p\)</span> a
                prime number roughly equal to the number of characters in the
                input alphabet. For example, if the input is composed of only
                lowercase letters of the English alphabet,
                <span class="arithmatex">\(p = 31\)</span> is a good choice. If
                the input may contain both uppercase and lowercase letters, then
                <span class="arithmatex">\(p = 53\)</span> is a possible choice.
                The code in this article will use
                <span class="arithmatex">\(p = 31\)</span>.
              </p>
              <p>
                Obviously <span class="arithmatex">\(m\)</span> should be a
                large number since the probability of two random strings
                colliding is about
                <span class="arithmatex">\(\approx \frac{1}{m}\)</span>.
                Sometimes <span class="arithmatex">\(m = 2^{64}\)</span> is
                chosen, since then the integer overflows of 64-bit integers work
                exactly like the modulo operation. However, there exists a
                method, which generates colliding strings (which work
                independently from the choice of
                <span class="arithmatex">\(p\)</span>). So in practice,
                <span class="arithmatex">\(m = 2^{64}\)</span> is not
                recommended. A good choice for
                <span class="arithmatex">\(m\)</span> is some large prime
                number. The code in this article will just use
                <span class="arithmatex">\(m = 10^9+9\)</span>. This is a large
                number, but still small enough so that we can perform
                multiplication of two values using 64-bit integers.
              </p>
              <p>
                Here is an example of calculating the hash of a string
                <span class="arithmatex">\(s\)</span>, which contains only
                lowercase letters. We convert each character of
                <span class="arithmatex">\(s\)</span> to an integer. Here we use
                the conversion
                <span class="arithmatex">\(a \rightarrow 1\)</span>,
                <span class="arithmatex">\(b \rightarrow 2\)</span>,
                <span class="arithmatex">\(\dots\)</span>,
                <span class="arithmatex">\(z \rightarrow 26\)</span>. Converting
                <span class="arithmatex">\(a \rightarrow 0\)</span> is not a
                good idea, because then the hashes of the strings
                <span class="arithmatex">\(a\)</span>,
                <span class="arithmatex">\(aa\)</span>,
                <span class="arithmatex">\(aaa\)</span>,
                <span class="arithmatex">\(\dots\)</span> all evaluate to
                <span class="arithmatex">\(0\)</span>.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">compute_hash</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">31</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">hash_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">p_pow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">hash_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">hash_value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_pow</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">p_pow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p_pow</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">hash_value</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                Precomputing the powers of
                <span class="arithmatex">\(p\)</span> might give a performance
                boost.
              </p>
              <h2 id="example-tasks">Example tasks</h2>
              <h3 id="search-for-duplicate-strings-in-an-array-of-strings">
                Search for duplicate strings in an array of strings
              </h3>
              <p>
                Problem: Given a list of
                <span class="arithmatex">\(n\)</span> strings
                <span class="arithmatex">\(s_i\)</span>, each no longer than
                <span class="arithmatex">\(m\)</span> characters, find all the
                duplicate strings and divide them into groups.
              </p>
              <p>
                From the obvious algorithm involving sorting the strings, we
                would get a time complexity of
                <span class="arithmatex">\(O(n m \log n)\)</span> where the
                sorting requires
                <span class="arithmatex">\(O(n \log n)\)</span> comparisons and
                each comparison take
                <span class="arithmatex">\(O(m)\)</span> time. However, by using
                hashes, we reduce the comparison time to
                <span class="arithmatex">\(O(1)\)</span>, giving us an algorithm
                that runs in
                <span class="arithmatex">\(O(n m + n \log n)\)</span> time.
              </p>
              <p>
                We calculate the hash for each string, sort the hashes together
                with the indices, and then group the indices by identical
                hashes.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">group_identical_strings</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">hashes</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">hashes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">compute_hash</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">i</span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">sort</span><span class="p">(</span><span class="n">hashes</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">hashes</span><span class="p">.</span><span class="n">end</span><span class="p">());</span><span class="w"></span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">groups</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">hashes</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">hashes</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">].</span><span class="n">first</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">groups</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">groups</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">push_back</span><span class="p">(</span><span class="n">hashes</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">groups</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <h3 id="fast-hash-calculation-of-substrings-of-given-string">
                Fast hash calculation of substrings of given string
              </h3>
              <p>
                Problem: Given a string
                <span class="arithmatex">\(s\)</span> and indices
                <span class="arithmatex">\(i\)</span> and
                <span class="arithmatex">\(j\)</span>, find the hash of the
                substring <span class="arithmatex">\(s [i \dots j]\)</span>.
              </p>
              <p>By definition, we have:</p>
              <div class="arithmatex">
                \[\text{hash}(s[i \dots j]) = \sum_{k = i}^j s[k] \cdot p^{k-i}
                \mod m\]
              </div>
              <p>
                Multiplying by <span class="arithmatex">\(p^i\)</span> gives:
              </p>
              <div class="arithmatex">
                \[\begin{align} \text{hash}(s[i \dots j]) \cdot p^i &amp;=
                \sum_{k = i}^j s[k] \cdot p^k \mod m \\ &amp;= \text{hash}(s[0
                \dots j]) - \text{hash}(s[0 \dots i-1]) \mod m \end{align}\]
              </div>
              <p>
                So by knowing the hash value of each prefix of the string
                <span class="arithmatex">\(s\)</span>, we can compute the hash
                of any substring directly using this formula. The only problem
                that we face in calculating it is that we must be able to divide
                <span class="arithmatex"
                  >\(\text{hash}(s[0 \dots j]) - \text{hash}(s[0 \dots
                  i-1])\)</span
                >
                by <span class="arithmatex">\(p^i\)</span>. Therefore we need to
                find the
                <a href="../algebra/module-inverse.html"
                  >modular multiplicative inverse</a
                >
                of <span class="arithmatex">\(p^i\)</span> and then perform
                multiplication with this inverse. We can precompute the inverse
                of every <span class="arithmatex">\(p^i\)</span>, which allows
                computing the hash of any substring of
                <span class="arithmatex">\(s\)</span> in
                <span class="arithmatex">\(O(1)\)</span> time.
              </p>
              <p>
                However, there does exist an easier way. In most cases, rather
                than calculating the hashes of substring exactly, it is enough
                to compute the hash multiplied by some power of
                <span class="arithmatex">\(p\)</span>. Suppose we have two
                hashes of two substrings, one multiplied by
                <span class="arithmatex">\(p^i\)</span> and the other by
                <span class="arithmatex">\(p^j\)</span>. If
                <span class="arithmatex">\(i &lt; j\)</span> then we multiply
                the first hash by <span class="arithmatex">\(p^{j-i}\)</span>,
                otherwise, we multiply the second hash by
                <span class="arithmatex">\(p^{i-j}\)</span>. By doing this, we
                get both the hashes multiplied by the same power of
                <span class="arithmatex">\(p\)</span> (which is the maximum of
                <span class="arithmatex">\(i\)</span> and
                <span class="arithmatex">\(j\)</span>) and now these hashes can
                be compared easily with no need for any division.
              </p>
              <h2 id="applications-of-hashing">Applications of Hashing</h2>
              <p>Here are some typical applications of Hashing:</p>
              <ul>
                <li>
                  <a href="rabin-karp.html">Rabin-Karp algorithm</a> for pattern
                  matching in a string in
                  <span class="arithmatex">\(O(n)\)</span> time
                </li>
                <li>
                  Calculating the number of different substrings of a string in
                  <span class="arithmatex">\(O(n^2 \log n)\)</span> (see below)
                </li>
                <li>
                  Calculating the number of palindromic substrings in a string.
                </li>
              </ul>
              <h3 id="determine-the-number-of-different-substrings-in-a-string">
                Determine the number of different substrings in a string
              </h3>
              <p>
                Problem: Given a string <span class="arithmatex">\(s\)</span> of
                length <span class="arithmatex">\(n\)</span>, consisting only of
                lowercase English letters, find the number of different
                substrings in this string.
              </p>
              <p>
                To solve this problem, we iterate over all substring lengths
                <span class="arithmatex">\(l = 1 \dots n\)</span>. For every
                substring length <span class="arithmatex">\(l\)</span> we
                construct an array of hashes of all substrings of length
                <span class="arithmatex">\(l\)</span> multiplied by the same
                power of <span class="arithmatex">\(p\)</span>. The number of
                different elements in the array is equal to the number of
                distinct substrings of length
                <span class="arithmatex">\(l\)</span> in the string. This number
                is added to the final answer.
              </p>
              <p>
                For convenience, we will use
                <span class="arithmatex">\(h[i]\)</span> as the hash of the
                prefix with <span class="arithmatex">\(i\)</span> characters,
                and define <span class="arithmatex">\(h[0] = 0\)</span>.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">count_unique_substrings</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">31</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e9</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">p_pow</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">p_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">p_pow</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">p_pow</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_pow</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">set</span><span class="o">&lt;</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hs</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">cur_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">cur_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cur_h</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_pow</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="mi">-1</span><span class="p">])</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">m</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">hs</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">cur_h</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">cnt</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">hs</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cnt</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <h2 id="improve-no-collision-probability">
                Improve no-collision probability
              </h2>
              <p>
                Quite often the above mentioned polynomial hash is good enough,
                and no collisions will happen during tests. Remember, the
                probability that collision happens is only
                <span class="arithmatex">\(\approx \frac{1}{m}\)</span>. For
                <span class="arithmatex">\(m = 10^9 + 9\)</span> the probability
                is <span class="arithmatex">\(\approx 10^{-9}\)</span> which is
                quite low. But notice, that we only did one comparison. What if
                we compared a string <span class="arithmatex">\(s\)</span> with
                <span class="arithmatex">\(10^6\)</span> different strings. The
                probability that at least one collision happens is now
                <span class="arithmatex">\(\approx 10^{-3}\)</span>. And if we
                want to compare
                <span class="arithmatex">\(10^6\)</span> different strings with
                each other (e.g. by counting how many unique strings exists),
                then the probability of at least one collision happening is
                already <span class="arithmatex">\(\approx 1\)</span>. It is
                pretty much guaranteed that this task will end with a collision
                and returns the wrong result.
              </p>
              <p>
                There is a really easy trick to get better probabilities. We can
                just compute two different hashes for each string (by using two
                different <span class="arithmatex">\(p\)</span>, and/or
                different <span class="arithmatex">\(m\)</span>, and compare
                these pairs instead. If <span class="arithmatex">\(m\)</span> is
                about <span class="arithmatex">\(10^9\)</span> for each of the
                two hash functions than this is more or less equivalent as
                having one hash function with
                <span class="arithmatex">\(m \approx 10^{18}\)</span>. When
                comparing <span class="arithmatex">\(10^6\)</span> strings with
                each other, the probability that at least one collision happens
                is now reduced to
                <span class="arithmatex">\(\approx 10^{-6}\)</span>.
              </p>
              <h2 id="practice-problems">Practice Problems</h2>
              <ul>
                <li>
                  <a href="http://www.spoj.com/problems/NHAY/"
                    >A Needle in the Haystack - SPOJ</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/problemset/problem/154/C"
                    >Double Profiles - Codeforces</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/problemset/problem/126/B"
                    >Password - Codeforces</a
                  >
                </li>
                <li>
                  <a href="http://www.spoj.com/problems/SUB_PROB/"
                    >SUB_PROB - SPOJ</a
                  >
                </li>
                <li>
                  <a href="https://www.codechef.com/problems/INSQ15_A"
                    >INSQ15_A</a
                  >
                </li>
                <li>
                  <a href="http://www.spoj.com/problems/ADACLEAN/"
                    >SPOJ - Ada and Spring Cleaning</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/gym/101466/problem/E"
                    >GYM - Text Editor</a
                  >
                </li>
                <li>
                  <a
                    href="https://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=3163"
                    >12012 - Detection of Extraterrestrial</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/727/problem/E"
                    >Codeforces - Games on a CD</a
                  >
                </li>
                <li>
                  <a
                    href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2955"
                    >UVA 11855 - Buzzwords</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/752/problem/D"
                    >Codeforces - Santa Claus and a Palindrome</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/825/problem/F"
                    >Codeforces - String Compression</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/835/problem/D"
                    >Codeforces - Palindromic Characteristics</a
                  >
                </li>
                <li>
                  <a href="http://www.spoj.com/problems/CF25E/">SPOJ - Test</a>
                </li>
                <li>
                  <a href="http://codeforces.com/contest/7/problem/D"
                    >Codeforces - Palindrome Degree</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/19/problem/C"
                    >Codeforces - Deletion of Repeats</a
                  >
                </li>
                <li>
                  <a
                    href="https://www.hackerrank.com/contests/womens-codesprint-5/challenges/gift-boxes"
                    >HackerRank - Gift Boxes</a
                  >
                </li>
              </ul>
            </article>
          </div>
        </div>
      </main>
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">
      {
        "base": "..",
        "features": [],
        "translations": {
          "clipboard.copy": "Copy to clipboard",
          "clipboard.copied": "Copied to clipboard",
          "search.config.lang": "en",
          "search.config.pipeline": "trimmer, stopWordFilter",
          "search.config.separator": "[\\s\\-]+",
          "search.placeholder": "Search",
          "search.result.placeholder": "Type to start searching",
          "search.result.none": "No matching documents",
          "search.result.one": "1 matching document",
          "search.result.other": "# matching documents",
          "search.result.more.one": "1 more on this page",
          "search.result.more.other": "# more on this page",
          "search.result.term.missing": "Missing",
          "select.version.title": "Select version"
        },
        "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"
      }
    </script>

    <script src="../assets/javascripts/bundle.467223ff.min.js"></script>

    <script src="../javascript/config.js"></script>

    <script src="../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>

  <!-- Mirrored from  firststeptocp.com/string/string-hashing.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:40 GMT -->
</html>
