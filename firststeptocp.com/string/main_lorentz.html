<!DOCTYPE html>
<html lang="en" class="no-js">
  <!-- Mirrored from  firststeptocp.com/string/main_lorentz.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:40 GMT -->
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="icon" href="../favicon.ico" />
    <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5" />

    <title>Finding repetitions - Algorithms for Competitive Programming</title>

    <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css" />

    <link
      rel="stylesheet"
      href="../assets/stylesheets/palette.e6a45f82.min.css"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"
    />
    <style>
      :root {
        --md-text-font: "Roboto";
        --md-code-font: "Roboto Mono";
      }
    </style>

    <link rel="stylesheet" href="../stylesheets/extra.css" />

    <script>
      (__md_scope = new URL("..", location)),
        (__md_get = (e, _ = localStorage, t = __md_scope) =>
          JSON.parse(_.getItem(t.pathname + "." + e))),
        (__md_set = (e, _, t = localStorage, a = __md_scope) => {
          try {
            t.setItem(a.pathname + "." + e, JSON.stringify(_));
          } catch (e) {}
        });
    </script>

    <script>
      (window.ga =
        window.ga ||
        function () {
          (ga.q = ga.q || []).push(arguments);
        }),
        (ga.l = +new Date()),
        ga("create", "UA-85220282-1", "auto"),
        ga("set", "anonymizeIp", !0),
        ga("send", "pageview"),
        document.addEventListener("DOMContentLoaded", function () {
          document.forms.search &&
            document.forms.search.query.addEventListener("blur", function () {
              var e;
              this.value &&
                ((e = document.location.pathname),
                ga("send", "pageview", e + "?q=" + this.value));
            }),
            "undefined" != typeof location$ &&
              location$.subscribe(function (e) {
                ga("send", "pageview", e.pathname);
              });
        });
    </script>
    <script async src="../../www.google-analytics.com/analytics.js"></script>
  </head>

  <body
    dir="ltr"
    data-md-color-scheme="cpalgo"
    data-md-color-primary="deep-purple"
    data-md-color-accent=""
  >
    <script>
      var palette = __md_get("__palette");
      if (palette && "object" == typeof palette.color)
        for (var key of Object.keys(palette.color))
          document.body.setAttribute(
            "data-md-color-" + key,
            palette.color[key]
          );
    </script>

    <input
      class="md-toggle"
      data-md-toggle="drawer"
      type="checkbox"
      id="__drawer"
      autocomplete="off"
    />
    <input
      class="md-toggle"
      data-md-toggle="search"
      type="checkbox"
      id="__search"
      autocomplete="off"
    />
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      <a href="#finding-repetitions" class="md-skip"> Skip to content </a>
    </div>
    <div data-md-component="announce"></div>

    <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
- remove the menu button for mobile
-->

    <header class="md-header" data-md-component="header">
      <script>
        function scrollToTop() {
          document.body.scrollTop = 0; // For Safari
          document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
      </script>
      <nav class="md-header__inner md-grid" aria-label="Header">
        <a
          href="../index-2.html"
          title="Algorithms for Competitive Programming"
          class="md-header__button md-logo"
          aria-label="Algorithms for Competitive Programming"
          data-md-component="logo"
        >
          <img src="../favicon.ico" alt="logo" />
        </a>
        <div class="md-header__title" data-md-component="header-title">
          <div class="md-header__ellipsis">
            <div class="md-header__topic">
              <span class="md-ellipsis">
                <a
                  href="../index-2.html"
                  title="Algorithms for Competitive Programming"
                  aria-label="Algorithms for Competitive Programming"
                  data-md-component="logo"
                >
                  Algorithms for Competitive Programming
                </a>
              </span>
            </div>
            <div class="md-header__topic" data-md-component="header-topic">
              <span class="md-ellipsis">
                <a href="#" onclick="scrollToTop()"> Finding repetitions </a>
              </span>
            </div>
          </div>
        </div>

        <form class="md-header__option" data-md-component="palette">
          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="cpalgo"
            data-md-color-primary="deep-purple"
            data-md-color-accent=""
            aria-label="Switch to dark mode"
            type="radio"
            name="__palette"
            id="__palette_1"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to dark mode"
            for="__palette_2"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
              />
            </svg>
          </label>

          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="slate"
            data-md-color-primary=""
            data-md-color-accent=""
            aria-label="Switch to light mode"
            type="radio"
            name="__palette"
            id="__palette_2"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to light mode"
            for="__palette_1"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"
              />
            </svg>
          </label>
        </form>

        <label class="md-header__button md-icon" for="__search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"
            />
          </svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
          <label class="md-search__overlay" for="__search"></label>
        </div>
      </nav>
    </header>

    <div class="md-container" data-md-component="container">
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          <div
            class="md-sidebar md-sidebar--primary"
            data-md-component="sidebar"
            data-md-type="navigation"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--primary"
                  aria-label="Navigation"
                  data-md-level="0"
                >
                  <label class="md-nav__title" for="__drawer">
                    <a
                      href="../index-2.html"
                      title="Algorithms for Competitive Programming"
                      class="md-nav__button md-logo"
                      aria-label="Algorithms for Competitive Programming"
                      data-md-component="logo"
                    >
                      <img src="../favicon.ico" alt="logo" />
                    </a>
                    Algorithms for Competitive Programming
                  </label>

                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="../index-2.html" class="md-nav__link">
                        Main Page
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../contrib.html" class="md-nav__link">
                        How to Contribute
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../preview.html" class="md-nav__link">
                        Preview
                      </a>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_4"
                        type="checkbox"
                        id="__nav_4"
                      />

                      <label class="md-nav__link" for="__nav_4">
                        Algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_4">
                          <span class="md-nav__icon md-icon"></span>
                          Algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../algebra/all-submasks.html"
                              class="md-nav__link"
                            >
                              Submask Enumeration
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/balanced-ternary.html"
                              class="md-nav__link"
                            >
                              Balanced Ternary
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/big-integer.html"
                              class="md-nav__link"
                            >
                              Arbitrary-Precision Arithmetic
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/binary-exp.html"
                              class="md-nav__link"
                            >
                              Binary Exponentiation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/chinese-remainder-theorem.html"
                              class="md-nav__link"
                            >
                              Chinese Remainder Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-log.html"
                              class="md-nav__link"
                            >
                              Discrete Logarithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-root.html"
                              class="md-nav__link"
                            >
                              Discrete Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/divisors.html"
                              class="md-nav__link"
                            >
                              Number of divisors / sum of divisors
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Euclidean algorithm for computing the greatest
                              common divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/extended-euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Extended Euclidean Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-divisors.html"
                              class="md-nav__link"
                            >
                              Finding Power of Factorial Divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-modulo.html"
                              class="md-nav__link"
                            >
                              Factorial modulo p
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorization.html"
                              class="md-nav__link"
                            >
                              Integer factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../algebra/fft.html" class="md-nav__link">
                              Fast Fourier transform
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/fibonacci-numbers.html"
                              class="md-nav__link"
                            >
                              Fibonacci Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/gray-code.html"
                              class="md-nav__link"
                            >
                              Gray code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear-diophantine-equation.html"
                              class="md-nav__link"
                            >
                              Linear Diophantine Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear_congruence_equation.html"
                              class="md-nav__link"
                            >
                              Linear Congruence Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/module-inverse.html"
                              class="md-nav__link"
                            >
                              Modular Multiplicative Inverse
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/montgomery_multiplication.html"
                              class="md-nav__link"
                            >
                              Montgomery Multiplication
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/phi-function.html"
                              class="md-nav__link"
                            >
                              Euler's totient function
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/polynomial.html"
                              class="md-nav__link"
                            >
                              Operations on polynomials and series
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primality_tests.html"
                              class="md-nav__link"
                            >
                              Primality tests
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/prime-sieve-linear.html"
                              class="md-nav__link"
                            >
                              Linear Sieve
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primitive-root.html"
                              class="md-nav__link"
                            >
                              Primitive Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/sieve-of-eratosthenes.html"
                              class="md-nav__link"
                            >
                              Sieve of Eratosthenes
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_5"
                        type="checkbox"
                        id="__nav_5"
                      />

                      <label class="md-nav__link" for="__nav_5">
                        Combinatorics
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Combinatorics"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_5">
                          <span class="md-nav__icon md-icon"></span>
                          Combinatorics
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/binomial-coefficients.html"
                              class="md-nav__link"
                            >
                              Binomial Coefficients
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bishops-on-chessboard.html"
                              class="md-nav__link"
                            >
                              Placing Bishops on a Chessboard
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bracket_sequences.html"
                              class="md-nav__link"
                            >
                              Balanced bracket sequences
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/burnside.html"
                              class="md-nav__link"
                            >
                              Burnside's lemma / Pólya enumeration theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/catalan-numbers.html"
                              class="md-nav__link"
                            >
                              Catalan Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/counting_labeled_graphs.html"
                              class="md-nav__link"
                            >
                              Counting labeled graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/generating_combinations.html"
                              class="md-nav__link"
                            >
                              Generating all K-combinations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/inclusion-exclusion.html"
                              class="md-nav__link"
                            >
                              The Inclusion-Exclusion Principle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/stars_and_bars.html"
                              class="md-nav__link"
                            >
                              Stars and bars
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_6"
                        type="checkbox"
                        id="__nav_6"
                      />

                      <label class="md-nav__link" for="__nav_6">
                        Data structures
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Data structures"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_6">
                          <span class="md-nav__icon md-icon"></span>
                          Data structures
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../data_structures/deleting_in_log_n.html"
                              class="md-nav__link"
                            >
                              Deleting from a data structure in O(T(n)log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/disjoint_set_union.html"
                              class="md-nav__link"
                            >
                              Disjoint Set Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/fenwick.html"
                              class="md-nav__link"
                            >
                              Fenwick Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/randomized_heap.html"
                              class="md-nav__link"
                            >
                              Randomized Heap
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/segment_tree.html"
                              class="md-nav__link"
                            >
                              Segment Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sparse-table.html"
                              class="md-nav__link"
                            >
                              Sparse Table
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt-tree.html"
                              class="md-nav__link"
                            >
                              Sqrt Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt_decomposition.html"
                              class="md-nav__link"
                            >
                              Sqrt Decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/stack_queue_modification.html"
                              class="md-nav__link"
                            >
                              Minimum stack / Minimum queue
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/treap.html"
                              class="md-nav__link"
                            >
                              Treap (Cartesian tree)
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_7"
                        type="checkbox"
                        id="__nav_7"
                      />

                      <label class="md-nav__link" for="__nav_7">
                        Dynamic programming
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Dynamic programming"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_7">
                          <span class="md-nav__icon md-icon"></span>
                          Dynamic programming
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/divide-and-conquer-dp.html"
                              class="md-nav__link"
                            >
                              Divide and Conquer DP
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/profile-dynamics.html"
                              class="md-nav__link"
                            >
                              Dynamic Programming on Broken Profile. Problem
                              "Parquet"
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/zero_matrix.html"
                              class="md-nav__link"
                            >
                              Finding the largest zero submatrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_8"
                        type="checkbox"
                        id="__nav_8"
                      />

                      <label class="md-nav__link" for="__nav_8">
                        Game theory
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Game theory"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_8">
                          <span class="md-nav__icon md-icon"></span>
                          Game theory
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../game_theory/games_on_graphs.html"
                              class="md-nav__link"
                            >
                              Games on arbitrary graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../game_theory/sprague-grundy-nim.html"
                              class="md-nav__link"
                            >
                              Sprague-Grundy theorem. Nim
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_9"
                        type="checkbox"
                        id="__nav_9"
                      />

                      <label class="md-nav__link" for="__nav_9">
                        Geometry
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Geometry"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_9">
                          <span class="md-nav__icon md-icon"></span>
                          Geometry
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../geometry/area-of-simple-polygon.html"
                              class="md-nav__link"
                            >
                              Finding area of simple polygon in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/basic-geometry.html"
                              class="md-nav__link"
                            >
                              Basic Geometry
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/check-segments-intersection.html"
                              class="md-nav__link"
                            >
                              Check if two segments intersect
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/circle-circle-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Circle Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/circle-line-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Line Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/convex-hull.html"
                              class="md-nav__link"
                            >
                              Convex Hull construction
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/convex_hull_trick.html"
                              class="md-nav__link"
                            >
                              Convex hull trick and Li Chao tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/delaunay.html"
                              class="md-nav__link"
                            >
                              Delaunay triangulation and Voronoi diagram
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/halfplane-intersection.html"
                              class="md-nav__link"
                            >
                              Half-plane intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/intersecting_segments.html"
                              class="md-nav__link"
                            >
                              Search for a pair of intersecting segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/lattice-points.html"
                              class="md-nav__link"
                            >
                              Lattice points inside non-lattice polygon
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/length-of-segments-union.html"
                              class="md-nav__link"
                            >
                              Length of the union of segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/lines-intersection.html"
                              class="md-nav__link"
                            >
                              Intersection Point of Lines
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/minkowski.html"
                              class="md-nav__link"
                            >
                              Minkowski sum of convex polygons
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/nearest_points.html"
                              class="md-nav__link"
                            >
                              Finding the nearest pair of points
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/oriented-triangle-area.html"
                              class="md-nav__link"
                            >
                              Oriented area of a triangle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/picks-theorem.html"
                              class="md-nav__link"
                            >
                              Pick's Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/point-in-convex-polygon.html"
                              class="md-nav__link"
                            >
                              Check if point belongs to the convex polygon in
                              $O(\log N)$
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/point-location.html"
                              class="md-nav__link"
                            >
                              Point location in O(log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/segment-to-line.html"
                              class="md-nav__link"
                            >
                              Finding the equation of a line for a segment
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/segments-intersection.html"
                              class="md-nav__link"
                            >
                              Finding intersection of two segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/tangents-to-two-circles.html"
                              class="md-nav__link"
                            >
                              Finding common tangents to two circles
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../geometry/vertical_decomposition.html"
                              class="md-nav__link"
                            >
                              Vertical decomposition
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_10"
                        type="checkbox"
                        id="__nav_10"
                      />

                      <label class="md-nav__link" for="__nav_10">
                        Graph
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Graph" data-md-level="1">
                        <label class="md-nav__title" for="__nav_10">
                          <span class="md-nav__icon md-icon"></span>
                          Graph
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="../graph/01_bfs.html" class="md-nav__link">
                              0-1 BFS
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/2SAT.html" class="md-nav__link">
                              2-SAT
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/Assignment-problem-min-flow.html"
                              class="md-nav__link"
                            >
                              Solving assignment problem using min-cost-flow
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/all-pair-shortest-path-floyd-warshall.html"
                              class="md-nav__link"
                            >
                              Floyd-Warshall Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bellman_ford.html"
                              class="md-nav__link"
                            >
                              Bellman-Ford Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bipartite-check.html"
                              class="md-nav__link"
                            >
                              Check whether a graph is bipartite
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/breadth-first-search.html"
                              class="md-nav__link"
                            >
                              Breadth-first search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching-online.html"
                              class="md-nav__link"
                            >
                              Finding Bridges Online
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching.html"
                              class="md-nav__link"
                            >
                              Finding bridges in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/cutpoints.html"
                              class="md-nav__link"
                            >
                              Finding articulation points in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/depth-first-search.html"
                              class="md-nav__link"
                            >
                              Depth First Search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/desopo_pape.html"
                              class="md-nav__link"
                            >
                              D´Esopo-Pape algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra.html"
                              class="md-nav__link"
                            >
                              Dijkstra Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra_sparse.html"
                              class="md-nav__link"
                            >
                              Dijkstra on sparse graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/dinic.html" class="md-nav__link">
                              Maximum flow - Dinic's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edge_vertex_connectivity.html"
                              class="md-nav__link"
                            >
                              Edge connectivity / Vertex connectivity
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edmonds_karp.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Ford-Fulkerson and Edmonds-Karp
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/euler_path.html"
                              class="md-nav__link"
                            >
                              Finding the Eulerian path in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-cycle.html"
                              class="md-nav__link"
                            >
                              Checking a graph for acyclicity and finding a
                              cycle in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-negative-cycle-in-graph.html"
                              class="md-nav__link"
                            >
                              Finding a negative cycle in the graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/fixed_length_paths.html"
                              class="md-nav__link"
                            >
                              Number of paths of fixed length / Shortest paths
                              of fixed length
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/flow_with_demands.html"
                              class="md-nav__link"
                            >
                              Flows with demands
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/hld.html" class="md-nav__link">
                              Heavy-light decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kirchhoff-theorem.html"
                              class="md-nav__link"
                            >
                              Kirchhoff's theorem. Finding the number of
                              spanning trees
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kuhn_maximum_bipartite_matching.html"
                              class="md-nav__link"
                            >
                              Kuhn's Algorithm for Maximum Bipartite Matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/lca.html" class="md-nav__link">
                              Lowest Common Ancestor - O(sqrt(N)) and O(log N)
                              with O(N) preprocessing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_binary_lifting.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Binary Lifting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_farachcoltonbender.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Farach-Colton and Bender
                              Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_tarjan.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Tarjan's off-line
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/min_cost_flow.html"
                              class="md-nav__link"
                            >
                              Minimum-cost flow - Successive shortest path
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/mpm.html" class="md-nav__link">
                              Maximum flow - MPM algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal_with_dsu.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal with Disjoint Set
                              Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_prim.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Prim's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/pruefer_code.html"
                              class="md-nav__link"
                            >
                              Prüfer code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel-faster.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel method improved
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/rmq_linear.html"
                              class="md-nav__link"
                            >
                              Solve RMQ (Range Minimum Query) by finding LCA
                              (Lowest Common Ancestor)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/search-for-connected-components.html"
                              class="md-nav__link"
                            >
                              Search for connected components in a graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/second_best_mst.html"
                              class="md-nav__link"
                            >
                              Second Best Minimum Spanning Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strong-orientation.html"
                              class="md-nav__link"
                            >
                              Strong Orientation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strongly-connected-components.html"
                              class="md-nav__link"
                            >
                              Finding strongly connected components / Building
                              condensation graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/topological-sort.html"
                              class="md-nav__link"
                            >
                              Topological Sorting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/tree_painting.html"
                              class="md-nav__link"
                            >
                              Paint the edges of the tree
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_11"
                        type="checkbox"
                        id="__nav_11"
                      />

                      <label class="md-nav__link" for="__nav_11">
                        Linear algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Linear algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_11">
                          <span class="md-nav__icon md-icon"></span>
                          Linear algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-gauss.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant of a matrix by Gauss
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-kraut.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant using Kraut method
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/linear-system-gauss.html"
                              class="md-nav__link"
                            >
                              Gauss method for solving system of linear
                              equations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/rank-matrix.html"
                              class="md-nav__link"
                            >
                              Finding the rank of a matrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_12"
                        type="checkbox"
                        id="__nav_12"
                      />

                      <label class="md-nav__link" for="__nav_12">
                        Num methods
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Num methods"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_12">
                          <span class="md-nav__icon md-icon"></span>
                          Num methods
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../num_methods/roots_newton.html"
                              class="md-nav__link"
                            >
                              Newton's method for finding roots
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/simpson-integration.html"
                              class="md-nav__link"
                            >
                              Integration by Simpson's formula
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/ternary_search.html"
                              class="md-nav__link"
                            >
                              Ternary Search
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_13"
                        type="checkbox"
                        id="__nav_13"
                      />

                      <label class="md-nav__link" for="__nav_13">
                        Others
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Others" data-md-level="1">
                        <label class="md-nav__title" for="__nav_13">
                          <span class="md-nav__icon md-icon"></span>
                          Others
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../others/15-puzzle.html"
                              class="md-nav__link"
                            >
                              15 Puzzle Game: Existence Of The Solution
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/josephus_problem.html"
                              class="md-nav__link"
                            >
                              Josephus Problem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/maximum_average_segment.html"
                              class="md-nav__link"
                            >
                              Search the subarray with the maximum/minimum sum
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/stern_brocot_tree_farey_sequences.html"
                              class="md-nav__link"
                            >
                              The Stern-Brocot tree and Farey sequences
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_14"
                        type="checkbox"
                        id="__nav_14"
                      />

                      <label class="md-nav__link" for="__nav_14">
                        Schedules
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Schedules"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_14">
                          <span class="md-nav__icon md-icon"></span>
                          Schedules
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule-with-completion-duration.html"
                              class="md-nav__link"
                            >
                              Optimal schedule of jobs given their deadlines and
                              durations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_one_machine.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on one machine
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_two_machines.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on two machines
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_15"
                        type="checkbox"
                        id="__nav_15"
                      />

                      <label class="md-nav__link" for="__nav_15">
                        Sequences
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Sequences"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_15">
                          <span class="md-nav__icon md-icon"></span>
                          Sequences
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../sequences/k-th.html"
                              class="md-nav__link"
                            >
                              K-th order statistic in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/longest_increasing_subsequence.html"
                              class="md-nav__link"
                            >
                              Longest increasing subsequence
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/rmq.html"
                              class="md-nav__link"
                            >
                              Range Minimum Query
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li
                      class="md-nav__item md-nav__item--active md-nav__item--nested"
                    >
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_16"
                        type="checkbox"
                        id="__nav_16"
                        checked
                      />

                      <label class="md-nav__link" for="__nav_16">
                        String
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="String" data-md-level="1">
                        <label class="md-nav__title" for="__nav_16">
                          <span class="md-nav__icon md-icon"></span>
                          String
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="aho_corasick.html" class="md-nav__link">
                              Aho-Corasick algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="expression_parsing.html"
                              class="md-nav__link"
                            >
                              Expression parsing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="lyndon_factorization.html"
                              class="md-nav__link"
                            >
                              Lyndon factorization
                            </a>
                          </li>

                          <li class="md-nav__item md-nav__item--active">
                            <input
                              class="md-nav__toggle md-toggle"
                              data-md-toggle="toc"
                              type="checkbox"
                              id="__toc"
                            />

                            <label
                              class="md-nav__link md-nav__link--active"
                              for="__toc"
                            >
                              Finding repetitions
                              <span class="md-nav__icon md-icon"></span>
                            </label>

                            <a
                              href="main_lorentz.html"
                              class="md-nav__link md-nav__link--active"
                            >
                              Finding repetitions
                            </a>

                            <nav
                              class="md-nav md-nav--secondary"
                              aria-label="Table of contents"
                            >
                              <label class="md-nav__title" for="__toc">
                                <span class="md-nav__icon md-icon"></span>
                                Table of contents
                              </label>
                              <ul
                                class="md-nav__list"
                                data-md-component="toc"
                                data-md-scrollfix
                              >
                                <li class="md-nav__item">
                                  <a href="#example" class="md-nav__link">
                                    Example
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#number-of-repetitions"
                                    class="md-nav__link"
                                  >
                                    Number of repetitions
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#main-lorentz-algorithm"
                                    class="md-nav__link"
                                  >
                                    Main-Lorentz algorithm
                                  </a>

                                  <nav
                                    class="md-nav"
                                    aria-label="Main-Lorentz algorithm"
                                  >
                                    <ul class="md-nav__list">
                                      <li class="md-nav__item">
                                        <a
                                          href="#search-for-crossing-repetitions"
                                          class="md-nav__link"
                                        >
                                          Search for crossing repetitions
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#criterion-for-left-crossing-repetitions"
                                          class="md-nav__link"
                                        >
                                          Criterion for left crossing
                                          repetitions
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#right-crossing-repetitions"
                                          class="md-nav__link"
                                        >
                                          Right crossing repetitions
                                        </a>
                                      </li>

                                      <li class="md-nav__item">
                                        <a
                                          href="#implementation"
                                          class="md-nav__link"
                                        >
                                          Implementation
                                        </a>
                                      </li>
                                    </ul>
                                  </nav>
                                </li>
                              </ul>
                            </nav>
                          </li>

                          <li class="md-nav__item">
                            <a href="manacher.html" class="md-nav__link">
                              Manacher's Algorithm - Finding all sub-palindromes
                              in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="prefix-function.html" class="md-nav__link">
                              Prefix function. Knuth–Morris–Pratt algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="rabin-karp.html" class="md-nav__link">
                              Rabin-Karp Algorithm for string matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="string-hashing.html" class="md-nav__link">
                              String Hashing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="suffix-array.html" class="md-nav__link">
                              Suffix Array
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="suffix-automaton.html"
                              class="md-nav__link"
                            >
                              Suffix Automaton
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="suffix-tree-ukkonen.html"
                              class="md-nav__link"
                            >
                              Suffix Tree. Ukkonen's Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="z-function.html" class="md-nav__link">
                              Z-function and its calculation
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div
            class="md-sidebar md-sidebar--secondary"
            data-md-component="sidebar"
            data-md-type="toc"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--secondary"
                  aria-label="Table of contents"
                >
                  <label class="md-nav__title" for="__toc">
                    <span class="md-nav__icon md-icon"></span>
                    Table of contents
                  </label>
                  <ul
                    class="md-nav__list"
                    data-md-component="toc"
                    data-md-scrollfix
                  >
                    <li class="md-nav__item">
                      <a href="#example" class="md-nav__link"> Example </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#number-of-repetitions" class="md-nav__link">
                        Number of repetitions
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#main-lorentz-algorithm" class="md-nav__link">
                        Main-Lorentz algorithm
                      </a>

                      <nav class="md-nav" aria-label="Main-Lorentz algorithm">
                        <ul class="md-nav__list">
                          <li class="md-nav__item">
                            <a
                              href="#search-for-crossing-repetitions"
                              class="md-nav__link"
                            >
                              Search for crossing repetitions
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#criterion-for-left-crossing-repetitions"
                              class="md-nav__link"
                            >
                              Criterion for left crossing repetitions
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="#right-crossing-repetitions"
                              class="md-nav__link"
                            >
                              Right crossing repetitions
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="#implementation" class="md-nav__link">
                              Implementation
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              <script type="text/javascript">
                window.onload = function () {
                  const newIssueURL =
                    "https://github.com/e-maxx-eng/e-maxx-eng/issues/new";
                  const issueTitle = `Problem on article "Finding repetitions"`;
                  const issueBody = `
 **Article:** [Finding repetitions](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
                  var issue_a = document.getElementById("report_issue_a");
                  issue_a.href =
                    `${newIssueURL}?` +
                    `title=${encodeURIComponent(issueTitle)}&` +
                    `body=${encodeURIComponent(issueBody)}`;
                };
              </script>

              <h1 id="finding-repetitions">Finding repetitions</h1>
              <p>
                Given a string <span class="arithmatex">\(s\)</span> of length
                <span class="arithmatex">\(n\)</span>.
              </p>
              <p>
                A <strong>repetition</strong> is two occurrences of a string in
                a row. In other words a repetition can be described by a pair of
                indices <span class="arithmatex">\(i &lt; j\)</span> such that
                the substring
                <span class="arithmatex">\(s[i \dots j]\)</span> consists of two
                identical strings written after each other.
              </p>
              <p>
                The challenge is to <strong>find all repetitions</strong> in a
                given string <span class="arithmatex">\(s\)</span>. Or a
                simplified task: find <strong>any</strong> repetition or find
                the <strong>longest</strong> repetition.
              </p>
              <p>
                The algorithm described here was published in 1982 by Main and
                Lorentz.
              </p>
              <h2 id="example">Example</h2>
              <p>Consider the repetitions in the following example string:</p>
              <div class="arithmatex">\[acababaee\]</div>
              <p>The string contains the following three repetitions:</p>
              <ul>
                <li><span class="arithmatex">\(s[2 \dots 5] = abab\)</span></li>
                <li><span class="arithmatex">\(s[3 \dots 6] = baba\)</span></li>
                <li><span class="arithmatex">\(s[7 \dots 7] = ee\)</span></li>
              </ul>
              <p>Another example:</p>
              <div class="arithmatex">\[abaaba\]</div>
              <p>Here there are only two repetitions</p>
              <ul>
                <li>
                  <span class="arithmatex">\(s[0 \dots 5] = abaaba\)</span>
                </li>
                <li><span class="arithmatex">\(s[2 \dots 3] = aa\)</span></li>
              </ul>
              <h2 id="number-of-repetitions">Number of repetitions</h2>
              <p>
                In general there can be up to
                <span class="arithmatex">\(O(n^2)\)</span> repetitions in a
                string of length <span class="arithmatex">\(n\)</span>. An
                obvious example is a string consisting of
                <span class="arithmatex">\(n\)</span> times the same letter, in
                this case any substring of even length is a repetition. In
                general any periodic string with a short period will contain a
                lot of repetitions.
              </p>
              <p>
                On the other hand this fact does not prevent computing the
                number of repetitions in
                <span class="arithmatex">\(O(n \log n)\)</span> time, because
                the algorithm can give the repetitions in compressed form, in
                groups of several pieces at once.
              </p>
              <p>
                There is even the concept, that describes groups of periodic
                substrings with tuples of size four. It has been proven that we
                the number of such groups is at most linear with respect to the
                string length.
              </p>
              <p>
                Also, here are some more interesting results related to the
                number of repetitions:
              </p>
              <ul>
                <li>
                  The number of primitive repetitions (those whose halves are
                  not repetitions) is at most
                  <span class="arithmatex">\(O(n \log n)\)</span>.
                </li>
                <li>
                  If we encode repetitions with tuples of numbers (called
                  Crochemore triples)
                  <span class="arithmatex">\((i,~ p,~ r)\)</span> (where
                  <span class="arithmatex">\(i\)</span> is the position of the
                  beginning, <span class="arithmatex">\(p\)</span> the length of
                  the repeating substring, and
                  <span class="arithmatex">\(r\)</span> the number of
                  repetitions), then all repetitions can be described with
                  <span class="arithmatex">\(O(n \log n)\)</span> such triples.
                </li>
                <li>
                  <p>Fibonacci strings, defined as</p>
                  <div class="arithmatex">
                    \[\begin{align} t_0 &amp;= a, \\\\ t_1 &amp;= b, \\\\ t_i
                    &amp;= t_{i-1} + t_{i-2}, \end{align}\]
                  </div>
                  <p>
                    are "strongly" periodic. The number of repetitions in the
                    Fibonacci string <span class="arithmatex">\(f_i\)</span>,
                    even in the compressed with Crochemore triples, is
                    <span class="arithmatex">\(O(f_n \log f_n)\)</span>. The
                    number of primitive repetitions is also
                    <span class="arithmatex">\(O(f_n \log f_n)\)</span>.
                  </p>
                </li>
              </ul>
              <h2 id="main-lorentz-algorithm">Main-Lorentz algorithm</h2>
              <p>
                The idea behind the Main-Lorentz algorithm is
                <strong>divide-and-conquer</strong>.
              </p>
              <p>
                It splits the initial string into halves, and computes the
                number of repetitions that lie completely in each halve by two
                recursive calls. Then comes the difficult part. The algorithm
                finds all repetitions starting in the first half and ending in
                the second half (which we will call
                <strong>crossing repetitions</strong>). This is the essential
                part of the Main-Lorentz algorithm, and we will discuss it in
                detail here.
              </p>
              <p>
                The complexity of divide-and-conquer algorithms is well
                researched. The master theorem says, that we will end up with an
                <span class="arithmatex">\(O(n \log n)\)</span> algorithm, if we
                can compute the crossing repetitions in
                <span class="arithmatex">\(O(n)\)</span> time.
              </p>
              <h3 id="search-for-crossing-repetitions">
                Search for crossing repetitions
              </h3>
              <p>
                So we want to find all such repetitions that start in the first
                half of the string, let's call it
                <span class="arithmatex">\(u\)</span>, and end in the second
                half, let's call it <span class="arithmatex">\(v\)</span>:
              </p>
              <div class="arithmatex">\[s = u + v\]</div>
              <p>
                Their lengths are approximately equal to the length of
                <span class="arithmatex">\(s\)</span> divided by two.
              </p>
              <p>
                Consider an arbitrary repetition and look at the middle
                character (more precisely the first character of the second half
                of the repetition). I.e. if the repetition is a substring
                <span class="arithmatex">\(s[i \dots j]\)</span>, then the
                middle character is
                <span class="arithmatex">\((i + j + 1) / 2\)</span>.
              </p>
              <p>
                We call a repetition <strong>left</strong> or
                <strong>right</strong> depending on which string this character
                is located - in the string
                <span class="arithmatex">\(u\)</span> or in the string
                <span class="arithmatex">\(v\)</span>. In other words a string
                is called left, if the majority of it lies in
                <span class="arithmatex">\(u\)</span>, otherwise we call it
                right.
              </p>
              <p>
                We will now discuss how to find
                <strong>all left repetitions</strong>. Finding all right
                repetitions can be done in the same way.
              </p>
              <p>
                Let us denote the length of the left repetition by
                <span class="arithmatex">\(2l\)</span> (i.e. each half of the
                repetition has length <span class="arithmatex">\(l\)</span>).
                Consider the first character of the repetition falling into the
                string <span class="arithmatex">\(v\)</span> (it is at position
                <span class="arithmatex">\(|u|\)</span> in the string
                <span class="arithmatex">\(s\)</span>). It coincides with the
                character <span class="arithmatex">\(l\)</span> positions before
                it, let's denote this position
                <span class="arithmatex">\(cntr\)</span>.
              </p>
              <p>
                We will fixate this position
                <span class="arithmatex">\(cntr\)</span>, and
                <strong>look for all repetitions at this position</strong>
                <span class="arithmatex">\(cntr\)</span>.
              </p>
              <p>For example:</p>
              <div class="arithmatex">
                \[c ~ \underset{cntr}{a} ~ c ~ | ~ a ~ d ~ a\]
              </div>
              <p>
                The vertical lines divides the two halves. Here we fixated the
                position <span class="arithmatex">\(cntr = 1\)</span>, and at
                this position we find the repetition
                <span class="arithmatex">\(caca\)</span>.
              </p>
              <p>
                It is clear, that if we fixate the position
                <span class="arithmatex">\(cntr\)</span>, we simultaneously
                fixate the length of the possible repetitions:
                <span class="arithmatex">\(l = |u| - cntr\)</span>. Once we know
                how to find these repetitions, we will iterate over all possible
                values for <span class="arithmatex">\(cntr\)</span> from
                <span class="arithmatex">\(0\)</span> to
                <span class="arithmatex">\(|u|-1\)</span>, and find all left
                crossover repetitions of length
                <span class="arithmatex">\(l = |u|,~ |u|-1,~ \dots, 1\)</span>.
              </p>
              <h3 id="criterion-for-left-crossing-repetitions">
                Criterion for left crossing repetitions
              </h3>
              <p>
                Now, how can we find all such repetitions for a fixated
                <span class="arithmatex">\(cntr\)</span>? Keep in mind that
                there still can be multiple such repetitions.
              </p>
              <p>
                Let's again look at a visualization, this time for the
                repetition <span class="arithmatex">\(abcabc\)</span>:
              </p>
              <div class="arithmatex">
                \[\overbrace{a}^{l_1} ~ \overbrace{\underset{cntr}{b} ~ c}^{l_2}
                ~ \overbrace{a}^{l_1} ~ | ~ \overbrace{b ~ c}^{l_2}\]
              </div>
              <p>
                Here we denoted the lengths of the two pieces of the repetition
                with <span class="arithmatex">\(l_1\)</span> and
                <span class="arithmatex">\(l_2\)</span>:
                <span class="arithmatex">\(l_1\)</span> is the length of the
                repetition up to the position
                <span class="arithmatex">\(cntr-1\)</span>, and
                <span class="arithmatex">\(l_2\)</span> is the length of the
                repetition from <span class="arithmatex">\(cntr\)</span> to the
                end of the half of the repetition. We have
                <span class="arithmatex">\(2l = l_1 + l_2 + l_1 + l_2\)</span>
                as the total length of the repetition.
              </p>
              <p>
                Let us generate
                <strong>necessary and sufficient</strong> conditions for such a
                repetition at position
                <span class="arithmatex">\(cntr\)</span> of length
                <span class="arithmatex"
                  >\(2l = 2(l_1 + l_2) = 2(|u| - cntr)\)</span
                >:
              </p>
              <ul>
                <li>
                  Let <span class="arithmatex">\(k_1\)</span> be the largest
                  number such that the first
                  <span class="arithmatex">\(k_1\)</span> characters before the
                  position <span class="arithmatex">\(cntr\)</span> coincide
                  with the last
                  <span class="arithmatex">\(k_1\)</span> characters in the
                  string <span class="arithmatex">\(u\)</span>:
                </li>
              </ul>
              <div class="arithmatex">
                \[ u[cntr - k_1 \dots cntr - 1] = u[|u| - k_1 \dots |u| - 1] \]
              </div>
              <ul>
                <li>
                  Let <span class="arithmatex">\(k_2\)</span> be the largest
                  number such that the
                  <span class="arithmatex">\(k_2\)</span> characters starting at
                  position <span class="arithmatex">\(cntr\)</span> coincide
                  with the first
                  <span class="arithmatex">\(k_2\)</span> characters in the
                  string <span class="arithmatex">\(v\)</span>:
                </li>
              </ul>
              <div class="arithmatex">
                \[ u[cntr \dots cntr + k_2 - 1] = v[0 \dots k_2 - 1] \]
              </div>
              <ul>
                <li>
                  Then we have a repetition exactly for any pair
                  <span class="arithmatex">\((l_1,~ l_2)\)</span> with
                </li>
              </ul>
              <div class="arithmatex">
                \[ \begin{align} l_1 &amp;\le k_1, \\\\ l_2 &amp;\le k_2. \\\\
                \end{align} \]
              </div>
              <p>To summarize:</p>
              <ul>
                <li>
                  We fixate a specific position
                  <span class="arithmatex">\(cntr\)</span>.
                </li>
                <li>
                  All repetition which we will find now have length
                  <span class="arithmatex">\(2l = 2(|u| - cntr)\)</span>. There
                  might be multiple such repetitions, they depend on the lengths
                  <span class="arithmatex">\(l_1\)</span> and
                  <span class="arithmatex">\(l_2 = l - l_1\)</span>.
                </li>
                <li>
                  We find <span class="arithmatex">\(k_1\)</span> and
                  <span class="arithmatex">\(k_2\)</span> as described above.
                </li>
                <li>
                  Then all suitable repetitions are the ones for which the
                  lengths of the pieces
                  <span class="arithmatex">\(l_1\)</span> and
                  <span class="arithmatex">\(l_2\)</span> satisfy the
                  conditions:
                </li>
              </ul>
              <div class="arithmatex">
                \[ \begin{align} l_1 + l_2 &amp;= l = |u| - cntr \\\\ l_1
                &amp;\le k_1, \\\\ l_2 &amp;\le k_2. \\\\ \end{align} \]
              </div>
              <p>
                Therefore the only remaining part is how we can compute the
                values <span class="arithmatex">\(k_1\)</span> and
                <span class="arithmatex">\(k_2\)</span> quickly for every
                position <span class="arithmatex">\(cntr\)</span>. Luckily we
                can compute them in
                <span class="arithmatex">\(O(1)\)</span> using the
                <a href="z-function.html">Z-function</a>:
              </p>
              <ul>
                <li>
                  To can find the value
                  <span class="arithmatex">\(k_1\)</span> for each position by
                  calculating the Z-function for the string
                  <span class="arithmatex">\(\overline{u}\)</span> (i.e. the
                  reversed string <span class="arithmatex">\(u\)</span>). Then
                  the value <span class="arithmatex">\(k_1\)</span> for a
                  particular <span class="arithmatex">\(cntr\)</span> will be
                  equal to the corresponding value of the array of the
                  Z-function.
                </li>
                <li>
                  To precompute all values
                  <span class="arithmatex">\(k_2\)</span>, we calculate the
                  Z-function for the string
                  <span class="arithmatex">\(v + \# + u\)</span> (i.e. the
                  string <span class="arithmatex">\(u\)</span> concatenated with
                  the separator character
                  <span class="arithmatex">\(\#\)</span> and the string
                  <span class="arithmatex">\(v\)</span>). Again we just need to
                  look up the corresponding value in the Z-function to get the
                  <span class="arithmatex">\(k_2\)</span> value.
                </li>
              </ul>
              <p>So this is enough to find all left crossing repetitions.</p>
              <h3 id="right-crossing-repetitions">
                Right crossing repetitions
              </h3>
              <p>
                For computing the right crossing repetitions we act similarly:
                we define the center <span class="arithmatex">\(cntr\)</span> as
                the character corresponding to the last character in the string
                <span class="arithmatex">\(u\)</span>.
              </p>
              <p>
                Then the length <span class="arithmatex">\(k_1\)</span> will be
                defined as the largest number of characters before the position
                <span class="arithmatex">\(cntr\)</span> (inclusive) that
                coincide with the last characters of the string
                <span class="arithmatex">\(u\)</span>. And the length
                <span class="arithmatex">\(k_2\)</span> will be defined as the
                largest number of characters starting at
                <span class="arithmatex">\(cntr + 1\)</span> that coincide with
                the characters of the string
                <span class="arithmatex">\(v\)</span>.
              </p>
              <p>
                Thus we can find the values
                <span class="arithmatex">\(k_1\)</span> and
                <span class="arithmatex">\(k_2\)</span> by computing the
                Z-function for the strings
                <span class="arithmatex"
                  >\(\overline{u} + \# + \overline{v}\)</span
                >
                and <span class="arithmatex">\(v\)</span>.
              </p>
              <p>
                After that we can find the repetitions by looking at all
                positions <span class="arithmatex">\(cntr\)</span>, and use the
                same criterion as we had for left crossing repetitions.
              </p>
              <h3 id="implementation">Implementation</h3>
              <p>
                The implementation of the Main-Lorentz algorithm finds all
                repetitions in form of peculiar tuples of size four:
                <span class="arithmatex">\((cntr,~ l,~ k_1,~ k_2)\)</span> in
                <span class="arithmatex">\(O(n \log n)\)</span> time. If you
                only want to find the number of repetitions in a string, or only
                want to find the longest repetition in a string, this
                information is enough and the runtime will still be
                <span class="arithmatex">\(O(n \log n)\)</span>.
              </p>
              <p>
                Notice that if you want to expand these tuples to get the
                starting and end position of each repetition, then the runtime
                will be the runtime will be
                <span class="arithmatex">\(O(n^2)\)</span> (remember that there
                can be <span class="arithmatex">\(O(n^2)\)</span> repetitions).
                In this implementation we will do so, and store all found
                repetition in a vector of pairs of start and end indices.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">z_function</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">l</span><span class="p">]);</span><span class="w"></span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="w"></span>
<span class="w">            </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">z</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">get_z</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">z</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">repetitions</span><span class="p">;</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">convert_to_repetitions</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">shift</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">cntr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">k2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k2</span><span class="p">);</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">k1</span><span class="p">);</span><span class="w"> </span><span class="n">l1</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">cntr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">cntr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">repetitions</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">find_repetitions</span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nu</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">nu</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">nu</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">ru</span><span class="p">(</span><span class="n">u</span><span class="p">.</span><span class="n">rbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">u</span><span class="p">.</span><span class="n">rend</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="n">string</span><span class="w"> </span><span class="n">rv</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">rbegin</span><span class="p">(),</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">rend</span><span class="p">());</span><span class="w"></span>

<span class="w">    </span><span class="n">find_repetitions</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">shift</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">find_repetitions</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nu</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">z1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_function</span><span class="p">(</span><span class="n">ru</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">z2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_function</span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">z3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_function</span><span class="p">(</span><span class="n">ru</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rv</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">z4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_function</span><span class="p">(</span><span class="n">v</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">cntr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">cntr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">cntr</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">k1</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cntr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nu</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cntr</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">k1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_z</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="w"> </span><span class="n">nu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cntr</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_z</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span><span class="w"> </span><span class="n">nv</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cntr</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cntr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">k1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_z</span><span class="p">(</span><span class="n">z3</span><span class="p">,</span><span class="w"> </span><span class="n">nu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nv</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">cntr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nu</span><span class="p">));</span><span class="w"></span>
<span class="w">            </span><span class="n">k2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_z</span><span class="p">(</span><span class="n">z4</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">cntr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nu</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">k1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k2</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">convert_to_repetitions</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span><span class="w"> </span><span class="n">cntr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nu</span><span class="p">,</span><span class="w"> </span><span class="n">cntr</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">k1</span><span class="p">,</span><span class="w"> </span><span class="n">k2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
            </article>
          </div>
        </div>
      </main>
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">
      {
        "base": "..",
        "features": [],
        "translations": {
          "clipboard.copy": "Copy to clipboard",
          "clipboard.copied": "Copied to clipboard",
          "search.config.lang": "en",
          "search.config.pipeline": "trimmer, stopWordFilter",
          "search.config.separator": "[\\s\\-]+",
          "search.placeholder": "Search",
          "search.result.placeholder": "Type to start searching",
          "search.result.none": "No matching documents",
          "search.result.one": "1 matching document",
          "search.result.other": "# matching documents",
          "search.result.more.one": "1 more on this page",
          "search.result.more.other": "# more on this page",
          "search.result.term.missing": "Missing",
          "select.version.title": "Select version"
        },
        "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"
      }
    </script>

    <script src="../assets/javascripts/bundle.467223ff.min.js"></script>

    <script src="../javascript/config.js"></script>

    <script src="../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>

  <!-- Mirrored from  firststeptocp.com/string/main_lorentz.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:40 GMT -->
</html>
