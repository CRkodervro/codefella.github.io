<!DOCTYPE html>
<html lang="en" class="no-js">
  <!-- Mirrored from  firststeptocp.com/geometry/nearest_points.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:23 GMT -->
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <link rel="icon" href="../favicon.ico" />
    <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5" />

    <title>
      Finding the nearest pair of points - Algorithms for Competitive
      Programming
    </title>

    <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css" />

    <link
      rel="stylesheet"
      href="../assets/stylesheets/palette.e6a45f82.min.css"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"
    />
    <style>
      :root {
        --md-text-font: "Roboto";
        --md-code-font: "Roboto Mono";
      }
    </style>

    <link rel="stylesheet" href="../stylesheets/extra.css" />

    <script>
      (__md_scope = new URL("..", location)),
        (__md_get = (e, _ = localStorage, t = __md_scope) =>
          JSON.parse(_.getItem(t.pathname + "." + e))),
        (__md_set = (e, _, t = localStorage, a = __md_scope) => {
          try {
            t.setItem(a.pathname + "." + e, JSON.stringify(_));
          } catch (e) {}
        });
    </script>

    <script>
      (window.ga =
        window.ga ||
        function () {
          (ga.q = ga.q || []).push(arguments);
        }),
        (ga.l = +new Date()),
        ga("create", "UA-85220282-1", "auto"),
        ga("set", "anonymizeIp", !0),
        ga("send", "pageview"),
        document.addEventListener("DOMContentLoaded", function () {
          document.forms.search &&
            document.forms.search.query.addEventListener("blur", function () {
              var e;
              this.value &&
                ((e = document.location.pathname),
                ga("send", "pageview", e + "?q=" + this.value));
            }),
            "undefined" != typeof location$ &&
              location$.subscribe(function (e) {
                ga("send", "pageview", e.pathname);
              });
        });
    </script>
    <script async src="../../www.google-analytics.com/analytics.js"></script>
  </head>

  <body
    dir="ltr"
    data-md-color-scheme="cpalgo"
    data-md-color-primary="deep-purple"
    data-md-color-accent=""
  >
    <script>
      var palette = __md_get("__palette");
      if (palette && "object" == typeof palette.color)
        for (var key of Object.keys(palette.color))
          document.body.setAttribute(
            "data-md-color-" + key,
            palette.color[key]
          );
    </script>

    <input
      class="md-toggle"
      data-md-toggle="drawer"
      type="checkbox"
      id="__drawer"
      autocomplete="off"
    />
    <input
      class="md-toggle"
      data-md-toggle="search"
      type="checkbox"
      id="__search"
      autocomplete="off"
    />
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      <a href="#finding-the-nearest-pair-of-points" class="md-skip">
        Skip to content
      </a>
    </div>
    <div data-md-component="announce"></div>

    <!-- overwrite:
- scroll to top when clicking title
- go to main page when clicking the site title
- remove the menu button for mobile
-->

    <header class="md-header" data-md-component="header">
      <script>
        function scrollToTop() {
          document.body.scrollTop = 0; // For Safari
          document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
      </script>
      <nav class="md-header__inner md-grid" aria-label="Header">
        <a
          href="../index-2.html"
          title="Algorithms for Competitive Programming"
          class="md-header__button md-logo"
          aria-label="Algorithms for Competitive Programming"
          data-md-component="logo"
        >
          <img src="../favicon.ico" alt="logo" />
        </a>
        <div class="md-header__title" data-md-component="header-title">
          <div class="md-header__ellipsis">
            <div class="md-header__topic">
              <span class="md-ellipsis">
                <a
                  href="../index-2.html"
                  title="Algorithms for Competitive Programming"
                  aria-label="Algorithms for Competitive Programming"
                  data-md-component="logo"
                >
                  Algorithms for Competitive Programming
                </a>
              </span>
            </div>
            <div class="md-header__topic" data-md-component="header-topic">
              <span class="md-ellipsis">
                <a href="#" onclick="scrollToTop()">
                  Finding the nearest pair of points
                </a>
              </span>
            </div>
          </div>
        </div>

        <form class="md-header__option" data-md-component="palette">
          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="cpalgo"
            data-md-color-primary="deep-purple"
            data-md-color-accent=""
            aria-label="Switch to dark mode"
            type="radio"
            name="__palette"
            id="__palette_1"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to dark mode"
            for="__palette_2"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
              />
            </svg>
          </label>

          <input
            class="md-option"
            data-md-color-media=""
            data-md-color-scheme="slate"
            data-md-color-primary=""
            data-md-color-accent=""
            aria-label="Switch to light mode"
            type="radio"
            name="__palette"
            id="__palette_2"
          />

          <label
            class="md-header__button md-icon"
            title="Switch to light mode"
            for="__palette_1"
            hidden
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path
                d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"
              />
            </svg>
          </label>
        </form>

        <label class="md-header__button md-icon" for="__search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"
            />
          </svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
          <label class="md-search__overlay" for="__search"></label>
        </div>
      </nav>
    </header>

    <div class="md-container" data-md-component="container">
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          <div
            class="md-sidebar md-sidebar--primary"
            data-md-component="sidebar"
            data-md-type="navigation"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--primary"
                  aria-label="Navigation"
                  data-md-level="0"
                >
                  <label class="md-nav__title" for="__drawer">
                    <a
                      href="../index-2.html"
                      title="Algorithms for Competitive Programming"
                      class="md-nav__button md-logo"
                      aria-label="Algorithms for Competitive Programming"
                      data-md-component="logo"
                    >
                      <img src="../favicon.ico" alt="logo" />
                    </a>
                    Algorithms for Competitive Programming
                  </label>

                  <ul class="md-nav__list" data-md-scrollfix>
                    <li class="md-nav__item">
                      <a href="../index-2.html" class="md-nav__link">
                        Main Page
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../contrib.html" class="md-nav__link">
                        How to Contribute
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="../preview.html" class="md-nav__link">
                        Preview
                      </a>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_4"
                        type="checkbox"
                        id="__nav_4"
                      />

                      <label class="md-nav__link" for="__nav_4">
                        Algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_4">
                          <span class="md-nav__icon md-icon"></span>
                          Algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../algebra/all-submasks.html"
                              class="md-nav__link"
                            >
                              Submask Enumeration
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/balanced-ternary.html"
                              class="md-nav__link"
                            >
                              Balanced Ternary
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/big-integer.html"
                              class="md-nav__link"
                            >
                              Arbitrary-Precision Arithmetic
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/binary-exp.html"
                              class="md-nav__link"
                            >
                              Binary Exponentiation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/chinese-remainder-theorem.html"
                              class="md-nav__link"
                            >
                              Chinese Remainder Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-log.html"
                              class="md-nav__link"
                            >
                              Discrete Logarithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/discrete-root.html"
                              class="md-nav__link"
                            >
                              Discrete Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/divisors.html"
                              class="md-nav__link"
                            >
                              Number of divisors / sum of divisors
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Euclidean algorithm for computing the greatest
                              common divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/extended-euclid-algorithm.html"
                              class="md-nav__link"
                            >
                              Extended Euclidean Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-divisors.html"
                              class="md-nav__link"
                            >
                              Finding Power of Factorial Divisor
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorial-modulo.html"
                              class="md-nav__link"
                            >
                              Factorial modulo p
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/factorization.html"
                              class="md-nav__link"
                            >
                              Integer factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../algebra/fft.html" class="md-nav__link">
                              Fast Fourier transform
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/fibonacci-numbers.html"
                              class="md-nav__link"
                            >
                              Fibonacci Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/gray-code.html"
                              class="md-nav__link"
                            >
                              Gray code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear-diophantine-equation.html"
                              class="md-nav__link"
                            >
                              Linear Diophantine Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/linear_congruence_equation.html"
                              class="md-nav__link"
                            >
                              Linear Congruence Equation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/module-inverse.html"
                              class="md-nav__link"
                            >
                              Modular Multiplicative Inverse
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/montgomery_multiplication.html"
                              class="md-nav__link"
                            >
                              Montgomery Multiplication
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/phi-function.html"
                              class="md-nav__link"
                            >
                              Euler's totient function
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/polynomial.html"
                              class="md-nav__link"
                            >
                              Operations on polynomials and series
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primality_tests.html"
                              class="md-nav__link"
                            >
                              Primality tests
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/prime-sieve-linear.html"
                              class="md-nav__link"
                            >
                              Linear Sieve
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/primitive-root.html"
                              class="md-nav__link"
                            >
                              Primitive Root
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../algebra/sieve-of-eratosthenes.html"
                              class="md-nav__link"
                            >
                              Sieve of Eratosthenes
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_5"
                        type="checkbox"
                        id="__nav_5"
                      />

                      <label class="md-nav__link" for="__nav_5">
                        Combinatorics
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Combinatorics"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_5">
                          <span class="md-nav__icon md-icon"></span>
                          Combinatorics
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/binomial-coefficients.html"
                              class="md-nav__link"
                            >
                              Binomial Coefficients
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bishops-on-chessboard.html"
                              class="md-nav__link"
                            >
                              Placing Bishops on a Chessboard
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/bracket_sequences.html"
                              class="md-nav__link"
                            >
                              Balanced bracket sequences
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/burnside.html"
                              class="md-nav__link"
                            >
                              Burnside's lemma / Pólya enumeration theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/catalan-numbers.html"
                              class="md-nav__link"
                            >
                              Catalan Numbers
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/counting_labeled_graphs.html"
                              class="md-nav__link"
                            >
                              Counting labeled graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/generating_combinations.html"
                              class="md-nav__link"
                            >
                              Generating all K-combinations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/inclusion-exclusion.html"
                              class="md-nav__link"
                            >
                              The Inclusion-Exclusion Principle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../combinatorics/stars_and_bars.html"
                              class="md-nav__link"
                            >
                              Stars and bars
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_6"
                        type="checkbox"
                        id="__nav_6"
                      />

                      <label class="md-nav__link" for="__nav_6">
                        Data structures
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Data structures"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_6">
                          <span class="md-nav__icon md-icon"></span>
                          Data structures
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../data_structures/deleting_in_log_n.html"
                              class="md-nav__link"
                            >
                              Deleting from a data structure in O(T(n)log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/disjoint_set_union.html"
                              class="md-nav__link"
                            >
                              Disjoint Set Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/fenwick.html"
                              class="md-nav__link"
                            >
                              Fenwick Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/randomized_heap.html"
                              class="md-nav__link"
                            >
                              Randomized Heap
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/segment_tree.html"
                              class="md-nav__link"
                            >
                              Segment Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sparse-table.html"
                              class="md-nav__link"
                            >
                              Sparse Table
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt-tree.html"
                              class="md-nav__link"
                            >
                              Sqrt Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/sqrt_decomposition.html"
                              class="md-nav__link"
                            >
                              Sqrt Decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/stack_queue_modification.html"
                              class="md-nav__link"
                            >
                              Minimum stack / Minimum queue
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../data_structures/treap.html"
                              class="md-nav__link"
                            >
                              Treap (Cartesian tree)
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_7"
                        type="checkbox"
                        id="__nav_7"
                      />

                      <label class="md-nav__link" for="__nav_7">
                        Dynamic programming
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Dynamic programming"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_7">
                          <span class="md-nav__icon md-icon"></span>
                          Dynamic programming
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/divide-and-conquer-dp.html"
                              class="md-nav__link"
                            >
                              Divide and Conquer DP
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/profile-dynamics.html"
                              class="md-nav__link"
                            >
                              Dynamic Programming on Broken Profile. Problem
                              "Parquet"
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../dynamic_programming/zero_matrix.html"
                              class="md-nav__link"
                            >
                              Finding the largest zero submatrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_8"
                        type="checkbox"
                        id="__nav_8"
                      />

                      <label class="md-nav__link" for="__nav_8">
                        Game theory
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Game theory"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_8">
                          <span class="md-nav__icon md-icon"></span>
                          Game theory
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../game_theory/games_on_graphs.html"
                              class="md-nav__link"
                            >
                              Games on arbitrary graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../game_theory/sprague-grundy-nim.html"
                              class="md-nav__link"
                            >
                              Sprague-Grundy theorem. Nim
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li
                      class="md-nav__item md-nav__item--active md-nav__item--nested"
                    >
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_9"
                        type="checkbox"
                        id="__nav_9"
                        checked
                      />

                      <label class="md-nav__link" for="__nav_9">
                        Geometry
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Geometry"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_9">
                          <span class="md-nav__icon md-icon"></span>
                          Geometry
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="area-of-simple-polygon.html"
                              class="md-nav__link"
                            >
                              Finding area of simple polygon in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="basic-geometry.html" class="md-nav__link">
                              Basic Geometry
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="check-segments-intersection.html"
                              class="md-nav__link"
                            >
                              Check if two segments intersect
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="circle-circle-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Circle Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="circle-line-intersection.html"
                              class="md-nav__link"
                            >
                              Circle-Line Intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="convex-hull.html" class="md-nav__link">
                              Convex Hull construction
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="convex_hull_trick.html"
                              class="md-nav__link"
                            >
                              Convex hull trick and Li Chao tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="delaunay.html" class="md-nav__link">
                              Delaunay triangulation and Voronoi diagram
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="halfplane-intersection.html"
                              class="md-nav__link"
                            >
                              Half-plane intersection
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="intersecting_segments.html"
                              class="md-nav__link"
                            >
                              Search for a pair of intersecting segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="lattice-points.html" class="md-nav__link">
                              Lattice points inside non-lattice polygon
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="length-of-segments-union.html"
                              class="md-nav__link"
                            >
                              Length of the union of segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="lines-intersection.html"
                              class="md-nav__link"
                            >
                              Intersection Point of Lines
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="minkowski.html" class="md-nav__link">
                              Minkowski sum of convex polygons
                            </a>
                          </li>

                          <li class="md-nav__item md-nav__item--active">
                            <input
                              class="md-nav__toggle md-toggle"
                              data-md-toggle="toc"
                              type="checkbox"
                              id="__toc"
                            />

                            <label
                              class="md-nav__link md-nav__link--active"
                              for="__toc"
                            >
                              Finding the nearest pair of points
                              <span class="md-nav__icon md-icon"></span>
                            </label>

                            <a
                              href="nearest_points.html"
                              class="md-nav__link md-nav__link--active"
                            >
                              Finding the nearest pair of points
                            </a>

                            <nav
                              class="md-nav md-nav--secondary"
                              aria-label="Table of contents"
                            >
                              <label class="md-nav__title" for="__toc">
                                <span class="md-nav__icon md-icon"></span>
                                Table of contents
                              </label>
                              <ul
                                class="md-nav__list"
                                data-md-component="toc"
                                data-md-scrollfix
                              >
                                <li class="md-nav__item">
                                  <a
                                    href="#problem-statement"
                                    class="md-nav__link"
                                  >
                                    Problem statement
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a href="#algorithm" class="md-nav__link">
                                    Algorithm
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#evaluation-of-the-asymptotics"
                                    class="md-nav__link"
                                  >
                                    Evaluation of the asymptotics
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#implementation"
                                    class="md-nav__link"
                                  >
                                    Implementation
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#generalization-finding-a-triangle-with-minimal-perimeter"
                                    class="md-nav__link"
                                  >
                                    Generalization: finding a triangle with
                                    minimal perimeter
                                  </a>
                                </li>

                                <li class="md-nav__item">
                                  <a
                                    href="#practice-problems"
                                    class="md-nav__link"
                                  >
                                    Practice problems
                                  </a>
                                </li>
                              </ul>
                            </nav>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="oriented-triangle-area.html"
                              class="md-nav__link"
                            >
                              Oriented area of a triangle
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="picks-theorem.html" class="md-nav__link">
                              Pick's Theorem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="point-in-convex-polygon.html"
                              class="md-nav__link"
                            >
                              Check if point belongs to the convex polygon in
                              $O(\log N)$
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="point-location.html" class="md-nav__link">
                              Point location in O(log n)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="segment-to-line.html" class="md-nav__link">
                              Finding the equation of a line for a segment
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="segments-intersection.html"
                              class="md-nav__link"
                            >
                              Finding intersection of two segments
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="tangents-to-two-circles.html"
                              class="md-nav__link"
                            >
                              Finding common tangents to two circles
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="vertical_decomposition.html"
                              class="md-nav__link"
                            >
                              Vertical decomposition
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_10"
                        type="checkbox"
                        id="__nav_10"
                      />

                      <label class="md-nav__link" for="__nav_10">
                        Graph
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Graph" data-md-level="1">
                        <label class="md-nav__title" for="__nav_10">
                          <span class="md-nav__icon md-icon"></span>
                          Graph
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a href="../graph/01_bfs.html" class="md-nav__link">
                              0-1 BFS
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/2SAT.html" class="md-nav__link">
                              2-SAT
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/Assignment-problem-min-flow.html"
                              class="md-nav__link"
                            >
                              Solving assignment problem using min-cost-flow
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/all-pair-shortest-path-floyd-warshall.html"
                              class="md-nav__link"
                            >
                              Floyd-Warshall Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bellman_ford.html"
                              class="md-nav__link"
                            >
                              Bellman-Ford Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bipartite-check.html"
                              class="md-nav__link"
                            >
                              Check whether a graph is bipartite
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/breadth-first-search.html"
                              class="md-nav__link"
                            >
                              Breadth-first search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching-online.html"
                              class="md-nav__link"
                            >
                              Finding Bridges Online
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/bridge-searching.html"
                              class="md-nav__link"
                            >
                              Finding bridges in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/cutpoints.html"
                              class="md-nav__link"
                            >
                              Finding articulation points in a graph in O(N+M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/depth-first-search.html"
                              class="md-nav__link"
                            >
                              Depth First Search
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/desopo_pape.html"
                              class="md-nav__link"
                            >
                              D´Esopo-Pape algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra.html"
                              class="md-nav__link"
                            >
                              Dijkstra Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/dijkstra_sparse.html"
                              class="md-nav__link"
                            >
                              Dijkstra on sparse graphs
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/dinic.html" class="md-nav__link">
                              Maximum flow - Dinic's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edge_vertex_connectivity.html"
                              class="md-nav__link"
                            >
                              Edge connectivity / Vertex connectivity
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/edmonds_karp.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Ford-Fulkerson and Edmonds-Karp
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/euler_path.html"
                              class="md-nav__link"
                            >
                              Finding the Eulerian path in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-cycle.html"
                              class="md-nav__link"
                            >
                              Checking a graph for acyclicity and finding a
                              cycle in O(M)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/finding-negative-cycle-in-graph.html"
                              class="md-nav__link"
                            >
                              Finding a negative cycle in the graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/fixed_length_paths.html"
                              class="md-nav__link"
                            >
                              Number of paths of fixed length / Shortest paths
                              of fixed length
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/flow_with_demands.html"
                              class="md-nav__link"
                            >
                              Flows with demands
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/hld.html" class="md-nav__link">
                              Heavy-light decomposition
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kirchhoff-theorem.html"
                              class="md-nav__link"
                            >
                              Kirchhoff's theorem. Finding the number of
                              spanning trees
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/kuhn_maximum_bipartite_matching.html"
                              class="md-nav__link"
                            >
                              Kuhn's Algorithm for Maximum Bipartite Matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/lca.html" class="md-nav__link">
                              Lowest Common Ancestor - O(sqrt(N)) and O(log N)
                              with O(N) preprocessing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_binary_lifting.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Binary Lifting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_farachcoltonbender.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Farach-Colton and Bender
                              Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/lca_tarjan.html"
                              class="md-nav__link"
                            >
                              Lowest Common Ancestor - Tarjan's off-line
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/min_cost_flow.html"
                              class="md-nav__link"
                            >
                              Minimum-cost flow - Successive shortest path
                              algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a href="../graph/mpm.html" class="md-nav__link">
                              Maximum flow - MPM algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_kruskal_with_dsu.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Kruskal with Disjoint Set
                              Union
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/mst_prim.html"
                              class="md-nav__link"
                            >
                              Minimum spanning tree - Prim's algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/pruefer_code.html"
                              class="md-nav__link"
                            >
                              Prüfer code
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel-faster.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel method improved
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/push-relabel.html"
                              class="md-nav__link"
                            >
                              Maximum flow - Push-relabel algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/rmq_linear.html"
                              class="md-nav__link"
                            >
                              Solve RMQ (Range Minimum Query) by finding LCA
                              (Lowest Common Ancestor)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/search-for-connected-components.html"
                              class="md-nav__link"
                            >
                              Search for connected components in a graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/second_best_mst.html"
                              class="md-nav__link"
                            >
                              Second Best Minimum Spanning Tree
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strong-orientation.html"
                              class="md-nav__link"
                            >
                              Strong Orientation
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/strongly-connected-components.html"
                              class="md-nav__link"
                            >
                              Finding strongly connected components / Building
                              condensation graph
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/topological-sort.html"
                              class="md-nav__link"
                            >
                              Topological Sorting
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../graph/tree_painting.html"
                              class="md-nav__link"
                            >
                              Paint the edges of the tree
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_11"
                        type="checkbox"
                        id="__nav_11"
                      />

                      <label class="md-nav__link" for="__nav_11">
                        Linear algebra
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Linear algebra"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_11">
                          <span class="md-nav__icon md-icon"></span>
                          Linear algebra
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-gauss.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant of a matrix by Gauss
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/determinant-kraut.html"
                              class="md-nav__link"
                            >
                              Calculating the determinant using Kraut method
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/linear-system-gauss.html"
                              class="md-nav__link"
                            >
                              Gauss method for solving system of linear
                              equations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../linear_algebra/rank-matrix.html"
                              class="md-nav__link"
                            >
                              Finding the rank of a matrix
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_12"
                        type="checkbox"
                        id="__nav_12"
                      />

                      <label class="md-nav__link" for="__nav_12">
                        Num methods
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Num methods"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_12">
                          <span class="md-nav__icon md-icon"></span>
                          Num methods
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../num_methods/roots_newton.html"
                              class="md-nav__link"
                            >
                              Newton's method for finding roots
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/simpson-integration.html"
                              class="md-nav__link"
                            >
                              Integration by Simpson's formula
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../num_methods/ternary_search.html"
                              class="md-nav__link"
                            >
                              Ternary Search
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_13"
                        type="checkbox"
                        id="__nav_13"
                      />

                      <label class="md-nav__link" for="__nav_13">
                        Others
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="Others" data-md-level="1">
                        <label class="md-nav__title" for="__nav_13">
                          <span class="md-nav__icon md-icon"></span>
                          Others
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../others/15-puzzle.html"
                              class="md-nav__link"
                            >
                              15 Puzzle Game: Existence Of The Solution
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/josephus_problem.html"
                              class="md-nav__link"
                            >
                              Josephus Problem
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/maximum_average_segment.html"
                              class="md-nav__link"
                            >
                              Search the subarray with the maximum/minimum sum
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../others/stern_brocot_tree_farey_sequences.html"
                              class="md-nav__link"
                            >
                              The Stern-Brocot tree and Farey sequences
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_14"
                        type="checkbox"
                        id="__nav_14"
                      />

                      <label class="md-nav__link" for="__nav_14">
                        Schedules
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Schedules"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_14">
                          <span class="md-nav__icon md-icon"></span>
                          Schedules
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule-with-completion-duration.html"
                              class="md-nav__link"
                            >
                              Optimal schedule of jobs given their deadlines and
                              durations
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_one_machine.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on one machine
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../schedules/schedule_two_machines.html"
                              class="md-nav__link"
                            >
                              Scheduling jobs on two machines
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_15"
                        type="checkbox"
                        id="__nav_15"
                      />

                      <label class="md-nav__link" for="__nav_15">
                        Sequences
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav
                        class="md-nav"
                        aria-label="Sequences"
                        data-md-level="1"
                      >
                        <label class="md-nav__title" for="__nav_15">
                          <span class="md-nav__icon md-icon"></span>
                          Sequences
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../sequences/k-th.html"
                              class="md-nav__link"
                            >
                              K-th order statistic in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/longest_increasing_subsequence.html"
                              class="md-nav__link"
                            >
                              Longest increasing subsequence
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../sequences/rmq.html"
                              class="md-nav__link"
                            >
                              Range Minimum Query
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>

                    <li class="md-nav__item md-nav__item--nested">
                      <input
                        class="md-nav__toggle md-toggle"
                        data-md-toggle="__nav_16"
                        type="checkbox"
                        id="__nav_16"
                      />

                      <label class="md-nav__link" for="__nav_16">
                        String
                        <span class="md-nav__icon md-icon"></span>
                      </label>

                      <nav class="md-nav" aria-label="String" data-md-level="1">
                        <label class="md-nav__title" for="__nav_16">
                          <span class="md-nav__icon md-icon"></span>
                          String
                        </label>
                        <ul class="md-nav__list" data-md-scrollfix>
                          <li class="md-nav__item">
                            <a
                              href="../string/aho_corasick.html"
                              class="md-nav__link"
                            >
                              Aho-Corasick algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/expression_parsing.html"
                              class="md-nav__link"
                            >
                              Expression parsing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/lyndon_factorization.html"
                              class="md-nav__link"
                            >
                              Lyndon factorization
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/main_lorentz.html"
                              class="md-nav__link"
                            >
                              Finding repetitions
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/manacher.html"
                              class="md-nav__link"
                            >
                              Manacher's Algorithm - Finding all sub-palindromes
                              in O(N)
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/prefix-function.html"
                              class="md-nav__link"
                            >
                              Prefix function. Knuth–Morris–Pratt algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/rabin-karp.html"
                              class="md-nav__link"
                            >
                              Rabin-Karp Algorithm for string matching
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/string-hashing.html"
                              class="md-nav__link"
                            >
                              String Hashing
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/suffix-array.html"
                              class="md-nav__link"
                            >
                              Suffix Array
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/suffix-automaton.html"
                              class="md-nav__link"
                            >
                              Suffix Automaton
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/suffix-tree-ukkonen.html"
                              class="md-nav__link"
                            >
                              Suffix Tree. Ukkonen's Algorithm
                            </a>
                          </li>

                          <li class="md-nav__item">
                            <a
                              href="../string/z-function.html"
                              class="md-nav__link"
                            >
                              Z-function and its calculation
                            </a>
                          </li>
                        </ul>
                      </nav>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div
            class="md-sidebar md-sidebar--secondary"
            data-md-component="sidebar"
            data-md-type="toc"
          >
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav
                  class="md-nav md-nav--secondary"
                  aria-label="Table of contents"
                >
                  <label class="md-nav__title" for="__toc">
                    <span class="md-nav__icon md-icon"></span>
                    Table of contents
                  </label>
                  <ul
                    class="md-nav__list"
                    data-md-component="toc"
                    data-md-scrollfix
                  >
                    <li class="md-nav__item">
                      <a href="#problem-statement" class="md-nav__link">
                        Problem statement
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#algorithm" class="md-nav__link"> Algorithm </a>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="#evaluation-of-the-asymptotics"
                        class="md-nav__link"
                      >
                        Evaluation of the asymptotics
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#implementation" class="md-nav__link">
                        Implementation
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a
                        href="#generalization-finding-a-triangle-with-minimal-perimeter"
                        class="md-nav__link"
                      >
                        Generalization: finding a triangle with minimal
                        perimeter
                      </a>
                    </li>

                    <li class="md-nav__item">
                      <a href="#practice-problems" class="md-nav__link">
                        Practice problems
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              <script type="text/javascript">
                window.onload = function () {
                  const newIssueURL =
                    "https://github.com/e-maxx-eng/e-maxx-eng/issues/new";
                  const issueTitle = `Problem on article "Finding the nearest pair of points"`;
                  const issueBody = `
 **Article:** [Finding the nearest pair of points](${window.location.href})

**Problem:**
<!--
Describe the issue of this article in detail.
-->
`;
                  var issue_a = document.getElementById("report_issue_a");
                  issue_a.href =
                    `${newIssueURL}?` +
                    `title=${encodeURIComponent(issueTitle)}&` +
                    `body=${encodeURIComponent(issueBody)}`;
                };
              </script>

              <h1 id="finding-the-nearest-pair-of-points">
                Finding the nearest pair of points
              </h1>
              <h2 id="problem-statement">Problem statement</h2>
              <p>
                Given <span class="arithmatex">\(n\)</span> points on the plane.
                Each point <span class="arithmatex">\(p_i\)</span> is defined by
                its coordinates <span class="arithmatex">\((x_i,y_i)\)</span>.
                It is required to find among them two such points, such that the
                distance between them is minimal:
              </p>
              <div class="arithmatex">
                \[ \min_{\scriptstyle i, j=0 \ldots n-1,\atop \scriptstyle i
                \neq j } \rho (p_i, p_j). \]
              </div>
              <p>We take the usual Euclidean distances:</p>
              <div class="arithmatex">
                \[ \rho (p_i,p_j) = \sqrt{(x_i-x_j)^2 + (y_i-y_j)^2} .\]
              </div>
              <p>
                The trivial algorithm - iterating over all pairs and calculating
                the distance for each — works in
                <span class="arithmatex">\(O(n^2)\)</span>.
              </p>
              <p>
                The algorithm running in time
                <span class="arithmatex">\(O(n \log n)\)</span> is described
                below. This algorithm was proposed by Preparata in 1975.
                Preparata and Shamos also showed that this algorithm is optimal
                in the decision tree model.
              </p>
              <h2 id="algorithm">Algorithm</h2>
              <p>
                We construct an algorithm according to the general scheme of
                <strong>divide-and-conquer</strong> algorithms: the algorithm is
                designed as a recursive function, to which we pass a set of
                points; this recursive function splits this set in half, calls
                itself recursively on each half, and then performs some
                operations to combine the answers. The operation of combining
                consist of detecting the cases when one point of the optimal
                solution fell into one half, and the other point into the other
                (in this case, recursive calls from each of the halves cannot
                detect this pair separately). The main difficulty, as always in
                case of divide and conquer algorithms, lies in the effective
                implementation of the merging stage. If a set of
                <span class="arithmatex">\(n\)</span> points is passed to the
                recursive function, then the merge stage should work no more
                than <span class="arithmatex">\(O(n)\)</span>, then the
                asymptotics of the whole algorithm
                <span class="arithmatex">\(T(n)\)</span> will be found from the
                equation:
              </p>
              <div class="arithmatex">\[T(n) = 2T(n/2) + O(n).\]</div>
              <p>
                The solution to this equation, as is known, is
                <span class="arithmatex">\(T(n) = O(n \log n).\)</span>
              </p>
              <p>
                So, we proceed on to the construction of the algorithm. In order
                to come to an effective implementation of the merge stage in the
                future, we will divide the set of points into two subsets,
                according to their
                <span class="arithmatex">\(x\)</span>-coordinates: In fact, we
                draw some vertical line dividing the set of points into two
                subsets of approximately the same size. It is convenient to make
                such a partition as follows: We sort the points in the standard
                way as pairs of numbers, ie.:
              </p>
              <div class="arithmatex">
                \[p_i &lt; p_j \Longleftrightarrow (x_i &lt; x_j) \lor
                \Big(\left(x_i = x_j\right) \wedge \left(y_i &lt; y_j \right)
                \Big) \]
              </div>
              <p>
                Then take the middle point after sorting
                <span class="arithmatex">\(p_m (m = \lfloor n/2 \rfloor)\)</span
                >, and all the points before it and the
                <span class="arithmatex">\(p_m\)</span> itself are assigned to
                the first half, and all the points after it - to the second
                half:
              </p>
              <div class="arithmatex">
                \[A_1 = \{p_i \ | \ i = 0 \ldots m \}\]
              </div>
              <div class="arithmatex">
                \[A_2 = \{p_i \ | \ i = m + 1 \ldots n-1 \}.\]
              </div>
              <p>
                Now, calling recursively on each of the sets
                <span class="arithmatex">\(A_1\)</span> and
                <span class="arithmatex">\(A_2\)</span>, we will find the
                answers <span class="arithmatex">\(h_1\)</span> and
                <span class="arithmatex">\(h_2\)</span> for each of the halves.
                And take the best of them:
                <span class="arithmatex">\(h = \min(h_1, h_2)\)</span>.
              </p>
              <p>
                Now we need to make a <strong>merge stage</strong>, i.e. we try
                to find such pairs of points, for which the distance between
                which is less than <span class="arithmatex">\(h\)</span> and one
                point is lying in <span class="arithmatex">\(A_1\)</span> and
                the other in <span class="arithmatex">\(A_2\)</span>. It is
                obvious that it is sufficient to consider only those points that
                are separated from the vertical line by a distance less than
                <span class="arithmatex">\(h\)</span>, i.e. the set
                <span class="arithmatex">\(B\)</span> of the points considered
                at this stage is equal to:
              </p>
              <div class="arithmatex">
                \[B = \{ p_i\ | \ | x_i - x_m\ | &lt; h \}.\]
              </div>
              <p>
                For each point in the set <span class="arithmatex">\(B\)</span>,
                we try to find the points that are closer to it than
                <span class="arithmatex">\(h\)</span>. For example, it is
                sufficient to consider only those points whose
                <span class="arithmatex">\(y\)</span>-coordinate differs by no
                more than <span class="arithmatex">\(h\)</span>. Moreover, it
                makes no sense to consider those points whose
                <span class="arithmatex">\(y\)</span>-coordinate is greater than
                the <span class="arithmatex">\(y\)</span>-coordinate of the
                current point. Thus, for each point
                <span class="arithmatex">\(p_i\)</span> we define the set of
                considered points <span class="arithmatex">\(C(p_i)\)</span> as
                follows:
              </p>
              <div class="arithmatex">
                \[C(p_i) = \{ p_j\ |\ p_j \in B,\ \ y_i - h &lt; y_j \le y_i
                \}.\]
              </div>
              <p>
                If we sort the points of the set
                <span class="arithmatex">\(B\)</span> by
                <span class="arithmatex">\(y\)</span>-coordinate, it will be
                very easy to find <span class="arithmatex">\(C(p_i)\)</span>:
                these are several points in a row ahead to the point
                <span class="arithmatex">\(p_i\)</span>.
              </p>
              <p>
                So, in the new notation, the
                <strong>merging stage</strong> looks like this: build a set
                <span class="arithmatex">\(B\)</span>, sort the points in it by
                <span class="arithmatex">\(y\)</span>-coordinate, then for each
                point <span class="arithmatex">\(p_i \in B\)</span> consider all
                points <span class="arithmatex">\(p_j \in C(p_i)\)</span>, and
                for each pair
                <span class="arithmatex">\((p_i,p_j)\)</span> calculate the
                distance and compare with the current best distance.
              </p>
              <p>
                At first glance, this is still a non-optimal algorithm: it seems
                that the sizes of sets
                <span class="arithmatex">\(C(p_i)\)</span> will be of order
                <span class="arithmatex">\(n\)</span>, and the required
                asymptotics will not work. However, surprisingly, it can be
                proved that the size of each of the sets
                <span class="arithmatex">\(C(p_i)\)</span> is a quantity
                <span class="arithmatex">\(O(1)\)</span>, i.e. it does not
                exceed some small constant regardless of the points themselves.
                Proof of this fact is given in the next section.
              </p>
              <p>
                Finally, we pay attention to the sorting, which the above
                algorithm contains: first,sorting by pairs
                <span class="arithmatex">\((x, y)\)</span>, and then second,
                sorting the elements of the set
                <span class="arithmatex">\(B\)</span> by
                <span class="arithmatex">\(y\)</span>. In fact, both of these
                sorts inside the recursive function can be eliminated (otherwise
                we would not reach the
                <span class="arithmatex">\(O(n)\)</span> estimate for the
                <strong>merging stage</strong>, and the general asymptotics of
                the algorithm would be
                <span class="arithmatex">\(O(n \log^2 n)\)</span>). It is easy
                to get rid of the first sort — it is enough to perform this sort
                before starting the recursion: after all, the elements
                themselves do not change inside the recursion, so there is no
                need to sort again. With the second sorting a little more
                difficult to perform, performing it previously will not work.
                But, remembering the merge sort, which also works on the
                principle of divide-and-conquer, we can simply embed this sort
                in our recursion. Let recursion, taking some set of points (as
                we remember,ordered by pairs
                <span class="arithmatex">\((x, y)\)</span>), return the same
                set, but sorted by the
                <span class="arithmatex">\(y\)</span>-coordinate. To do this,
                simply merge (in <span class="arithmatex">\(O(n)\)</span>) the
                two results returned by recursive calls. This will result in a
                set sorted by <span class="arithmatex">\(y\)</span>-coordinate.
              </p>
              <h2 id="evaluation-of-the-asymptotics">
                Evaluation of the asymptotics
              </h2>
              <p>
                To show that the above algorithm is actually executed in
                <span class="arithmatex">\(O(n \log n)\)</span>, we need to
                prove the following fact:
                <span class="arithmatex">\(|C(p_i)| = O(1)\)</span>.
              </p>
              <p>
                So, let us consider some point
                <span class="arithmatex">\(p_i\)</span>; recall that the set
                <span class="arithmatex">\(C(p_i)\)</span> is a set of points
                whose <span class="arithmatex">\(y\)</span>-coordinate lies in
                the segment <span class="arithmatex">\([y_i-h; y_i]\)</span>,
                and, moreover, along the
                <span class="arithmatex">\(x\)</span> coordinate, the point
                <span class="arithmatex">\(p_i\)</span> itself, and all the
                points of the set <span class="arithmatex">\(C(p_i)\)</span> lie
                in the band width <span class="arithmatex">\(2h\)</span>. In
                other words, the points we are considering
                <span class="arithmatex">\(p_i\)</span> and
                <span class="arithmatex">\(C(p_i)\)</span> lie in a rectangle of
                size <span class="arithmatex">\(2h \times h\)</span>.
              </p>
              <p>
                Our task is to estimate the maximum number of points that can
                lie in this rectangle
                <span class="arithmatex">\(2h \times h\)</span>; thus, we
                estimate the maximum size of the set
                <span class="arithmatex">\(C(p_i)\)</span>. At the same time,
                when evaluating, we must not forget that there may be repeated
                points.
              </p>
              <p>
                Remember that <span class="arithmatex">\(h\)</span> was obtained
                from the results of two recursive calls — on sets
                <span class="arithmatex">\(A_1\)</span> and
                <span class="arithmatex">\(A_2\)</span>, and
                <span class="arithmatex">\(A_1\)</span> contains points to the
                left of the partition line and partially on it,
                <span class="arithmatex">\(A_2\)</span> contains the remaining
                points of the partition line and points to the right of it. For
                any pair of points from <span class="arithmatex">\(A_1\)</span>,
                as well as from <span class="arithmatex">\(A_2\)</span>, the
                distance can not be less than
                <span class="arithmatex">\(h\)</span> — otherwise it would mean
                incorrect operation of the recursive function.
              </p>
              <p>
                To estimate the maximum number of points in the rectangle
                <span class="arithmatex">\(2h \times h\)</span> we divide it
                into two squares <span class="arithmatex">\(h \times h\)</span>,
                the first square include all points
                <span class="arithmatex">\(C(p_i) \cap A_1\)</span>, and the
                second contains all the others, i.e.
                <span class="arithmatex">\(C(p_i) \cap A_2\)</span>. It follows
                from the above considerations that in each of these squares the
                distance between any two points is at least
                <span class="arithmatex">\(h\)</span>.
              </p>
              <p>
                We show that there are at most four points in each square. For
                example, this can be done as follows: divide the square into
                <span class="arithmatex">\(4\)</span> sub-squares with sides
                <span class="arithmatex">\(h/2\)</span>. Then there can be no
                more than one point in each of these sub-squares (since even the
                diagonal is equal to
                <span class="arithmatex">\(h / \sqrt{2}\)</span>, which is less
                than <span class="arithmatex">\(h\)</span>). Therefore, there
                can be no more than <span class="arithmatex">\(4\)</span> points
                in the whole square.
              </p>
              <p>
                So, we have proved that in a rectangle
                <span class="arithmatex">\(2h \times h\)</span> can not be more
                than <span class="arithmatex">\(4 \cdot 2 = 8\)</span> points,
                and, therefore, the size of the set
                <span class="arithmatex">\(C(p_i)\)</span> cannot exceed
                <span class="arithmatex">\(7\)</span>, as required.
              </p>
              <h2 id="implementation">Implementation</h2>
              <p>
                We introduce a data structure to store a point (its coordinates
                and a number) and comparison operators required for two types of
                sorting:
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">pt</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span><span class="w"> </span><span class="nc">cmp_x</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">struct</span><span class="w"> </span><span class="nc">cmp_y</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"></span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">pt</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                For a convenient implementation of recursion, we introduce an
                auxiliary function upd_ans(), which will calculate the distance
                between two points and check whether it is better than the
                current answer:
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="kt">double</span><span class="w"> </span><span class="n">mindist</span><span class="p">;</span><span class="w"></span>
<span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">best_pair</span><span class="p">;</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">upd_ans</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">((</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">y</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dist</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mindist</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">mindist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">best_pair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">a</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">id</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                Finally, the implementation of the recursion itself. It is
                assumed that before calling it, the array
                <span class="arithmatex">\(a[]\)</span> is already sorted by
                <span class="arithmatex">\(x\)</span>-coordinate. In recursion
                we pass just two pointers
                <span class="arithmatex">\(l, r\)</span>, which indicate that it
                should look for the answer for
                <span class="arithmatex">\(a[l \ldots r)\)</span>. If the
                distance between <span class="arithmatex">\(r\)</span> and
                <span class="arithmatex">\(l\)</span> is too small, the
                recursion must be stopped, and perform a trivial algorithm to
                find the nearest pair and then sort the subarray by
                <span class="arithmatex">\(y\)</span>-coordinate.
              </p>
              <p>
                To merge two sets of points received from recursive calls into
                one (ordered by
                <span class="arithmatex">\(y\)</span>-coordinate), we use the
                standard STL
                <span class="arithmatex">\(merge()\)</span> function, and create
                an auxiliary buffer <span class="arithmatex">\(t[]\)</span>(one
                for all recursive calls). (Using inplace_merge () is impractical
                because it generally does not work in linear time.)
              </p>
              <p>
                Finally, the set <span class="arithmatex">\(B\)</span> is stored
                in the same array <span class="arithmatex">\(t\)</span>.
              </p>
              <div class="highlight">
                <pre><span></span><code><span class="n">vector</span><span class="o">&lt;</span><span class="n">pt</span><span class="o">&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">;</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">rec</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">upd_ans</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">cmp_y</span><span class="p">());</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">midx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">].</span><span class="n">x</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">rec</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">rec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">merge</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">cmp_y</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="n">copy</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tsz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">r</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">midx</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mindist</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mindist</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="n">upd_ans</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span><span class="w"></span>
<span class="w">            </span><span class="n">t</span><span class="p">[</span><span class="n">tsz</span><span class="o">++</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre>
              </div>
              <p>
                By the way, if all the coordinates are integer, then at the time
                of the recursion you can not move to fractional values, and
                store in <span class="arithmatex">\(mindist\)</span> the square
                of the minimum distance.
              </p>
              <p>In the main program, recursion should be called as follows:</p>
              <div class="highlight">
                <pre><span></span><code><span class="n">t</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span><span class="w"> </span><span class="n">cmp_x</span><span class="p">());</span><span class="w"></span>
<span class="n">mindist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1E20</span><span class="p">;</span><span class="w"></span>
<span class="n">rec</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"></span>
</code></pre>
              </div>
              <h2 id="generalization-finding-a-triangle-with-minimal-perimeter">
                Generalization: finding a triangle with minimal perimeter
              </h2>
              <p>
                The algorithm described above is interestingly generalized to
                this problem: among a given set of points, choose three
                different points so that the sum of pairwise distances between
                them is the smallest.
              </p>
              <p>
                In fact, to solve this problem, the algorithm remains the same:
                we divide the field into two halves of the vertical line, call
                the solution recursively on both halves, choose the minimum
                <span class="arithmatex">\(minper\)</span> from the found
                perimeters, build a strip with the thickness of
                <span class="arithmatex">\(minper / 2\)</span>, and iterate
                through all triangles that can improve the answer. (Note that
                the triangle with perimeter
                <span class="arithmatex">\(\le minper\)</span> has the longest
                side <span class="arithmatex">\(\le minper / 2\)</span>.)
              </p>
              <h2 id="practice-problems">Practice problems</h2>
              <ul>
                <li>
                  <a
                    href="https://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1186"
                    >UVA 10245 "The Closest Pair Problem" [difficulty: low]</a
                  >
                </li>
                <li>
                  <a href="https://www.spoj.com/problems/CLOPPAIR/"
                    >SPOJ #8725 CLOPPAIR "Closest Point Pair" [difficulty:
                    low]</a
                  >
                </li>
                <li>
                  <a href="http://codeforces.com/contest/120/problem/J"
                    >CODEFORCES Team Olympiad Saratov - 2011 "Minimum amount"
                    [difficulty: medium]</a
                  >
                </li>
                <li>
                  <a
                    href="https://code.google.com/codejam/contest/311101/dashboard#s=a&amp;a=1"
                    >Google CodeJam 2009 Final " Min Perimeter "[difficulty:
                    medium]</a
                  >
                </li>
                <li>
                  <a href="https://www.spoj.com/problems/CLOSEST/"
                    >SPOJ #7029 CLOSEST "Closest Triple" [difficulty: medium]</a
                  >
                </li>
                <li>
                  <a
                    href="https://acm.timus.ru/problem.aspx?space=1&amp;num=1514"
                    >TIMUS 1514 National Park [difficulty: medium]</a
                  >
                </li>
              </ul>
            </article>
          </div>
        </div>
      </main>
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">
      {
        "base": "..",
        "features": [],
        "translations": {
          "clipboard.copy": "Copy to clipboard",
          "clipboard.copied": "Copied to clipboard",
          "search.config.lang": "en",
          "search.config.pipeline": "trimmer, stopWordFilter",
          "search.config.separator": "[\\s\\-]+",
          "search.placeholder": "Search",
          "search.result.placeholder": "Type to start searching",
          "search.result.none": "No matching documents",
          "search.result.one": "1 matching document",
          "search.result.other": "# matching documents",
          "search.result.more.one": "1 more on this page",
          "search.result.more.other": "# more on this page",
          "search.result.term.missing": "Missing",
          "select.version.title": "Select version"
        },
        "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"
      }
    </script>

    <script src="../assets/javascripts/bundle.467223ff.min.js"></script>

    <script src="../javascript/config.js"></script>

    <script src="../../polyfill.io/v3/polyfill.min1162.js?features=es6"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>

  <!-- Mirrored from  firststeptocp.com/geometry/nearest_points.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 13 Mar 2022 18:44:23 GMT -->
</html>
